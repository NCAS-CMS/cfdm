
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cf.Field.where &#8212; Documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
  <li><a target="_blank" href="../../archive.html">Archive</a> &laquo;</li>
  <li><a target="_blank" href="http://cfpython.bitbucket.io">cf-python 0.1</a> &raquo;</li>
<!--
  <li><a target="_blank" href="http://cfpython.bitbucket.io">cf-python</a> &raquo;</li>
  <li><select onchange="location = this.options[this.selectedIndex].value;">

      <option value="../../1.0/index.html">1.0

      <option value="../../0.9.9/index.html">0.9.9

      <option value="../../0.9.8.3/index.html">0.9.8.3

      <option value="../../archive.html">Archive

      </select>
  </li>
-->
  
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cf-field-where">
<h1>cf.Field.where<a class="headerlink" href="#cf-field-where" title="Permalink to this headline">¶</a></h1>
<dl class="method">
<dt id="cf.Field.where">
<code class="descclassname">Field.</code><code class="descname">where</code><span class="sig-paren">(</span><em>condition</em>, <em>x=None</em>, <em>y=None</em>, <em>i=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cf.Field.where" title="Permalink to this definition">¶</a></dt>
<dd><p>Set data array elements depending on a condition.</p>
<p>Elements are set differently depending on where the condition is True
or False. Two assignment values are given. From one of them, the
field’s data array is set where the condition is True and where the
condition is False, the data array is set from the other.</p>
<p>Each assignment value may either contain a single datum, or is an
array-like object which is broadcastable shape of the field’s data
array.</p>
<p><strong>Missing data</strong></p>
<p>The treatment of missing data elements depends on the value of field’s
<a class="reference internal" href="cf.Field.hardmask.html#cf.Field.hardmask" title="cf.Field.hardmask"><code class="xref py py-obj docutils literal"><span class="pre">hardmask</span></code></a> attribute. If it is True then masked elements will not
unmasked, otherwise masked elements may be set to any value.</p>
<p>In either case, unmasked elements may be set to any value (including
missing data).</p>
<p>Unmasked elements may be set to missing data by assignment to the
<a class="reference internal" href="../constant.html#cf.cf.masked" title="cf.cf.masked"><code class="xref py py-obj docutils literal"><span class="pre">cf.masked</span></code></a> constant or by assignment to a value which contains masked
elements.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../constant.html#cf.cf.masked" title="cf.cf.masked"><code class="xref py py-obj docutils literal"><span class="pre">cf.masked</span></code></a>, <a class="reference internal" href="cf.Field.hardmask.html#cf.Field.hardmask" title="cf.Field.hardmask"><code class="xref py py-obj docutils literal"><span class="pre">hardmask</span></code></a>, <a class="reference internal" href="cf.Field.indices.html#cf.Field.indices" title="cf.Field.indices"><code class="xref py py-obj docutils literal"><span class="pre">indices</span></code></a>, <a class="reference internal" href="cf.Field.mask.html#cf.Field.mask" title="cf.Field.mask"><code class="xref py py-obj docutils literal"><span class="pre">mask</span></code></a>, <a class="reference internal" href="cf.Field.subspace.html#cf.Field.subspace" title="cf.Field.subspace"><code class="xref py py-obj docutils literal"><span class="pre">subspace</span></code></a></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Examples 1:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt>condition <span class="classifier-delimiter">:</span> <span class="classifier"></span></dt>
<dd><p class="first">The condition which determines how to set the data array. The
<em>condition</em> parameter may be one of:</p>
<blockquote>
<div><ul>
<li><p class="first">Any object which is broadcastable to the field’s shape
using the metadata-aware <code class="xref py py-obj docutils literal"><span class="pre">cf</span></code> broadcasting rules (i.e. a
suitable <code class="xref py py-obj docutils literal"><span class="pre">cf.Field</span></code> object or any object, <code class="docutils literal"><span class="pre">a</span></code>, for which
<code class="docutils literal"><span class="pre">numpy.size(a)</span></code> is 1). The condition is True where the
object broadcast to the field’s data array evaluates to
True.</p>
<blockquote>
<div><dl class="docutils">
<dt><em>Example:</em>                </dt>
<dd><p class="first last">To set all data array values of 10 to -999:
<code class="docutils literal"><span class="pre">f.where(10,</span> <span class="pre">-999)</span></code>.</p>
</dd>
<dt><em>Example:</em></dt>
<dd><p class="first last">To set all data array values of 100 metres to -999
metres: <code class="docutils literal"><span class="pre">f.where(cf.Data(100,</span> <span class="pre">'m'),</span> <span class="pre">-999)</span></code>.</p>
</dd>
<dt><em>Example:</em></dt>
<dd><p class="first last">To set all data array values to -999 where another
field, <code class="docutils literal"><span class="pre">g</span></code> (which is broadcastable to <code class="docutils literal"><span class="pre">f</span></code>),
evaluates to true: <code class="docutils literal"><span class="pre">f.where(g,</span> <span class="pre">-999)</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<blockquote class="last">
<div><ul>
<li><p class="first">A <code class="xref py py-obj docutils literal"><span class="pre">cf.Query</span></code> object which is evaluated against the field
and the resulting field of booleans (which will always
have the same shape as the original field) defines the
condition.</p>
<blockquote>
<div><dl class="docutils">
<dt><em>Example:</em></dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">f.where(cf.lt(0),</span> <span class="pre">-999)</span></code> will set all data array
values less than zero to -999. This will often be
equivalent to <code class="docutils literal"><span class="pre">f.where(f==cf.lt(0),</span> <span class="pre">-999)</span></code>, but the
latter will fail if the field <code class="docutils literal"><span class="pre">f</span></code> has insufficient
domain metadata whilst the former will always work.</p>
</dd>
</dl>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</dd>
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier"><em>optional</em></span></dt>
<dd><p class="first">Specify the assignment values. Where the condition evaluates
to True, set the field’s data array from <em>x</em> and where the
condition evaluates to False, set the field’s data array from
<em>y</em>. The <em>x</em> and <em>y</em> parameters are each one of:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">None</span></code></a>. The appropriate elements of the field’s data
array are unchanged. This the default.</li>
</ul>
</div></blockquote>
<blockquote class="last">
<div><ul class="simple">
<li>Any object which is broadcastable to the field’s data
array using the metadata-aware <code class="xref py py-obj docutils literal"><span class="pre">cf</span></code> broadcasting rules
(i.e. a suitable <code class="xref py py-obj docutils literal"><span class="pre">cf.Field</span></code> object or any object, <code class="docutils literal"><span class="pre">a</span></code>,
for which <code class="docutils literal"><span class="pre">numpy.size(a)</span></code> is 1). The appropriate
elements of the field’s data array are set to the
corresponding values from the object broadcast to the
field’s data array shape.</li>
</ul>
</div></blockquote>
</dd>
<dt>i <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True then update the field in place. By default a new
field is created. In either case, a field is
returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt>out <span class="classifier-delimiter">:</span> <span class="classifier">cf.Field</span></dt>
<dd><p class="first last">The field with updated data array.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples 2:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Set data array values to 15 everywhere:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>This example could also be done with subspace assignment:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
</pre></div>
</div>
<p>Set all negative data array values to zero and leave all other
elements unchanged:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiply all positive data array elements by -1 and set other data
array elements to 3.14:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>
</pre></div>
</div>
<p>Set all values less than 280 and greater than 290 to missing data:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">f</span> <span class="o">&lt;</span> <span class="mi">280</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;</span> <span class="mi">290</span><span class="p">),</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span>
</pre></div>
</div>
<p>This example could also be done with a <code class="xref py py-obj docutils literal"><span class="pre">cf.Query</span></code> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">wo</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">290</span><span class="p">),</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span>
</pre></div>
</div>
<p>or equivalently:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f</span><span class="o">==</span><span class="n">cf</span><span class="o">.</span><span class="n">wo</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">290</span><span class="p">),</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span>
</pre></div>
</div>
<p>Set data array elements in the northern hemisphere to missing data
in-place:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a condition which is True only in the northern hemisphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">condition</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">domain_mask</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This in-place example could also be done with subspace assignment by
indices:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">northern_hemisphere</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">[</span><span class="n">northern_hemisphere</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span>
</pre></div>
</div>
<p>Set a polar rows to their zonal-mean values:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a condition which is True only on polar rows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">condition</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">domain_mask</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Set each data polar row element to the polar row zonal mean </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and mask all other points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;longitude: mean&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/generated/cf.Field.where.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
  <li><a target="_blank" href="../../archive.html">Archive</a> &laquo;</li>
  <li><a target="_blank" href="http://cfpython.bitbucket.io">cf-python 0.1</a> &raquo;</li>
<!--
  <li><a target="_blank" href="http://cfpython.bitbucket.io">cf-python</a> &raquo;</li>
  <li><select onchange="location = this.options[this.selectedIndex].value;">

      <option value="../../1.0/index.html">1.0

      <option value="../../0.9.9/index.html">0.9.9

      <option value="../../0.9.8.3/index.html">0.9.8.3

      <option value="../../archive.html">Archive

      </select>
  </li>
-->
  
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, David Hassell.
      Last updated on Oct 04, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.2.
    </div>
  </body>
</html>