
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>cfdm tutorial &#8212; Documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API reference" href="api_reference.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><b><a href="index.html">cfdm 1.7.2</a></b></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>cfdm tutorial</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#import"><strong>Import</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-datasets"><strong>Reading datasets</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#inspection"><strong>Inspection</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#properties"><strong>Properties</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadata-constructs"><strong>Metadata constructs</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#data"><strong>Data</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#subspacing"><strong>Subspacing</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering-metadata-constructs"><strong>Filtering metadata constructs</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadata-construct-access"><strong>Metadata construct access</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#time"><strong>Time</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#domain"><strong>Domain</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#domain-axes"><strong>Domain axes</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coordinates"><strong>Coordinates</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#domain-ancillaries"><strong>Domain ancillaries</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coordinate-systems"><strong>Coordinate systems</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#cell-methods"><strong>Cell methods</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#field-ancillaries"><strong>Field ancillaries</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#field-creation"><strong>Field creation</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#copying-and-equality"><strong>Copying and equality</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#netcdf-interface"><strong>NetCDF interface</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-to-disk"><strong>Writing to disk</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#external-variables"><strong>External variables</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#compression"><strong>Compression</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html"><strong>API reference</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="subclassing.html"><strong>Subclassing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html"><strong>Philosophy</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="versioning.html"><strong>Versioning</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html"><strong>Older releases</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html"><strong>What’s new</strong></a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter"><strong>Installation</strong></a></li>
      <li>Next: <a href="api_reference.html" title="next chapter"><strong>API reference</strong></a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cfdm-tutorial">
<span id="tutorial"></span><h1><strong>cfdm tutorial</strong><a class="headerlink" href="#cfdm-tutorial" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Version 1.7.2 for version 1.7 of the CF conventions.</p>
<div class="section" id="import">
<span id="id1"></span><h2><strong>Import</strong><a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The cfdm package is imported as follows:</p>
<div class="literal-block-wrapper docutils container" id="id57">
<div class="code-block-caption"><span class="caption-text"><em>Import the cfdm package.</em></span><a class="headerlink" href="#id57" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cfdm</span>
</pre></div>
</div>
</div>
<div class="section" id="cf-version">
<span id="id2"></span><h3><strong>CF version</strong><a class="headerlink" href="#cf-version" title="Permalink to this headline">¶</a></h3>
<p>The version of the <a class="reference external" href="http://cfconventions.org">CF conventions</a> and
the <a class="reference internal" href="introduction.html#cf-data-model"><span class="std std-ref">CF data model</span></a> being used may be found with
the <a class="reference internal" href="function/cfdm.CF.html#cfdm.CF" title="cfdm.CF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.CF</span></code></a> function:</p>
<div class="literal-block-wrapper docutils container" id="id58">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the version of the CF conventions.</em></span><a class="headerlink" href="#id58" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">CF</span><span class="p">()</span>
<span class="go">&#39;1.7&#39;</span>
</pre></div>
</div>
</div>
<p>This indicates which version of the CF conventions are represented by
this release of the cfdm package, and therefore the version can not be
changed.</p>
<p>Note, however, that datasets of different versions may be <a class="reference internal" href="#reading-datasets"><span class="std std-ref">read</span></a> from, or <a class="reference internal" href="#writing-to-disk"><span class="std std-ref">written</span></a> to,
disk.</p>
</div>
</div>
<div class="section" id="reading-datasets">
<span id="id3"></span><h2><strong>Reading datasets</strong><a class="headerlink" href="#reading-datasets" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function reads a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">netCDF</a> file from disk, or
from an <a class="reference external" href="https://www.opendap.org/">OPeNDAP</a> URL <a class="footnote-reference" href="#dap" id="id4">[1]</a>, and returns
the contents as a list of zero or more <a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a> class instances, each
of which represents a field construct. (Henceforth, the phrase “field
construct” will be assumed to mean “<a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a> instance”.) The list
contains a field construct to represent each of the CF-netCDF data
variables in the file.</p>
<p>Datasets of any version of CF up to and including CF-1.7 can be
read.</p>
<p>All formats of netCDF3 and netCDF4 files can be read.</p>
<p>For example, to read the file <code class="docutils literal notranslate"><span class="pre">file.nc</span></code> (<a class="reference download internal" download="" href="_downloads/f48d7afe4147b17ac19ae1bba473c78c/file.nc"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 9kB) <a class="footnote-reference" href="#files" id="id5">[2]</a>, which contains two field
constructs:</p>
<div class="literal-block-wrapper docutils container" id="id59">
<div class="code-block-caption"><span class="caption-text"><em>Read file.nc and show that the result is a two-element
list.</em></span><a class="headerlink" href="#id59" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">&lt;type &#39;list&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<p>Descriptive properties are always read into memory, but <a class="reference external" href="https://en.wikipedia.org/wiki/Lazy_loading">lazy loading</a> is employed for all
data arrays, which means that no data is read into memory until the
data is required for inspection or to modify the array contents. This
maximises the number of field constructs that may be read within a
session, and makes the read operation fast.</p>
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li>allow the user to provide files that contain <a class="reference internal" href="#external-variables"><span class="std std-ref">external
variables</span></a>;</li>
<li>request <a class="reference internal" href="#creation-by-reading"><span class="std std-ref">extra field constructs to be created from “metadata”
netCDF variables</span></a>, i.e. those that are
referenced from CF-netCDF data variables, but which are not regarded
by default as data variables in their own right; and</li>
<li>display information and warnings about the mapping of the netCDF
file contents to CF data model constructs.</li>
</ul>
<div class="section" id="cf-compliance">
<span id="id6"></span><h3><strong>CF-compliance</strong><a class="headerlink" href="#cf-compliance" title="Permalink to this headline">¶</a></h3>
<p>If the dataset is partially CF-compliant to the extent that it is not
possible to unambiguously map an element of the netCDF dataset to an
element of the CF data model, then a field construct is still
returned, but may be incomplete. This is so that datasets which are
partially conformant may nonetheless be modified in memory and written
to new datasets. Such “structural” non-compliance would occur, for
example, if the “coordinates” attribute of a CF-netCDF data variable
refers to another variable that does not exist, or refers to a
variable that spans a netCDF dimension that does not apply to the data
variable. Other types of non-compliance are not checked, such whether
or not controlled vocabularies have been adhered to. The structural
compliance of the dataset may be checked with the
<a class="reference internal" href="method/cfdm.Field.dataset_compliance.html#cfdm.Field.dataset_compliance" title="cfdm.Field.dataset_compliance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dataset_compliance</span></code></a> method of the field construct, as
well as optionally displayed when the dataset is read.</p>
</div>
</div>
<div class="section" id="inspection">
<span id="id7"></span><h2><strong>Inspection</strong><a class="headerlink" href="#inspection" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The contents of a field construct may be inspected at three different
levels of detail.</p>
<div class="section" id="minimal-detail">
<span id="id8"></span><h3><strong>Minimal detail</strong><a class="headerlink" href="#minimal-detail" title="Permalink to this headline">¶</a></h3>
<p>The built-in <a class="reference external" href="https://docs.python.org/3/library/functions.html#repr" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repr</span></code></a> function returns a short, one-line description:</p>
<div class="literal-block-wrapper docutils container" id="id60">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs from
the dataset and create a Python variable for each of
them.</em></span><a class="headerlink" href="#id60" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
</pre></div>
</div>
</div>
<p>This gives the identity of the field construct
(e.g. “specific_humidity”), the identities and sizes of the dimensions
spanned by the data array (“latitude” and “longitude” with sizes 5 and
8 respectively) and the units of the data (“1”).</p>
</div>
<div class="section" id="medium-detail">
<span id="id9"></span><h3><strong>Medium detail</strong><a class="headerlink" href="#medium-detail" title="Permalink to this headline">¶</a></h3>
<p>The built-in <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> function returns similar information as the
one-line output, along with short descriptions of the metadata
constructs, which include the first and last values of their data
arrays:</p>
<div class="literal-block-wrapper docutils container" id="id61">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs with
medium detail.</em></span><a class="headerlink" href="#id61" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span> <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
 <span class="n">Field</span><span class="p">:</span> <span class="n">specific_humidity</span> <span class="p">(</span><span class="n">ncvar</span><span class="o">%</span><span class="n">q</span><span class="p">)</span>
 <span class="o">----------------------------------</span>
 <span class="n">Data</span>            <span class="p">:</span> <span class="n">specific_humidity</span><span class="p">(</span><span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">longitude</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="mi">1</span>
 <span class="n">Cell</span> <span class="n">methods</span>    <span class="p">:</span> <span class="n">area</span><span class="p">:</span> <span class="n">mean</span>
 <span class="n">Dimension</span> <span class="n">coords</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2019</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span>
                 <span class="p">:</span> <span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">75.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">]</span> <span class="n">degrees_north</span>
                 <span class="p">:</span> <span class="n">longitude</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">22.5</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">337.5</span><span class="p">]</span> <span class="n">degrees_east</span>

 <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
 <span class="n">Field</span><span class="p">:</span> <span class="n">air_temperature</span> <span class="p">(</span><span class="n">ncvar</span><span class="o">%</span><span class="n">ta</span><span class="p">)</span>
 <span class="o">---------------------------------</span>
 <span class="n">Data</span>            <span class="p">:</span> <span class="n">air_temperature</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="n">K</span>
 <span class="n">Cell</span> <span class="n">methods</span>    <span class="p">:</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span> <span class="n">mean</span> <span class="n">where</span> <span class="n">land</span> <span class="p">(</span><span class="n">interval</span><span class="p">:</span> <span class="mf">0.1</span> <span class="n">degrees</span><span class="p">)</span> <span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">maximum</span>
 <span class="n">Field</span> <span class="n">ancils</span>    <span class="p">:</span> <span class="n">air_temperature</span> <span class="n">standard_error</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.81</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">]]</span> <span class="n">K</span>
 <span class="n">Dimension</span> <span class="n">coords</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2019</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span>
                 <span class="p">:</span> <span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">]</span>
                 <span class="p">:</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.76</span><span class="p">]</span> <span class="n">degrees</span>
                 <span class="p">:</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.7</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.18</span><span class="p">]</span> <span class="n">degrees</span>
 <span class="n">Auxiliary</span> <span class="n">coords</span><span class="p">:</span> <span class="n">latitude</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">53.941</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">50.225</span><span class="p">]]</span> <span class="n">degrees_N</span>
                 <span class="p">:</span> <span class="n">longitude</span><span class="p">(</span><span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.004</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">8.156</span><span class="p">]]</span> <span class="n">degrees_E</span>
                 <span class="p">:</span> <span class="n">long_name</span><span class="o">=</span><span class="n">Grid</span> <span class="n">latitude</span> <span class="n">name</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="o">--</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">kappa</span><span class="p">]</span>
 <span class="n">Cell</span> <span class="n">measures</span>   <span class="p">:</span> <span class="n">measure</span><span class="p">:</span><span class="n">area</span><span class="p">(</span><span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2391.9657</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">2392.6009</span><span class="p">]]</span> <span class="n">km2</span>
 <span class="n">Coord</span> <span class="n">references</span><span class="p">:</span> <span class="n">atmosphere_hybrid_height_coordinate</span>
                 <span class="p">:</span> <span class="n">rotated_latitude_longitude</span>
 <span class="n">Domain</span> <span class="n">ancils</span>   <span class="p">:</span> <span class="n">ncvar</span><span class="o">%</span><span class="n">a</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">]</span> <span class="n">m</span>
                 <span class="p">:</span> <span class="n">ncvar</span><span class="o">%</span><span class="n">b</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">]</span>
                 <span class="p">:</span> <span class="n">surface_altitude</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">270.0</span><span class="p">]]</span> <span class="n">m</span>
</pre></div>
</div>
</div>
<p>Note that <a class="reference internal" href="#time"><span class="std std-ref">time values</span></a> are converted to date-times via
the <a class="reference external" href="https://unidata.github.io/cftime/">cftime package</a>.</p>
</div>
<div class="section" id="full-detail">
<span id="id10"></span><h3><strong>Full detail</strong><a class="headerlink" href="#full-detail" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="method/cfdm.Field.dump.html#cfdm.Field.dump" title="cfdm.Field.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump</span></code></a> method of the field construct gives all
properties of all constructs, including metadata constructs and their
components, and shows the first and last values of all data arrays:</p>
<div class="literal-block-wrapper docutils container" id="id62">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs with
full detail.</em></span><a class="headerlink" href="#id62" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span> <span class="o">&gt;&gt;&gt;</span> <span class="n">q</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
 <span class="o">----------------------------------</span>
 <span class="n">Field</span><span class="p">:</span> <span class="n">specific_humidity</span> <span class="p">(</span><span class="n">ncvar</span><span class="o">%</span><span class="n">q</span><span class="p">)</span>
 <span class="o">----------------------------------</span>
 <span class="n">Conventions</span> <span class="o">=</span> <span class="s1">&#39;CF-1.7&#39;</span>
 <span class="n">project</span> <span class="o">=</span> <span class="s1">&#39;research&#39;</span>
 <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;specific_humidity&#39;</span>
 <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>

 <span class="n">Data</span><span class="p">(</span><span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">longitude</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.003</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.032</span><span class="p">]]</span> <span class="mi">1</span>

 <span class="n">Cell</span> <span class="n">Method</span><span class="p">:</span> <span class="n">area</span><span class="p">:</span> <span class="n">mean</span>

 <span class="n">Domain</span> <span class="n">Axis</span><span class="p">:</span> <span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
 <span class="n">Domain</span> <span class="n">Axis</span><span class="p">:</span> <span class="n">longitude</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
 <span class="n">Domain</span> <span class="n">Axis</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

 <span class="n">Dimension</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">latitude</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;latitude&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_north&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">75.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">]</span> <span class="n">degrees_north</span>
     <span class="n">Bounds</span><span class="p">:</span><span class="n">Data</span><span class="p">(</span><span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mf">90.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">]]</span>

 <span class="n">Dimension</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">longitude</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_east&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">longitude</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mf">22.5</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">337.5</span><span class="p">]</span> <span class="n">degrees_east</span>
     <span class="n">Bounds</span><span class="p">:</span><span class="n">Data</span><span class="p">(</span><span class="n">longitude</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">360.0</span><span class="p">]]</span>

 <span class="n">Dimension</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">time</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 2018-12-01&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2019</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span>

 <span class="o">&gt;&gt;&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
 <span class="o">---------------------------------</span>
 <span class="n">Field</span><span class="p">:</span> <span class="n">air_temperature</span> <span class="p">(</span><span class="n">ncvar</span><span class="o">%</span><span class="n">ta</span><span class="p">)</span>
 <span class="o">---------------------------------</span>
 <span class="n">Conventions</span> <span class="o">=</span> <span class="s1">&#39;CF-1.7&#39;</span>
 <span class="n">project</span> <span class="o">=</span> <span class="s1">&#39;research&#39;</span>
 <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;air_temperature&#39;</span>
 <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>

 <span class="n">Data</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">89.0</span><span class="p">]]]</span> <span class="n">K</span>

 <span class="n">Cell</span> <span class="n">Method</span><span class="p">:</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span> <span class="n">mean</span> <span class="n">where</span> <span class="n">land</span> <span class="p">(</span><span class="n">interval</span><span class="p">:</span> <span class="mf">0.1</span> <span class="n">degrees</span><span class="p">)</span>
 <span class="n">Cell</span> <span class="n">Method</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">maximum</span>

 <span class="n">Field</span> <span class="n">Ancillary</span><span class="p">:</span> <span class="n">air_temperature</span> <span class="n">standard_error</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;air_temperature standard_error&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.81</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">]]</span> <span class="n">K</span>

 <span class="n">Domain</span> <span class="n">Axis</span><span class="p">:</span> <span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">Domain</span> <span class="n">Axis</span><span class="p">:</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
 <span class="n">Domain</span> <span class="n">Axis</span><span class="p">:</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
 <span class="n">Domain</span> <span class="n">Axis</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

 <span class="n">Dimension</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">atmosphere_hybrid_height_coordinate</span>
     <span class="n">computed_standard_name</span> <span class="o">=</span> <span class="s1">&#39;altitude&#39;</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">]</span>
     <span class="n">Bounds</span><span class="p">:</span><span class="n">Data</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]]</span>

 <span class="n">Dimension</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">grid_latitude</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;grid_latitude&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.76</span><span class="p">]</span> <span class="n">degrees</span>
     <span class="n">Bounds</span><span class="p">:</span><span class="n">Data</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.42</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.98</span><span class="p">]]</span>

 <span class="n">Dimension</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">grid_longitude</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;grid_longitude&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.7</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.18</span><span class="p">]</span> <span class="n">degrees</span>
     <span class="n">Bounds</span><span class="p">:</span><span class="n">Data</span><span class="p">(</span><span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mf">4.92</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.96</span><span class="p">]]</span>

 <span class="n">Dimension</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">time</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 2018-12-01&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2019</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span>

 <span class="n">Auxiliary</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">latitude</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;latitude&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_N&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">53.941</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">50.225</span><span class="p">]]</span> <span class="n">degrees_N</span>

 <span class="n">Auxiliary</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">longitude</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_E&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.004</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">8.156</span><span class="p">]]</span> <span class="n">degrees_E</span>

 <span class="n">Auxiliary</span> <span class="n">coordinate</span><span class="p">:</span> <span class="n">long_name</span><span class="o">=</span><span class="n">Grid</span> <span class="n">latitude</span> <span class="n">name</span>
     <span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;Grid latitude name&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="o">--</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">kappa</span><span class="p">]</span>

 <span class="n">Domain</span> <span class="n">ancillary</span><span class="p">:</span> <span class="n">ncvar</span><span class="o">%</span><span class="n">a</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">]</span> <span class="n">m</span>
     <span class="n">Bounds</span><span class="p">:</span><span class="n">Data</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]]</span>

 <span class="n">Domain</span> <span class="n">ancillary</span><span class="p">:</span> <span class="n">ncvar</span><span class="o">%</span><span class="n">b</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">]</span>
     <span class="n">Bounds</span><span class="p">:</span><span class="n">Data</span><span class="p">(</span><span class="n">atmosphere_hybrid_height_coordinate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">14.0</span><span class="p">,</span> <span class="mf">26.0</span><span class="p">]]</span>

 <span class="n">Domain</span> <span class="n">ancillary</span><span class="p">:</span> <span class="n">surface_altitude</span>
     <span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;surface_altitude&#39;</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">270.0</span><span class="p">]]</span> <span class="n">m</span>

 <span class="n">Coordinate</span> <span class="n">reference</span><span class="p">:</span> <span class="n">atmosphere_hybrid_height_coordinate</span>
     <span class="n">Coordinate</span> <span class="n">conversion</span><span class="p">:</span><span class="n">computed_standard_name</span> <span class="o">=</span> <span class="n">altitude</span>
     <span class="n">Coordinate</span> <span class="n">conversion</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="n">atmosphere_hybrid_height_coordinate</span>
     <span class="n">Coordinate</span> <span class="n">conversion</span><span class="p">:</span><span class="n">a</span> <span class="o">=</span> <span class="n">Domain</span> <span class="n">Ancillary</span><span class="p">:</span> <span class="n">ncvar</span><span class="o">%</span><span class="n">a</span>
     <span class="n">Coordinate</span> <span class="n">conversion</span><span class="p">:</span><span class="n">b</span> <span class="o">=</span> <span class="n">Domain</span> <span class="n">Ancillary</span><span class="p">:</span> <span class="n">ncvar</span><span class="o">%</span><span class="n">b</span>
     <span class="n">Coordinate</span> <span class="n">conversion</span><span class="p">:</span><span class="n">orog</span> <span class="o">=</span> <span class="n">Domain</span> <span class="n">Ancillary</span><span class="p">:</span> <span class="n">surface_altitude</span>
     <span class="n">Datum</span><span class="p">:</span><span class="n">earth_radius</span> <span class="o">=</span> <span class="mi">6371007</span>
     <span class="n">Dimension</span> <span class="n">Coordinate</span><span class="p">:</span> <span class="n">atmosphere_hybrid_height_coordinate</span>

 <span class="n">Coordinate</span> <span class="n">reference</span><span class="p">:</span> <span class="n">rotated_latitude_longitude</span>
     <span class="n">Coordinate</span> <span class="n">conversion</span><span class="p">:</span><span class="n">grid_mapping_name</span> <span class="o">=</span> <span class="n">rotated_latitude_longitude</span>
     <span class="n">Coordinate</span> <span class="n">conversion</span><span class="p">:</span><span class="n">grid_north_pole_latitude</span> <span class="o">=</span> <span class="mf">38.0</span>
     <span class="n">Coordinate</span> <span class="n">conversion</span><span class="p">:</span><span class="n">grid_north_pole_longitude</span> <span class="o">=</span> <span class="mf">190.0</span>
     <span class="n">Datum</span><span class="p">:</span><span class="n">earth_radius</span> <span class="o">=</span> <span class="mi">6371007</span>
     <span class="n">Dimension</span> <span class="n">Coordinate</span><span class="p">:</span> <span class="n">grid_longitude</span>
     <span class="n">Dimension</span> <span class="n">Coordinate</span><span class="p">:</span> <span class="n">grid_latitude</span>
     <span class="n">Auxiliary</span> <span class="n">Coordinate</span><span class="p">:</span> <span class="n">longitude</span>
     <span class="n">Auxiliary</span> <span class="n">Coordinate</span><span class="p">:</span> <span class="n">latitude</span>

 <span class="n">Cell</span> <span class="n">measure</span><span class="p">:</span> <span class="n">measure</span><span class="p">:</span><span class="n">area</span>
     <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;km2&#39;</span>
     <span class="n">Data</span><span class="p">(</span><span class="n">grid_longitude</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">grid_latitude</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2391.9657</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">2392.6009</span><span class="p">]]</span> <span class="n">km2</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cfdump">
<span id="id11"></span><h3><strong>cfdump</strong><a class="headerlink" href="#cfdump" title="Permalink to this headline">¶</a></h3>
<p>The description for every field construct in a file can also be
generated from the command line, with minimal, medium or full detail,
by using the <code class="docutils literal notranslate"><span class="pre">cfdump</span></code> tool, for example:</p>
<div class="literal-block-wrapper docutils container" id="id63">
<div class="code-block-caption"><span class="caption-text"><em>Use cfdump on the command line to inspect the field
constructs contained in a dataset. The “-s” option
requests short, minimal detail as output.</em></span><a class="headerlink" href="#id63" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ cfdump
USAGE: cfdump <span class="o">[</span>-s<span class="o">]</span> <span class="o">[</span>-c<span class="o">]</span> <span class="o">[</span>-e file <span class="o">[</span>-e file<span class="o">]</span> ...<span class="o">]</span> <span class="o">[</span>-h<span class="o">]</span> file
  <span class="o">[</span>-s<span class="o">]</span>      Display short, one-line descriptions
  <span class="o">[</span>-c<span class="o">]</span>      Display <span class="nb">complete</span> descriptions
  <span class="o">[</span>-e file<span class="o">]</span> External files
  <span class="o">[</span>-h<span class="o">]</span>      Display the full man page
  file      Name of netCDF file <span class="o">(</span>or URL <span class="k">if</span> DAP access enabled<span class="o">)</span>
$ cfdump -s file.nc
Field: specific_humidity<span class="o">(</span>latitude<span class="o">(</span>5<span class="o">)</span>, longitude<span class="o">(</span>8<span class="o">))</span> 1
Field: air_temperature<span class="o">(</span>atmosphere_hybrid_height_coordinate<span class="o">(</span>1<span class="o">)</span>, grid_latitude<span class="o">(</span>10<span class="o">)</span>, grid_longitude<span class="o">(</span>9<span class="o">))</span> K
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cfdump</span></code> may also be used with <a class="reference internal" href="#external-variables-with-cfdump"><span class="std std-ref">external files</span></a>.</p>
</div>
</div>
<div class="section" id="properties">
<span id="id12"></span><h2><strong>Properties</strong><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Descriptive properties that apply to field construct as a whole may be
retrieved with the <a class="reference internal" href="method/cfdm.Field.properties.html#cfdm.Field.properties" title="cfdm.Field.properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">properties</span></code></a> method:</p>
<div class="literal-block-wrapper docutils container" id="id64">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve all of the descriptive properties</em></span><a class="headerlink" href="#id64" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
</pre></div>
</div>
</div>
<p>Individual properties may be accessed and modified with the
<a class="reference internal" href="method/cfdm.Field.del_property.html#cfdm.Field.del_property" title="cfdm.Field.del_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_property</span></code></a>, <a class="reference internal" href="method/cfdm.Field.get_property.html#cfdm.Field.get_property" title="cfdm.Field.get_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_property</span></code></a>, <a class="reference internal" href="method/cfdm.Field.has_property.html#cfdm.Field.has_property" title="cfdm.Field.has_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_property</span></code></a>,
and <a class="reference internal" href="method/cfdm.Field.set_property.html#cfdm.Field.set_property" title="cfdm.Field.set_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_property</span></code></a> methods:</p>
<div class="literal-block-wrapper docutils container" id="id65">
<div class="code-block-caption"><span class="caption-text"><em>Check is a property exists, retrieve its value, delete
it and then set it to a new value.</em></span><a class="headerlink" href="#id65" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;not set&#39;</span><span class="p">)</span>
<span class="go">&#39;not set&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;air_temperature&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;not set&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
</pre></div>
</div>
</div>
<p>A collection of properties may be set at the same time with the
<a class="reference internal" href="method/cfdm.Field.set_properties.html#cfdm.Field.set_properties" title="cfdm.Field.set_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_properties</span></code></a> method of the field construct, and all
properties may be completely removed with the
<a class="reference internal" href="method/cfdm.Field.clear_properties.html#cfdm.Field.clear_properties" title="cfdm.Field.clear_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_properties</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id66">
<div class="code-block-caption"><span class="caption-text"><em>Update the properties with a collection, delete all of
the properties, and reinstate the original properties.</em></span><a class="headerlink" href="#id66" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;foo&#39;: &#39;bar&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">clear_properties</span><span class="p">()</span>
<span class="go"> {&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;foo&#39;: &#39;bar&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
</pre></div>
</div>
</div>
<p>All of the methods related to the properties are listed <a class="reference internal" href="class/cfdm.Field.html#field-properties"><span class="std std-ref">here</span></a>.</p>
</div>
<div class="section" id="metadata-constructs">
<span id="id13"></span><h2><strong>Metadata constructs</strong><a class="headerlink" href="#metadata-constructs" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The metadata constructs describe the field construct that contains
them. Each <a class="reference internal" href="introduction.html#cf-data-model"><span class="std std-ref">CF data model metadata construct</span></a> has
a corresponding cfdm class:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="31%" />
<col width="41%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Class</th>
<th class="head">CF data model construct</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></td>
<td>Domain axis</td>
<td>Independent axes of the domain</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a></td>
<td>Dimension coordinate</td>
<td>Domain cell locations</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a></td>
<td>Auxiliary coordinate</td>
<td>Domain cell locations</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a></td>
<td>Coordinate reference</td>
<td>Domain coordinate systems</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a></td>
<td>Domain ancillary</td>
<td>Cell locations in alternative
coordinate systems</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></td>
<td>Cell measure</td>
<td>Domain cell size or shape</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a></td>
<td>Field ancillary</td>
<td>Ancillary metadata which vary
within the domain</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="class/cfdm.CellMethod.html#cfdm.CellMethod" title="cfdm.CellMethod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMethod</span></code></a></td>
<td>Cell method</td>
<td>Describes how data represent
variation within cells</td>
</tr>
</tbody>
</table>
<p>Metadata constructs of a particular type can be retrieved with the
following attributes of the field construct:</p>
<table border="1" class="docutils">
<colgroup>
<col width="59%" />
<col width="41%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Metadata constructs</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.domain_axes.html#cfdm.Field.domain_axes" title="cfdm.Field.domain_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_axes</span></code></a></td>
<td>Domain axes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.dimension_coordinates.html#cfdm.Field.dimension_coordinates" title="cfdm.Field.dimension_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimension_coordinates</span></code></a></td>
<td>Dimension coordinates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.auxiliary_coordinates.html#cfdm.Field.auxiliary_coordinates" title="cfdm.Field.auxiliary_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auxiliary_coordinates</span></code></a></td>
<td>Auxiliary coordinates</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.coordinate_references.html#cfdm.Field.coordinate_references" title="cfdm.Field.coordinate_references"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinate_references</span></code></a></td>
<td>Coordinate references</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.domain_ancillaries.html#cfdm.Field.domain_ancillaries" title="cfdm.Field.domain_ancillaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_ancillaries</span></code></a></td>
<td>Domain ancillaries</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.cell_measures.html#cfdm.Field.cell_measures" title="cfdm.Field.cell_measures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_measures</span></code></a></td>
<td>Cell measures</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.field_ancillaries.html#cfdm.Field.field_ancillaries" title="cfdm.Field.field_ancillaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">field_ancillaries</span></code></a></td>
<td>Field ancillaries</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.cell_methods.html#cfdm.Field.cell_methods" title="cfdm.Field.cell_methods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_methods</span></code></a></td>
<td>Cell methods</td>
</tr>
</tbody>
</table>
<p>Each of these attributes returns a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> class instance that
maps metadata constructs to a unique identifiers called a “construct
keys”. A <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance has methods for selecting constructs
that meet particular criteria (see the section on <a class="reference internal" href="#filtering-metadata-constructs"><span class="std std-ref">filtering
metadata constructs</span></a>). It also behaves
like a “read-only” Python dictionary, in that it has
<a class="reference internal" href="method/cfdm.Constructs.items.html#cfdm.Constructs.items" title="cfdm.Constructs.items"><code class="xref py py-obj docutils literal notranslate"><span class="pre">items</span></code></a>, <a class="reference internal" href="method/cfdm.Constructs.keys.html#cfdm.Constructs.keys" title="cfdm.Constructs.keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keys</span></code></a> and <a class="reference internal" href="method/cfdm.Constructs.values.html#cfdm.Constructs.values" title="cfdm.Constructs.values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code></a>
methods that work exactly like their corresponding <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> methods. It
also has a <a class="reference internal" href="method/cfdm.Constructs.get.html#cfdm.Constructs.get" title="cfdm.Constructs.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a> method and indexing like a Python
dictionary (see the section on <a class="reference internal" href="#metadata-construct-access"><span class="std std-ref">metadata construct access</span></a> for details).</p>
<div class="literal-block-wrapper docutils container" id="id67">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the field construct’s coordinate reference
constructs, and access them using dictionary methods.</em></span><a class="headerlink" href="#id67" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span>
<span class="go">&lt;Constructs: coordinate_reference(2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;coordinatereference0&#39;: &lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;,</span>
<span class="go"> &#39;coordinatereference1&#39;: &lt;CoordinateReference: rotated_latitude_longitude&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;coordinatereference0&#39;, &#39;coordinatereference1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">coordinatereference1 &lt;CoordinateReference: rotated_latitude_longitude&gt;</span>
<span class="go">coordinatereference0 &lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id68">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the field construct’s dimension coordinate and
domain axis constructs.</em></span><a class="headerlink" href="#id68" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">dimension_coordinates</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;DomainAxis: size(1)&gt;}</span>
</pre></div>
</div>
</div>
<p>The construct keys (e.g. <code class="docutils literal notranslate"><span class="pre">'domainaxis1'</span></code>) are usually generated
internally and are unique within the field construct. However,
construct keys may be different for equivalent metadata constructs
from different field constructs, and for different Python sessions.</p>
<p>Metadata constructs of all types may be returned by the
<a class="reference internal" href="method/cfdm.Field.constructs.html#cfdm.Field.constructs" title="cfdm.Field.constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constructs</span></code></a> attribute of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id69">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve all of the field construct’s metadata
constructs.</em></span><a class="headerlink" href="#id69" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span>
<span class="go">&lt;Constructs: cell_method(1), dimension_coordinate(3), domain_axis(3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CellMethod: area: mean&gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: latitude(5) degrees_north&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: longitude(8) degrees_east&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;,</span>
<span class="go"> &#39;domainaxis0&#39;: &lt;DomainAxis: size(5)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(8)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span>
<span class="go">&lt;Constructs: auxiliary_coordinate(3), cell_measure(1), cell_method(2), coordinate_reference(2), dimension_coordinate(4), domain_ancillary(3), domain_axis(4), field_ancillary(1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;,</span>
<span class="go"> &#39;cellmethod0&#39;: &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;,</span>
<span class="go"> &#39;coordinatereference0&#39;: &lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;,</span>
<span class="go"> &#39;coordinatereference1&#39;: &lt;CoordinateReference: rotated_latitude_longitude&gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;,</span>
<span class="go"> &#39;domainancillary0&#39;: &lt;DomainAncillary: ncvar%a(1) m&gt;,</span>
<span class="go"> &#39;domainancillary1&#39;: &lt;DomainAncillary: ncvar%b(1) &gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;domainaxis0&#39;: &lt;DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="data">
<span id="id14"></span><h2><strong>Data</strong><a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The field construct’s data is stored in a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> class instance that
is accessed with the <a class="reference internal" href="attribute/cfdm.Field.data.html#cfdm.Field.data" title="cfdm.Field.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a> attribute of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id70">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the data and inspect it, showing the shape and
some illustrative values.</em></span><a class="headerlink" href="#id70" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(1, 10, 9): [[[262.8, ..., 269.7]]] K&gt;</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance provide access to full array of values, as well as
attributes to describe the array and methods for describing any
<a class="reference internal" href="#compression"><span class="std std-ref">data compression</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id71">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve a numpy array of the data.</em></span><a class="headerlink" href="#id71" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[262.8 270.5 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7 268.4 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7 279.1 273.4 274.2 279.6 270.2 280.0 272.5 263.7]</span>
<span class="go">  [261.7 260.6 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.0 263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.0 270.6]</span>
<span class="go">  [267.9 273.5 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9 278.7 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4 264.2 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id72">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the data type, number of dimensions, dimension
sizes and number of elements of the data.</em></span><a class="headerlink" href="#id72" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float64&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span>
<span class="go">90</span>
</pre></div>
</div>
</div>
<p>The field construct also has a <a class="reference internal" href="method/cfdm.Field.get_data.html#cfdm.Field.get_data" title="cfdm.Field.get_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data</span></code></a> method as an
alternative means of retrieving the data instance, which allows for a
default to be returned if no data have been set; as well as a
<a class="reference internal" href="method/cfdm.Field.del_data.html#cfdm.Field.del_data" title="cfdm.Field.del_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_data</span></code></a> method for removing the data.</p>
<p>All of the methods and attributes related to the data are listed
<a class="reference internal" href="class/cfdm.Field.html#field-data"><span class="std std-ref">here</span></a>.</p>
<div class="section" id="data-axes">
<span id="id15"></span><h3><strong>Data axes</strong><a class="headerlink" href="#data-axes" title="Permalink to this headline">¶</a></h3>
<p>The data array of the field construct spans all the domain axis
constructs with the possible exception of size one domain axis
constructs. The domain axis constructs spanned by the field
construct’s data are found with the <a class="reference internal" href="method/cfdm.Field.get_data_axes.html#cfdm.Field.get_data_axes" title="cfdm.Field.get_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_axes</span></code></a> method of
the field construct. For example, the data of the field construct
<code class="docutils literal notranslate"><span class="pre">t</span></code> does not span the size one domain axis construct with key
<code class="docutils literal notranslate"><span class="pre">'domainaxis3'</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id73">
<div class="code-block-caption"><span class="caption-text"><em>Show which data axis constructs are spanned by the field
construct’s data.</em></span><a class="headerlink" href="#id73" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">()</span>
<span class="go">(&#39;domainaxis0&#39;, &#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
</pre></div>
</div>
</div>
<p>The data may be set with the <a class="reference internal" href="method/cfdm.Field.set_data.html#cfdm.Field.set_data" title="cfdm.Field.set_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data</span></code></a> method of the field
construct. The domain axis constructs spanned by the data must be
considered, either by explicitly providing them via their construct
keys, or by using those that may have already been set. In any case,
the data axes may be set at any time with the <a class="reference internal" href="method/cfdm.Field.set_data_axes.html#cfdm.Field.set_data_axes" title="cfdm.Field.set_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data_axes</span></code></a>
method of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id74">
<div class="code-block-caption"><span class="caption-text"><em>Delete the data and then reinstate it, using the
existing data axes.</em></span><a class="headerlink" href="#id74" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">del_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(1, 10, 9): [[[262.8, ..., 269.7]]] K&gt;</span>
</pre></div>
</div>
</div>
<p>See the section <a class="reference internal" href="#field-creation"><span class="std std-ref">field construct creation</span></a> for
more examples.</p>
</div>
<div class="section" id="indexing">
<span id="id16"></span><h3><strong>Indexing</strong><a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h3>
<p>When a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance is indexed a new instance is created for the
part of the data defined by the indices. Indexing follows rules that
are very similar to the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">numpy indexing rules</a>,
the only differences being:</p>
<ul class="simple">
<li>An integer index <em>i</em> specified for a dimension reduces the size of
this dimension to unity, taking just the <em>i</em>-th element, but keeps
the dimension itself, so that the rank of the array is not reduced.</li>
</ul>
<ul class="simple">
<li>When two or more dimensions’ indices are sequences of integers then
these indices work independently along each dimension (similar to
the way vector subscripts work in Fortran). This is the same
indexing behaviour as on a <code class="docutils literal notranslate"><span class="pre">Variable</span></code> object of the <a class="reference external" href="http://unidata.github.io/netcdf4-python">netCDF4
package</a>.</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id75">
<div class="code-block-caption"><span class="caption-text"><em>Create new data by indexing and show the shape
corresponding to the indices.</em></span><a class="headerlink" href="#id75" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 1, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 3, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 1)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="assignment">
<span id="id17"></span><h3><strong>Assignment</strong><a class="headerlink" href="#assignment" title="Permalink to this headline">¶</a></h3>
<p>Values can be changed by assigning to elements selected by indices of
the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance using rules that are very similar to the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">numpy
indexing rules</a>,
the only difference being:</p>
<ul class="simple">
<li>When two or more dimensions’ indices are sequences of integers then
these indices work independently along each dimension (similar to
the way vector subscripts work in Fortran). This is the same
indexing behaviour as on a <code class="docutils literal notranslate"><span class="pre">Variable</span></code> object of the <a class="reference external" href="http://unidata.github.io/netcdf4-python">netCDF4
package</a>.</li>
</ul>
<p>A single value may be assigned to any number of elements.</p>
<div class="literal-block-wrapper docutils container" id="id76">
<div class="code-block-caption"><span class="caption-text"><em>Set a single element to -1, a “column” of elements
to -2 and a “square” of elements to -3.</em></span><a class="headerlink" href="#id76" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2 279.6 270.2 280.0 272.5 263.7]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2  -2.0 262.5  -3.0  -3.0  -3.0 270.4 268.6 275.3]</span>
<span class="go">  [263.9  -2.0 272.1  -3.0  -3.0  -3.0 260.0 263.5 270.2]</span>
<span class="go">  [273.8  -2.0 268.5  -3.0  -3.0  -3.0 270.6 273.0 270.6]</span>
<span class="go">  [267.9  -2.0 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<p>An array of values can be assigned, as long as it is broadcastable to
the shape defined by the indices, using the <a class="reference external" href="https://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">numpy broadcasting rules</a>.</p>
<div class="literal-block-wrapper docutils container" id="id77">
<div class="code-block-caption"><span class="caption-text"><em>Overwrite the square of values of -3 with the numbers 0
to 8, and set the corners of a different square to be
either -4 or -5.</em></span><a class="headerlink" href="#id77" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span> <span class="o">=</span>  <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2  -4.0 270.2 280.0 272.5  -5.0]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2  -2.0 262.5   6.0   7.0   8.0 270.4 268.6 275.3]</span>
<span class="go">  [263.9  -2.0 272.1   3.0   4.0   5.0 260.0 263.5 270.2]</span>
<span class="go">  [273.8  -2.0 268.5   0.0   1.0   2.0 270.6 273.0 270.6]</span>
<span class="go">  [267.9  -2.0 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1  -4.0 268.1 277.0 273.4  -5.0]]]</span>
</pre></div>
</div>
</div>
<p>Data array elements may be set to missing values by assigning them to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.masked</span></code> <a class="footnote-reference" href="#masked" id="id20">[3]</a>. Missing values may be unmasked by assigning
them to any other value.</p>
<div class="literal-block-wrapper docutils container" id="id78">
<div class="code-block-caption"><span class="caption-text"><em>Set a column of elements to missing values, and then
change one of them back to a non-missing value.</em></span><a class="headerlink" href="#id78" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">masked</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5    -- 269.2]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2    -- 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2  -4.0 270.2 280.0    --  -5.0]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9    -- 260.6]</span>
<span class="go">  [264.2  -2.0 262.5   6.0   7.0   8.0 270.4    -- 275.3]</span>
<span class="go">  [263.9  -2.0 272.1   3.0   4.0   5.0 260.0  -6.0 270.2]</span>
<span class="go">  [273.8  -2.0 268.5   0.0   1.0   2.0 270.6    -- 270.6]</span>
<span class="go">  [267.9  -2.0 279.8 260.3 261.2 275.3 271.2    -- 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0    -- 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1  -4.0 268.1 277.0    --  -5.0]]]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="manipulating-dimensions">
<h3><strong>Manipulating dimensions</strong><a class="headerlink" href="#manipulating-dimensions" title="Permalink to this headline">¶</a></h3>
<p>The dimensions of a field construct’s data may be reordered, have size
one dimensions removed and have new new size one dimensions included
by using the following field construct methods:</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.transpose.html#cfdm.Field.transpose" title="cfdm.Field.transpose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transpose</span></code></a></td>
<td>Reorder data dimensions</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.squeeze.html#cfdm.Field.squeeze" title="cfdm.Field.squeeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">squeeze</span></code></a></td>
<td>Remove size one data dimensions</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.insert_dimension.html#cfdm.Field.insert_dimension" title="cfdm.Field.insert_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insert_dimension</span></code></a></td>
<td>Insert a new size one data dimension. The
new dimension must correspond to an
existing size one domain axis construct.</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id79">
<div class="code-block-caption"><span class="caption-text"><em>Remove all size one dimensions from the data, noting
that metadata constructs which span the corresponding
domain axis construct are not affected.</em></span><a class="headerlink" href="#id79" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span>
<span class="go">&lt;Field: air_temperature(grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">dimension_coordinates</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id80">
<div class="code-block-caption"><span class="caption-text"><em>Insert a new size one dimension, corresponding to a size
one domain axis construct, and then reorder the
dimensions.</em></span><a class="headerlink" href="#id80" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">insert_dimension</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;domainaxis3&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span>
<span class="go">&lt;Field: air_temperature(grid_latitude(10), time(1), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">&lt;Field: air_temperature(grid_longitude(9), grid_latitude(10), time(1)) K&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="subspacing">
<span id="id21"></span><h2><strong>Subspacing</strong><a class="headerlink" href="#subspacing" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Creation of a new field construct which spans a subspace of the domain
of an existing field construct is achieved by indexing the field
itself, rather than its <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance. This is because the operation
must also subspace any metadata constructs of the field construct
(e.g. coordinate metadata constructs) which span any of the domain
axis constructs that are affected. The new field construct is created
with the same properties as the original field. Subspacing uses the
same <a class="reference internal" href="#indexing"><span class="std std-ref">cfdm indexing rules</span></a> that apply to the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a>
class.</p>
<div class="literal-block-wrapper docutils container" id="id81">
<div class="code-block-caption"><span class="caption-text"><em>Create a new field whose domain spans the first longitude
of the original, and with a reversed latitude axis.</em></span><a class="headerlink" href="#id81" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span> <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
 <span class="n">Field</span><span class="p">:</span> <span class="n">specific_humidity</span> <span class="p">(</span><span class="n">ncvar</span><span class="o">%</span><span class="n">q</span><span class="p">)</span>
 <span class="o">----------------------------------</span>
 <span class="n">Data</span>            <span class="p">:</span> <span class="n">specific_humidity</span><span class="p">(</span><span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">longitude</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="mi">1</span>
 <span class="n">Cell</span> <span class="n">methods</span>    <span class="p">:</span> <span class="n">area</span><span class="p">:</span> <span class="n">mean</span>
 <span class="n">Dimension</span> <span class="n">coords</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2019</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span>
                 <span class="p">:</span> <span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">75.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">]</span> <span class="n">degrees_north</span>
                 <span class="p">:</span> <span class="n">longitude</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">22.5</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">337.5</span><span class="p">]</span> <span class="n">degrees_east</span>

 <span class="o">&gt;&gt;&gt;</span> <span class="n">new</span> <span class="o">=</span> <span class="n">q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
 <span class="n">Field</span><span class="p">:</span> <span class="n">specific_humidity</span> <span class="p">(</span><span class="n">ncvar</span><span class="o">%</span><span class="n">q</span><span class="p">)</span>
 <span class="o">----------------------------------</span>
 <span class="n">Data</span>            <span class="p">:</span> <span class="n">specific_humidity</span><span class="p">(</span><span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">longitude</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="mi">1</span>
 <span class="n">Cell</span> <span class="n">methods</span>    <span class="p">:</span> <span class="n">area</span><span class="p">:</span> <span class="n">mean</span>
 <span class="n">Dimension</span> <span class="n">coords</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2019</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span>
                 <span class="p">:</span> <span class="n">latitude</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">75.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">75.0</span><span class="p">]</span> <span class="n">degrees_north</span>
                 <span class="p">:</span> <span class="n">longitude</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">22.5</span><span class="p">]</span> <span class="n">degrees_east</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="filtering-metadata-constructs">
<span id="id22"></span><h2><strong>Filtering metadata constructs</strong><a class="headerlink" href="#filtering-metadata-constructs" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>A <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance has filtering methods for selecting constructs
that meet various criteria:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Filter criteria</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_identity.html#cfdm.Constructs.filter_by_identity" title="cfdm.Constructs.filter_by_identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_identity</span></code></a></td>
<td>Metadata construct identity</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_type.html#cfdm.Constructs.filter_by_type" title="cfdm.Constructs.filter_by_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_type</span></code></a></td>
<td>Metadata construct type</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_property.html#cfdm.Constructs.filter_by_property" title="cfdm.Constructs.filter_by_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_property</span></code></a></td>
<td>Property values</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_axis.html#cfdm.Constructs.filter_by_axis" title="cfdm.Constructs.filter_by_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_axis</span></code></a></td>
<td>The domain axis constructs spanned by the data</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_naxes.html#cfdm.Constructs.filter_by_naxes" title="cfdm.Constructs.filter_by_naxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_naxes</span></code></a></td>
<td>The number of domain axis constructs spanned by the data</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_measure.html#cfdm.Constructs.filter_by_measure" title="cfdm.Constructs.filter_by_measure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_measure</span></code></a></td>
<td>Measure value (for cell measure constructs)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_method.html#cfdm.Constructs.filter_by_method" title="cfdm.Constructs.filter_by_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_method</span></code></a></td>
<td>Method value (for cell method constructs)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_data.html#cfdm.Constructs.filter_by_data" title="cfdm.Constructs.filter_by_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_data</span></code></a></td>
<td>Whether or not there could be be data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_key.html#cfdm.Constructs.filter_by_key" title="cfdm.Constructs.filter_by_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_key</span></code></a></td>
<td>Construct key</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_ncvar.html#cfdm.Constructs.filter_by_ncvar" title="cfdm.Constructs.filter_by_ncvar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_ncvar</span></code></a></td>
<td>Netcdf variable name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Constructs.filter_by_ncdim.html#cfdm.Constructs.filter_by_ncdim" title="cfdm.Constructs.filter_by_ncdim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_ncdim</span></code></a></td>
<td>Netcdf dimension name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>)</td>
</tr>
</tbody>
</table>
<p>Each of these methods returns a new <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance that
contains the selected constructs.</p>
<div class="literal-block-wrapper docutils container" id="id82">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their type</em>.</span><a class="headerlink" href="#id82" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;cell_method&#39;</span><span class="p">,</span> <span class="s1">&#39;field_ancillary&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id83">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their properties</em>.</span><a class="headerlink" href="#id83" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">units</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="s1">&#39;or&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary0&#39;: &lt;DomainAncillary: ncvar%a(1) m&gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id84">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs whose data span the ‘domainaxis1’ domain
axis construct; and those which also do not span the
‘domainaxis2’ domain axis construct.</em></span><a class="headerlink" href="#id84" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_axis</span><span class="p">(</span><span class="n">domainaxis1</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_axis</span><span class="p">(</span><span class="n">domainaxis1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">domainaxis2</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id85">
<div class="code-block-caption"><span class="caption-text"><em>Get cell measure constructs by their “measure”.</em></span><a class="headerlink" href="#id85" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_measure</span><span class="p">(</span><span class="s1">&#39;area&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id86">
<div class="code-block-caption"><span class="caption-text"><em>Get cell method constructs by their “method”.</em></span><a class="headerlink" href="#id86" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_method</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;}</span>
</pre></div>
</div>
</div>
<p>As each of these methods returns a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance, it is easy
to perform further filters on their results:</p>
<div class="literal-block-wrapper docutils container" id="id87">
<div class="code-block-caption"><span class="caption-text"><em>Make selections from previous selections.</em></span><a class="headerlink" href="#id87" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;auxiliary_coordinate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter_by_axis</span><span class="p">(</span><span class="n">domainaxis2</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;}</span>
</pre></div>
</div>
</div>
<p>Another method of selection is by metadata construct “identity”.
Construct identities are used to describe constructs when they are
inspected, and so it is often convenient to copy these identities
when selecting metadata constructs. For example, the <a class="reference internal" href="#medium-detail"><span class="std std-ref">three
auxiliary coordinate constructs</span></a> in the field
construct <code class="docutils literal notranslate"><span class="pre">t</span></code> have identities <code class="docutils literal notranslate"><span class="pre">'latitude'</span></code>, <code class="docutils literal notranslate"><span class="pre">'longitude'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'long_name=Grid</span> <span class="pre">latitude</span> <span class="pre">name'</span></code>.</p>
<p>A construct’s identity may be any one of the following</p>
<ul class="simple">
<li>The value of the “standard_name” property, e.g. <code class="docutils literal notranslate"><span class="pre">'air_temperature'</span></code>,</li>
<li>The value of any property, preceded by the property name and an
equals, e.g. <code class="docutils literal notranslate"><span class="pre">'long_name=Air</span> <span class="pre">Temperature'</span></code>, <code class="docutils literal notranslate"><span class="pre">'axis=X'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'foo=bar'</span></code>, etc.,</li>
<li>The cell measure, preceded by “measure:”, e.g. <code class="docutils literal notranslate"><span class="pre">'measure:volume'</span></code></li>
<li>The cell method, preceded by “method:”, e.g. <code class="docutils literal notranslate"><span class="pre">'method:maximum'</span></code></li>
<li>The netCDF variable name, preceded by “ncvar%”,
e.g. <code class="docutils literal notranslate"><span class="pre">'ncvar%tas'</span></code> (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>),</li>
<li>The netCDF dimension name, preceded by “ncdim%” e.g. <code class="docutils literal notranslate"><span class="pre">'ncdim%z'</span></code>
(see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>), and</li>
<li>The construct key, preceded by “key%”
e.g. <code class="docutils literal notranslate"><span class="pre">'key%auxiliarycoordinate2'</span></code>.</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id88">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their identity.</em></span><a class="headerlink" href="#id88" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.81, ..., 0.78]] K</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., kappa]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;long_name=Grid latitude name&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;ncvar%b&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary1&#39;: &lt;DomainAncillary: ncvar%b(1) &gt;}</span>
</pre></div>
</div>
</div>
<p>Each construct has an <code class="xref py py-obj docutils literal notranslate"><span class="pre">identity</span></code> method that, by default, returns the
least ambiguous identity (defined in the documentation of a
construct’s <code class="xref py py-obj docutils literal notranslate"><span class="pre">identity</span></code> method); and an <code class="xref py py-obj docutils literal notranslate"><span class="pre">identities</span></code> method that
returns a list of all of the identities that would select the
construct.</p>
<p>As a further convenience, selection by construct identity is also
possible by providing identities to a call of a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance
itself, and this technique for selecting constructs by identity will be
used in the rest of this tutorial:</p>
<div class="literal-block-wrapper docutils container" id="id89">
<div class="code-block-caption"><span class="caption-text"><em>Construct selection by identity is possible with via the
“filter_by_identity” method, or directly from the
“Constructs” instance.</em></span><a class="headerlink" href="#id89" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
</pre></div>
</div>
</div>
<p>Selection by construct key is useful for systematic metadata construct
access, or for when a metadata construct is not identifiable by other
means:</p>
<div class="literal-block-wrapper docutils container" id="id90">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by construct key.</em></span><a class="headerlink" href="#id90" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;domainancillary2&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;cellmethod1&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;auxiliarycoordinate2&#39;</span><span class="p">,</span> <span class="s1">&#39;cellmeasure0&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
<p>If no constructs match the given criteria, then an “empty”
<a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance is returned:</p>
<div class="literal-block-wrapper docutils container" id="id91">
<div class="code-block-caption"><span class="caption-text"><em>If no constructs meet the criteria then an empty
“Constructs” object is returned.</em></span><a class="headerlink" href="#id91" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;radiation_wavelength&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;Constructs: &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<p>The constructs that were <em>not</em> selected by a filter may be returned by
the <a class="reference internal" href="method/cfdm.Constructs.inverse_filter.html#cfdm.Constructs.inverse_filter" title="cfdm.Constructs.inverse_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_filter</span></code></a> method applied to the results of
filters:</p>
<div class="literal-block-wrapper docutils container" id="id92">
<div class="code-block-caption"><span class="caption-text"><em>Get the constructs that were not selected by a filter.</em></span><a class="headerlink" href="#id92" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;auxiliary_coordinate&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;Constructs: auxiliary_coordinate(3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">inverse_filter</span><span class="p">()</span>
<span class="go">&lt;Constructs: cell_measure(1), cell_method(2), coordinate_reference(2), dimension_coordinate(4), domain_ancillary(3), domain_axis(4), field_ancillary(1)&gt;</span>
</pre></div>
</div>
</div>
<p>Note that selection by construct type is equivalent to using the
particular method of the field construct for retrieving that type of
metadata construct:</p>
<div class="literal-block-wrapper docutils container" id="id93">
<div class="code-block-caption"><span class="caption-text"><em>The bespoke methods for retrieving constructs by type
are equivalent to a selection on all of the metadata
constructs.</em></span><a class="headerlink" href="#id93" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;cell_measure&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">cell_measures</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="metadata-construct-access">
<span id="id23"></span><h2><strong>Metadata construct access</strong><a class="headerlink" href="#metadata-construct-access" title="Permalink to this headline">¶</a></h2>
<p>An individual metadata construct may be returned, without its
construct key, by any of the following techniques:</p>
<ul class="simple">
<li>with the <a class="reference internal" href="method/cfdm.Field.construct.html#cfdm.Field.construct" title="cfdm.Field.construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct</span></code></a> method of a field construct,</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id94">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct with its construct
identity.</em></span><a class="headerlink" href="#id94" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>with the <a class="reference internal" href="method/cfdm.Field.construct_key.html#cfdm.Field.construct_key" title="cfdm.Field.construct_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct_key</span></code></a> and <a class="reference internal" href="method/cfdm.Field.get_construct.html#cfdm.Field.get_construct" title="cfdm.Field.get_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_construct</span></code></a> methods of
a field construct:</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id95">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct key with its construct
identity and use the key to get the construct itself</em></span><a class="headerlink" href="#id95" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>with the <a class="reference internal" href="method/cfdm.Constructs.value.html#cfdm.Constructs.value" title="cfdm.Constructs.value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value</span></code></a> method of a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance
that contains one construct,</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id96">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct via its identity
and the ‘value’ method.</em></span><a class="headerlink" href="#id96" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>with the <a class="reference internal" href="method/cfdm.Constructs.get.html#cfdm.Constructs.get" title="cfdm.Constructs.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a> method of a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance, or</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id97">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct via its construct
key and the ‘get’ method.</em></span><a class="headerlink" href="#id97" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>by indexing a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance with  a construct key.</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id98">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct via its construct
key and indexing</em></span><a class="headerlink" href="#id98" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cfdm.Field.construct.html#cfdm.Field.construct" title="cfdm.Field.construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct</span></code></a> method of the field construct and the
<a class="reference internal" href="method/cfdm.Constructs.value.html#cfdm.Constructs.value" title="cfdm.Constructs.value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value</span></code></a> method of the <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance will raise an
exception of there is not a unique metadata construct to return, but
this may be replaced with returning a default value or raising a
customised exception:</p>
<div class="literal-block-wrapper docutils container" id="id99">
<div class="code-block-caption"><span class="caption-text"><em>By default an exception is raised if there is not a
unique construct that meets the criteria. Alternatively,
the value of the “default” parameter is returned.</em></span><a class="headerlink" href="#id99" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:volume&#39;</span><span class="p">)</span>
<span class="go">ValueError: Can&#39;t return zero constructs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:volume&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_measure</span><span class="p">(</span><span class="s1">&#39;volume&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">ValueError: Can&#39;t return zero constructs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;No construct&#39;</span><span class="p">)</span>
<span class="go">&#39;No construct&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;My message&#39;</span><span class="p">))</span>
<span class="go">KeyError: &#39;My message&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;units=degrees&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">ValueError: Can&#39;t return 2 constructs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
<span class="go">None</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cfdm.Constructs.get.html#cfdm.Constructs.get" title="cfdm.Constructs.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a> method of a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance accepts an
optional second argument to be returned if the construct key does not
exist, exactly like the Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict.get" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict.get</span></code></a> method.</p>
<div class="section" id="metadata-construct-properties">
<span id="id24"></span><h3><strong>Metadata construct properties</strong><a class="headerlink" href="#metadata-construct-properties" title="Permalink to this headline">¶</a></h3>
<p>Metadata constructs share the <a class="reference internal" href="#properties"><span class="std std-ref">same API as the field construct</span></a> for accessing their properties:</p>
<div class="literal-block-wrapper docutils container" id="id100">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the “longitude” metadata construct, set a new
property, and then inspect all of the properties.</em></span><a class="headerlink" href="#id100" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span>
<span class="go">&lt;DimensionCoordinate: longitude(8) degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;units&#39;: &#39;degrees_east&#39;,</span>
<span class="go"> &#39;long_name&#39;: &#39;Longitude&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;longitude&#39;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id101">
<div class="code-block-caption"><span class="caption-text"><em>Get the metadata construct with units of “km2”, find its
canonical identity, and all of its valid identities, that
may be used for selection by the “filter_by_identity”
method</em></span><a class="headerlink" href="#id101" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;km2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CellMeasure: measure:area(9, 10) km2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">&#39;measure:area&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">identities</span><span class="p">()</span>
<span class="go">[&#39;measure:area&#39;, &#39;units=km2&#39;, &#39;ncvar%cell_measure&#39;]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="metadata-construct-data">
<span id="id25"></span><h3><strong>Metadata construct data</strong><a class="headerlink" href="#metadata-construct-data" title="Permalink to this headline">¶</a></h3>
<p>Metadata constructs share the <a class="reference internal" href="#data"><span class="std std-ref">a similar API as the field
construct</span></a> as the field construct for accessing their data:</p>
<div class="literal-block-wrapper docutils container" id="id102">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the “longitude” metadata construct, inspect its
data, change the third element of the array, and get the
data as a numpy array.</em></span><a class="headerlink" href="#id102" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span>
<span class="go">&lt;DimensionCoordinate: longitude(8) degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(8): [22.5, ..., 337.5] degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&lt;Data(1): [112.5] degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">133.33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[22.5 67.5 133.33 157.5 202.5 247.5 292.5 337.5]</span>
</pre></div>
</div>
</div>
<p>The domain axis constructs spanned by a particular metadata
construct’s data are found with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_axes</span></code> method
of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id103">
<div class="code-block-caption"><span class="caption-text"><em>Find the construct keys of the domain axis constructs
spanned by the data of each metadata construct.</em></span><a class="headerlink" href="#id103" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span>
<span class="go">&#39;auxiliarycoordinate0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
<span class="go">(&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
</pre></div>
</div>
</div>
<p>The domain axis constructs spanned by all the data of all metadata
construct may be found with the <a class="reference internal" href="method/cfdm.Constructs.data_axes.html#cfdm.Constructs.data_axes" title="cfdm.Constructs.data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data_axes</span></code></a> method of the
field construct’s <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance:</p>
<div class="literal-block-wrapper docutils container" id="id104">
<div class="code-block-caption"><span class="caption-text"><em>Find the construct keys of the domain axis constructs
spanned by the data of each metadata construct.</em></span><a class="headerlink" href="#id104" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">data_axes</span><span class="p">()</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;),</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: (&#39;domainaxis2&#39;, &#39;domainaxis1&#39;),</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;cellmeasure0&#39;: (&#39;domainaxis2&#39;, &#39;domainaxis1&#39;),</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: (&#39;domainaxis2&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: (&#39;domainaxis3&#39;,),</span>
<span class="go"> &#39;domainancillary0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;domainancillary1&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;domainancillary2&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;),</span>
<span class="go"> &#39;fieldancillary0&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)}</span>
</pre></div>
</div>
</div>
<p>A size one domain axis construct that is <em>not</em> spanned by the field
construct’s data may still be spanned by the data of metadata
constructs. For example, the data of the field construct <code class="docutils literal notranslate"><span class="pre">t</span></code>
<a class="reference internal" href="#data-axes"><span class="std std-ref">does not span the size one domain axis construct</span></a>
with key <code class="docutils literal notranslate"><span class="pre">'domainaxis3'</span></code>, but this domain axis construct is spanned
by a “time” dimension coordinate construct (with key
<code class="docutils literal notranslate"><span class="pre">'dimensioncoordinate3'</span></code>). Such a dimension coordinate (i.e. one
that applies to a domain axis construct that is not spanned by the
field construct’s data) corresponds to a CF-netCDF scalar coordinate
variable.</p>
</div>
</div>
<div class="section" id="time">
<span id="id26"></span><h2><strong>Time</strong><a class="headerlink" href="#time" title="Permalink to this headline">¶</a></h2>
<p>Constructs representing elapsed time (identified by the presence of
“reference time” units) have data array values that represent elapsed
time since a reference date. These values may be converted into the
date-time objects of the <a class="reference external" href="https://unidata.github.io/cftime/">cftime package</a> with the <a class="reference internal" href="attribute/cfdm.Data.datetime_array.html#cfdm.Data.datetime_array" title="cfdm.Data.datetime_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime_array</span></code></a>
method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<div class="literal-block-wrapper docutils container" id="id105">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the the values of a “time” construct as elapsed
times and as date-times.</em></span><a class="headerlink" href="#id105" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span>
<span class="go">&lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">)</span>
<span class="go">&#39;days since 2018-12-01&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;calendar&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span>
<span class="go">&#39;standard&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[ 31.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.DatetimeGregorian(2019, 1, 1, 0, 0, 0, 0, 1, 1)]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="domain">
<span id="id28"></span><h2><strong>Domain</strong><a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The <a class="reference internal" href="introduction.html#cf-data-model"><span class="std std-ref">domain of the CF data model</span></a> is <em>not</em> a
construct, but is defined collectively by various other metadata
constructs included in the field construct. It is represented by the
<a class="reference internal" href="class/cfdm.Domain.html#cfdm.Domain" title="cfdm.Domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Domain</span></code></a> class. The domain instance may be accessed with the
<a class="reference internal" href="attribute/cfdm.Field.domain.html#cfdm.Field.domain" title="cfdm.Field.domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain</span></code></a> attribute, or <a class="reference internal" href="method/cfdm.Field.get_domain.html#cfdm.Field.get_domain" title="cfdm.Field.get_domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_domain</span></code></a> method, of the field
construct.</p>
<div class="literal-block-wrapper docutils container" id="id106">
<div class="code-block-caption"><span class="caption-text"><em>Get the domain, and inspect it.</em></span><a class="headerlink" href="#id106" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span>
<span class="go">&lt;Domain: {1, 1, 9, 10}&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
<span class="go">Dimension coords: atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., kappa]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">description</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Changes to domain instance are seen by the field construct, and vice
versa. This is because the domain instance is merely a “view” of the
relevant metadata constructs contained in the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id107">
<div class="code-block-caption"><span class="caption-text"><em>Change a property of a metadata construct of the domain
and show that this change appears in the same metadata
data construct of the parent field, and vice versa.</em></span><a class="headerlink" href="#id107" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;set by domain&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">field_latitude</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
<span class="go">set by domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;set by field&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
<span class="go">set by field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">&#39;set by field&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<p>All of the methods and attributes related to the domain are listed
<a class="reference internal" href="class/cfdm.Field.html#field-domain"><span class="std std-ref">here</span></a>.</p>
</div>
<div class="section" id="domain-axes">
<span id="id29"></span><h2><strong>Domain axes</strong><a class="headerlink" href="#domain-axes" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>A domain axis metadata construct specifies the number of points along
an independent axis of the field construct’s domain and is stored in a
<a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a> instance. The size of the axis is retrieved with
the <a class="reference internal" href="method/cfdm.DomainAxis.get_size.html#cfdm.DomainAxis.get_size" title="cfdm.DomainAxis.get_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code></a> method of the domain axis construct.</p>
<div class="literal-block-wrapper docutils container" id="id108">
<div class="code-block-caption"><span class="caption-text"><em>Get the size of a domain axis construct.</em></span><a class="headerlink" href="#id108" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;DomainAxis: size(5)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(8)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">domain_axes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domainaxis1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">&lt;DomainAxis: size(8)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="coordinates">
<span id="id30"></span><h2><strong>Coordinates</strong><a class="headerlink" href="#coordinates" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>There are two types of coordinate construct, dimension and auxiliary
coordinate constructs, which can be retrieved together with the
<a class="reference internal" href="method/cfdm.Field.coordinates.html#cfdm.Field.coordinates" title="cfdm.Field.coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinates</span></code></a> method of the field construct, as well as
individually with the <a class="reference internal" href="method/cfdm.Field.auxiliary_coordinates.html#cfdm.Field.auxiliary_coordinates" title="cfdm.Field.auxiliary_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auxiliary_coordinates</span></code></a> and
<a class="reference internal" href="method/cfdm.Field.dimension_coordinates.html#cfdm.Field.dimension_coordinates" title="cfdm.Field.dimension_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimension_coordinates</span></code></a> methods.</p>
<div class="literal-block-wrapper docutils container" id="id109">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve both types of coordinate constructs.</em></span><a class="headerlink" href="#id109" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
</pre></div>
</div>
</div>
<div class="section" id="bounds">
<span id="id31"></span><h3><strong>Bounds</strong><a class="headerlink" href="#bounds" title="Permalink to this headline">¶</a></h3>
<p>A coordinate construct may contain an array of cell bounds that
provides the extent of each cell by defining the locations of the cell
vertices. This is in addition to the main data array that contains a
grid point location for each cell. The cell bounds are stored in a
<a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> class instance that is accessed with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">bounds</span></code>
attribute, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bounds</span></code> method, of the coordinate
construct.</p>
<p>A <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> instance shares the <a class="reference internal" href="#data"><span class="std std-ref">the same API as the field
construct</span></a> for accessing its data.</p>
<div class="literal-block-wrapper docutils container" id="id110">
<div class="code-block-caption"><span class="caption-text"><em>Get the Bounds instance of a coordinate construct and
inspect its data.</em></span><a class="headerlink" href="#id110" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">lon</span><span class="o">.</span><span class="n">bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span>
<span class="go">&lt;Bounds: grid_longitude(9, 2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(9, 2): [[-4.92, ..., -0.96]]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[-4.92 -4.48]</span>
<span class="go"> [-4.48 -4.04]</span>
<span class="go"> [-4.04 -3.6 ]</span>
<span class="go"> [-3.6  -3.16]</span>
<span class="go"> [-3.16 -2.72]</span>
<span class="go"> [-2.72 -2.28]</span>
<span class="go"> [-2.28 -1.84]</span>
<span class="go"> [-1.84 -1.4 ]</span>
<span class="go"> [-1.4  -0.96]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> instance inherits the descriptive properties from its
parent coordinate construct, but it may also have its own properties
(although setting these is not recommended).</p>
<div class="literal-block-wrapper docutils container" id="id111">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the inherited and bespoke properties of a Bounds
instance.</em></span><a class="headerlink" href="#id111" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">inherited_properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;grid_longitude&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;degrees&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="domain-ancillaries">
<span id="id32"></span><h2><strong>Domain ancillaries</strong><a class="headerlink" href="#domain-ancillaries" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>A domain ancillary construct provides information which is needed for
computing the location of cells in an alternative <a class="reference internal" href="#coordinate-systems"><span class="std std-ref">coordinate
system</span></a>. If a domain ancillary construct provides
extra coordinates then it may contain cell bounds in addition to its
main data array.</p>
<div class="literal-block-wrapper docutils container" id="id112">
<div class="code-block-caption"><span class="caption-text"><em>Get the data and bounds data of a domain ancillary
construct.</em></span><a class="headerlink" href="#id112" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domainancillary0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[10.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span>
<span class="go">&lt;Bounds: ncvar%a_bounds(1, 2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[  5.  15.]]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="coordinate-systems">
<span id="id33"></span><h2><strong>Coordinate systems</strong><a class="headerlink" href="#coordinate-systems" title="Permalink to this headline">¶</a></h2>
<p>A field construct may contain various coordinate systems. Each
coordinate system is either defined by a coordinate reference
construct that relates dimension coordinate, auxiliary coordinate and
domain ancillary constructs (as is the case for the field construct
<code class="docutils literal notranslate"><span class="pre">t</span></code>), or is inferred from dimension and auxiliary coordinate
constructs alone (as is the case for the field construct <code class="docutils literal notranslate"><span class="pre">q</span></code>).</p>
<p>A coordinate reference construct contains</p>
<ul class="simple">
<li>references (by construct keys) to the dimension and auxiliary
coordinate constructs to which it applies, accessed with the
<a class="reference internal" href="method/cfdm.CoordinateReference.coordinates.html#cfdm.CoordinateReference.coordinates" title="cfdm.CoordinateReference.coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinates</span></code></a> method of the coordinate
reference construct;</li>
</ul>
<ul class="simple">
<li>the zeroes of the dimension and auxiliary coordinate constructs
which define the coordinate system, stored in a <a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a> instance,
which is accessed with the <a class="reference internal" href="attribute/cfdm.CoordinateReference.datum.html#cfdm.CoordinateReference.datum" title="cfdm.CoordinateReference.datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datum</span></code></a> attribute,
or <a class="reference internal" href="method/cfdm.CoordinateReference.get_datum.html#cfdm.CoordinateReference.get_datum" title="cfdm.CoordinateReference.get_datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_datum</span></code></a> method, of the coordinate
reference construct; and</li>
</ul>
<ul class="simple">
<li>a formula for converting coordinate values taken from the dimension
or auxiliary coordinate constructs to a different coordinate system,
stored in a <a class="reference internal" href="class/cfdm.CoordinateConversion.html#cfdm.CoordinateConversion" title="cfdm.CoordinateConversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateConversion</span></code></a> class instance, which is accessed
with the <a class="reference internal" href="attribute/cfdm.CoordinateReference.coordinate_conversion.html#cfdm.CoordinateReference.coordinate_conversion" title="cfdm.CoordinateReference.coordinate_conversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinate_conversion</span></code></a> attribute, or
<a class="reference internal" href="method/cfdm.CoordinateReference.get_coordinate_conversion.html#cfdm.CoordinateReference.get_coordinate_conversion" title="cfdm.CoordinateReference.get_coordinate_conversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_coordinate_conversion</span></code></a> method, of the
coordinate reference construct.</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id113">
<div class="code-block-caption"><span class="caption-text"><em>Select the vertical coordinate system construct and
inspect its coordinate constructs.</em></span><a class="headerlink" href="#id113" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;standard_name:atmosphere_hybrid_height_coordinate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span>
<span class="go">&lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Coordinate Reference: atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:computed_standard_name = altitude</span>
<span class="go">    Coordinate conversion:standard_name = atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:a = domainancillary0</span>
<span class="go">    Coordinate conversion:b = domainancillary1</span>
<span class="go">    Coordinate conversion:orog = domainancillary2</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Coordinate: dimensioncoordinate0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
<span class="go">{&#39;dimensioncoordinate0&#39;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id114">
<div class="code-block-caption"><span class="caption-text"><em>Get the datum and inspect its parameters.</em></span><a class="headerlink" href="#id114" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">datum</span>
<span class="go">&lt;Datum: Parameters: earth_radius&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
<span class="go">{&#39;earth_radius&#39;: 6371007}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id115">
<div class="code-block-caption"><span class="caption-text"><em>Get the coordinate conversion and inspect its parameters
and referenced domain ancillary constructs.</em></span><a class="headerlink" href="#id115" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span>
<span class="go">&lt;CoordinateConversion: Parameters: computed_standard_name, standard_name; Ancillaries: a, b, orog&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
<span class="go">{&#39;computed_standard_name&#39;: &#39;altitude&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;atmosphere_hybrid_height_coordinate&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span><span class="o">.</span><span class="n">domain_ancillaries</span><span class="p">()</span>
<span class="go">{&#39;a&#39;: &#39;domainancillary0&#39;,</span>
<span class="go"> &#39;b&#39;: &#39;domainancillary1&#39;,</span>
<span class="go"> &#39;orog&#39;: &#39;domainancillary2&#39;}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cell-methods">
<span id="id34"></span><h2><strong>Cell methods</strong><a class="headerlink" href="#cell-methods" title="Permalink to this headline">¶</a></h2>
<p>A cell method construct describes how the data represent the variation
of the physical quantity within the cells of the domain and is stored
in a <a class="reference internal" href="class/cfdm.CellMethod.html#cfdm.CellMethod" title="cfdm.CellMethod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMethod</span></code></a> instance. A field constructs allows multiple
cell method constructs to be recorded.</p>
<div class="literal-block-wrapper docutils container" id="id116">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the cell methods. The description follows the CF
conventions for cell_method attribute strings, apart from
the use of construct keys instead of netCDF variable
names for cell method axes identification.</em></span><a class="headerlink" href="#id116" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">cell_methods</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;}</span>
</pre></div>
</div>
</div>
<p>The application of cell methods is not commutative (e.g. a mean of
variances is generally not the same as a variance of means), so a
<a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance has an <a class="reference internal" href="method/cfdm.Constructs.ordered.html#cfdm.Constructs.ordered" title="cfdm.Constructs.ordered"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ordered</span></code></a> method to retrieve
the cell method constructs in the same order that they were were added
to the field construct during <a class="reference internal" href="#field-creation"><span class="std std-ref">field construct creation</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id117">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the cell method constructs in the same order
that they were applied.</em></span><a class="headerlink" href="#id117" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cell_methods</span><span class="o">.</span><span class="n">ordered</span><span class="p">()</span>
<span class="go">OrderedDict([(&#39;cellmethod0&#39;, &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;),</span>
<span class="go">             (&#39;cellmethod1&#39;, &lt;CellMethod: domainaxis3: maximum&gt;)])</span>
</pre></div>
</div>
</div>
<p>The axes to which the method applies, the method itself, and any
qualifying properties are accessed with the
<a class="reference internal" href="method/cfdm.CellMethod.get_axes.html#cfdm.CellMethod.get_axes" title="cfdm.CellMethod.get_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_axes</span></code></a>, <a class="reference internal" href="method/cfdm.CellMethod.get_method.html#cfdm.CellMethod.get_method" title="cfdm.CellMethod.get_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_method</span></code></a>, ,
<a class="reference internal" href="method/cfdm.CellMethod.get_qualifier.html#cfdm.CellMethod.get_qualifier" title="cfdm.CellMethod.get_qualifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_qualifier</span></code></a> and <a class="reference internal" href="method/cfdm.CellMethod.qualifiers.html#cfdm.CellMethod.qualifiers" title="cfdm.CellMethod.qualifiers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qualifiers</span></code></a>
methods of the cell method construct.</p>
<div class="literal-block-wrapper docutils container" id="id118">
<div class="code-block-caption"><span class="caption-text"><em>Get the domain axes constructs to which the cell method
construct applies, and the method and other properties.</em></span><a class="headerlink" href="#id118" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;method:mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span>
<span class="go">&lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
<span class="go">(&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_method</span><span class="p">()</span>
<span class="go">&#39;mean&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">()</span>
<span class="go">{&#39;interval&#39;: [&lt;Data(): 0.1 degrees&gt;], &#39;where&#39;: &#39;land&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_qualifier</span><span class="p">(</span><span class="s1">&#39;where&#39;</span><span class="p">)</span>
<span class="go">&#39;land&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="field-ancillaries">
<span id="id35"></span><h2><strong>Field ancillaries</strong><a class="headerlink" href="#field-ancillaries" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>A field ancillary construct provides metadata which are distributed
over the same domain as the field construct itself. For example, if a
field construct holds a data retrieved from a satellite instrument, a
field ancillary construct might provide the uncertainty estimates for
those retrievals (varying over the same spatiotemporal domain).</p>
<div class="literal-block-wrapper docutils container" id="id119">
<div class="code-block-caption"><span class="caption-text"><em>Get the properties and data of a field ancillary
construct.</em></span><a class="headerlink" href="#id119" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;fieldancillary0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">&lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;air_temperature standard_error&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(10, 9): [[0.76, ..., 0.32]] K&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="field-creation">
<span id="id36"></span><h2><strong>Field creation</strong><a class="headerlink" href="#field-creation" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>There are three methods for creating a field construct in memory:</p>
<ul class="simple">
<li><a class="reference internal" href="#manual-creation"><span class="std std-ref">Manual creation</span></a>: Instantiate instances of
field and metadata construct classes and manually provide the
connections between them.</li>
</ul>
<ul class="simple">
<li><a class="reference internal" href="#creation-by-conversion"><span class="std std-ref">Creation by conversion</span></a>: Convert a
single metadata construct already in memory to an independent field
construct</li>
</ul>
<ul class="simple">
<li><a class="reference internal" href="#creation-by-reading"><span class="std std-ref">Creation by reading</span></a>: Create field
constructs from the netCDF variables in a dataset.</li>
</ul>
<div class="section" id="manual-creation">
<span id="id37"></span><h3><strong>Manual creation</strong><a class="headerlink" href="#manual-creation" title="Permalink to this headline">¶</a></h3>
<p>Manual creation of a field construct has three stages:</p>
<p><strong>Stage 1:</strong> The field construct is created without metadata
constructs.</p>
<p><strong>Stage 2:</strong> Metadata constructs are created independently.</p>
<p><strong>Stage 3:</strong> The metadata constructs are inserted into the field
construct with cross-references to other, related metadata constructs
if required. For example, an auxiliary coordinate construct is related
to an ordered list of the domain axis constructs which correspond to
its data array dimensions.</p>
<p>There are two equivalent approaches to <strong>stages 1</strong> and <strong>2</strong>.</p>
<p>Either as much of the content as possible is specified during object
instantiation:</p>
<div class="literal-block-wrapper docutils container" id="id120">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with a “standard_name”
property. Create dimension coordinate and field ancillary
constructs, both with properties and data.</em></span><a class="headerlink" href="#id120" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: precipitation_flux&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">},</span>
<span class="gp">... </span>                              <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;DimensionCoordinate: long_name=Longitude(3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux status_flag&#39;</span><span class="p">},</span>
<span class="gp">... </span>       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: precipitation_flux status_flag(3) &gt;</span>
</pre></div>
</div>
</div>
<p>or else some or all content is added after instantiation via object
methods:</p>
<div class="literal-block-wrapper docutils container" id="id121">
<div class="code-block-caption"><span class="caption-text"><em>Create empty constructs and provide them with properties
and data after instantiation.</em></span><a class="headerlink" href="#id121" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: precipitation_flux&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;DimensionCoordinate:  &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;DimensionCoordinate: long_name=Longitude(3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: (3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux status_flag&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: precipitation_flux status_flag(3) &gt;</span>
</pre></div>
</div>
</div>
<p>For <strong>stage 3</strong>, the <a class="reference internal" href="method/cfdm.Field.set_construct.html#cfdm.Field.set_construct" title="cfdm.Field.set_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_construct</span></code></a> method of the field
construct is used for setting metadata constructs and mapping data
array dimensions to domain axis constructs. This method returns the
construct key for the metadata construct which can be used when other
metadata constructs are added to the field (e.g. to specify which
domain axis constructs correspond to a data array), or when other
metadata constructs are created (e.g. to identify the domain ancillary
constructs forming part of a coordinate reference construct):</p>
<div class="literal-block-wrapper docutils container" id="id122">
<div class="code-block-caption"><span class="caption-text"><em>Set a domain axis construct and use its construct key
when setting the dimension coordinate construct. Also
create a cell method construct that applies to the domain
axis construct.</em></span><a class="headerlink" href="#id122" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_axis</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_axis</span>
<span class="go">&#39;domainaxis0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">longitude_axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span>
<span class="go">&#39;dimensioncoordinate0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">longitude_axis</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;minimum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="go">&#39;cellmethod0&#39;</span>
</pre></div>
</div>
</div>
<p>In general, the order in which metadata constructs are added to the
field does not matter, except when one metadata construct is required
by another, in which case the former must be added to the field first
so that its construct key is available to the latter. Cell method
constructs must, however, be set in the relative order in which their
methods were applied to the data.</p>
<p>The domain axis constructs spanned by a metadata construct’s data may
be changed after insertion with the <a class="reference internal" href="method/cfdm.Field.set_data_axes.html#cfdm.Field.set_data_axes" title="cfdm.Field.set_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data_axes</span></code></a> method of
the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id123">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with properties; data; and
domain axis, cell method and dimension coordinate
metadata constructs (data arrays have been generated with
dummy values using numpy.arange).</em></span><a class="headerlink" href="#id123" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Initialise the field construct with properties</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;specific_humidity&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs</span>
<span class="n">domain_axisT</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">domain_axisY</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">domain_axisX</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Insert the domain axis constructs into the field. The</span>
<span class="c1"># set_construct method returns the domain axis construct key that</span>
<span class="c1"># will be used later to specify which domain axis corresponds to</span>
<span class="c1"># which dimension coordinate construct.</span>
<span class="n">axisT</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisT</span><span class="p">)</span>
<span class="n">axisY</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisY</span><span class="p">)</span>
<span class="n">axisX</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisX</span><span class="p">)</span>

<span class="c1"># Create and insert the field construct data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">40.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axisY</span><span class="p">,</span> <span class="n">axisX</span><span class="p">])</span>

<span class="c1"># Create the cell method constructs</span>
<span class="n">cell_method1</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="n">cell_method2</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">()</span>
<span class="n">cell_method2</span><span class="o">.</span><span class="n">set_axes</span><span class="p">(</span><span class="n">axisT</span><span class="p">)</span>
<span class="n">cell_method2</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">)</span>

<span class="c1"># Insert the cell method constructs into the field in the same</span>
<span class="c1"># order that their methods were applied to the data</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method1</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method2</span><span class="p">)</span>

<span class="c1"># Create a &quot;time&quot; dimension coordinate construct, with coordinate</span>
<span class="c1"># bounds</span>
<span class="n">dimT</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
                            <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days since 2018-12-01&#39;</span><span class="p">},</span>
                            <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">15.5</span><span class="p">]),</span>
                            <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mf">31.</span><span class="p">]])))</span>

<span class="c1"># Create a &quot;longitude&quot; dimension coordinate construct, without</span>
<span class="c1"># coordinate bounds</span>
<span class="n">dimX</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">8.</span><span class="p">)))</span>
<span class="n">dimX</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">})</span>

<span class="c1"># Create a &quot;longitude&quot; dimension coordinate construct</span>
<span class="n">dimY</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">})</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

<span class="c1"># Create and insert the latitude coordinate bounds</span>
<span class="n">bounds_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">bounds_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="n">bounds_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">bounds_array</span><span class="p">))</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

<span class="c1"># Insert the dimension coordinate constructs into the field,</span>
<span class="c1"># specifying to # which domain axis each one corresponds</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimT</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axisT</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimY</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axisY</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimX</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axisX</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id124">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct.</em></span><a class="headerlink" href="#id124" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">------------------------</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;specific_humidity&#39;</span>
<span class="go">units = &#39;1&#39;</span>

<span class="go">Data(latitude(5), longitude(8)) = [[0.0, ..., 39.0]] 1</span>

<span class="go">Cell Method: area: mean</span>
<span class="go">Cell Method: time(1): maximum</span>

<span class="go">Domain Axis: latitude(5)</span>
<span class="go">Domain Axis: longitude(8)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2018-12-16 12:00:00]</span>
<span class="go">    Bounds:Data(time(1), 2) = [[2018-12-01 00:00:00, 2019-01-01 00:00:00]]</span>

<span class="go">Dimension coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_north&#39;</span>
<span class="go">    Data(latitude(5)) = [0.0, ..., 4.0] degrees_north</span>
<span class="go">    Bounds:Data(latitude(5), 2) = [[-0.5, ..., 4.5]] degrees_north</span>

<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(longitude(8)) = [0.0, ..., 7.0] degrees_east</span>
</pre></div>
</div>
</div>
<p>The “Conventions” property does not need to be set because it is
automatically included in output files as a netCDF global
“Conventions” attribute, either as the CF version of the cfdm package
(as returned by the <a class="reference internal" href="function/cfdm.CF.html#cfdm.CF" title="cfdm.CF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.CF</span></code></a> function), or else specified via the
<em>Conventions</em> keyword of the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function. See the section on
<a class="reference internal" href="#writing-to-disk"><span class="std std-ref">Writing to disk</span></a> for details on how to specify additional
conventions.</p>
<p>If this field were to be written to a netCDF dataset then, in the
absence of predefined names, default netCDF variable and dimension
names would be automatically generated (based on standard names where
they exist). The setting of bespoke netCDF names is, however, easily
done with the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id125">
<div class="code-block-caption"><span class="caption-text"><em>Set netCDF variable and dimension names for the field
and metadata constructs.</em></span><a class="headerlink" href="#id125" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>

<span class="n">domain_axisT</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">domain_axisY</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">domain_axisX</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>

<span class="n">dimT</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">dimX</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Here is a more complete example which creates a field construct that
contains every type of metadata construct (again, data arrays have
been generated with dummy values using <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html#numpy.arange" title="(in NumPy v1.16)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.arange</span></code></a>):</p>
<div class="literal-block-wrapper docutils container" id="id126">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct that contains at least one
instance of each type of metadata construct.</em></span><a class="headerlink" href="#id126" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Initialize the field construct</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span>
                <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>

<span class="c1"># Create and set domain axis constructs</span>
<span class="n">axis_T</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axis_Z</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axis_Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">axis_X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>

<span class="c1"># Set the field construct data</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
             <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create and set the cell method constructs</span>
<span class="n">cell_method1</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span>
          <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">],</span>
          <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
          <span class="n">qualifiers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;where&#39;</span><span class="p">:</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">)]})</span>

<span class="n">cell_method2</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axis_T</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">)</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method1</span><span class="p">)</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method2</span><span class="p">)</span>

<span class="c1"># Create and set the field ancillary constructs</span>
<span class="n">field_ancillary</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
             <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">},</span>
             <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">field_ancillary</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create and set the dimension coordinate constructs</span>
<span class="n">dimension_coordinate_T</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
                           <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days since 2018-12-01&#39;</span><span class="p">},</span>
                           <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">15.5</span><span class="p">]),</span>
                           <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">31</span><span class="p">]])))</span>

<span class="n">dimension_coordinate_Z</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;computed_standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">},</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">1.5</span><span class="p">]),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])))</span>

<span class="n">dimension_coordinate_Y</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;grid_latitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.</span><span class="p">)),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>

<span class="n">dimension_coordinate_X</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;grid_longitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
    <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)),</span>
    <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>

<span class="n">dim_T</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_T</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_T</span><span class="p">)</span>
<span class="n">dim_Z</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_Z</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">dim_Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_Y</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Y</span><span class="p">)</span>
<span class="n">dim_X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_X</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_X</span><span class="p">)</span>

<span class="c1"># Create and set the auxiliary coordinate constructs</span>
<span class="n">auxiliary_coordinate_lat</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                      <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">},</span>
                      <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">auxiliary_coordinate_lon</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                  <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">},</span>
                  <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdefghij&#39;</span><span class="p">))</span>
<span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="n">auxiliary_coordinate_name</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Grid latitude name&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

<span class="n">aux_LAT</span>  <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_lat</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>
<span class="n">aux_LON</span>  <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_lon</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_X</span><span class="p">,</span> <span class="n">axis_Y</span><span class="p">])</span>
<span class="n">aux_NAME</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_name</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">])</span>

<span class="c1"># Create and set domain ancillary constructs</span>
<span class="n">domain_ancillary_a</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                   <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                   <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">10.</span><span class="p">]),</span>
                   <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">]])))</span>

<span class="n">domain_ancillary_b</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">20.</span><span class="p">]),</span>
                       <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">14</span><span class="p">,</span> <span class="mf">26.</span><span class="p">]])))</span>

<span class="n">domain_ancillary_orog</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                          <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;surface_altitude&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                          <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">domain_anc_A</span>    <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_a</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">domain_anc_B</span>    <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_b</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">domain_anc_OROG</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_orog</span><span class="p">,</span>
                                    <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create the datum for the coordinate reference constructs</span>
<span class="n">datum</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Datum</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;earth_radius&#39;</span><span class="p">:</span> <span class="mf">6371007.</span><span class="p">})</span>

<span class="c1"># Create the coordinate conversion for the horizontal coordinate</span>
<span class="c1"># reference construct</span>
<span class="n">coordinate_conversion_h</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateConversion</span><span class="p">(</span>
              <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;grid_mapping_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rotated_latitude_longitude&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;grid_north_pole_latitude&#39;</span><span class="p">:</span> <span class="mf">38.0</span><span class="p">,</span>
                          <span class="s1">&#39;grid_north_pole_longitude&#39;</span><span class="p">:</span> <span class="mf">190.0</span><span class="p">})</span>

<span class="c1"># Create the coordinate conversion for the vertical coordinate</span>
<span class="c1"># reference construct</span>
<span class="n">coordinate_conversion_v</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateConversion</span><span class="p">(</span>
         <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;computed_standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">},</span>
         <span class="n">domain_ancillaries</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">domain_anc_A</span><span class="p">,</span>
                             <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">domain_anc_B</span><span class="p">,</span>
                             <span class="s1">&#39;orog&#39;</span><span class="p">:</span> <span class="n">domain_anc_OROG</span><span class="p">})</span>

<span class="c1"># Create the vertical coordinate reference construct</span>
<span class="n">horizontal_crs</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateReference</span><span class="p">(</span>
                   <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
                   <span class="n">coordinate_conversion</span><span class="o">=</span><span class="n">coordinate_conversion_h</span><span class="p">,</span>
                   <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">dim_X</span><span class="p">,</span>
                                <span class="n">dim_Y</span><span class="p">,</span>
                                <span class="n">aux_LAT</span><span class="p">,</span>
                                <span class="n">aux_LON</span><span class="p">])</span>

<span class="c1"># Create the vertical coordinate reference construct</span>
<span class="n">vertical_crs</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateReference</span><span class="p">(</span>
                 <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
                 <span class="n">coordinate_conversion</span><span class="o">=</span><span class="n">coordinate_conversion_v</span><span class="p">,</span>
                 <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">dim_Z</span><span class="p">])</span>

<span class="c1"># Set the coordinate reference constructs</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">horizontal_crs</span><span class="p">)</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">vertical_crs</span><span class="p">)</span>

<span class="c1"># Create and set the cell measure constructs</span>
<span class="n">cell_measure</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMeasure</span><span class="p">(</span><span class="n">measure</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">,</span>
                 <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;km2&#39;</span><span class="p">},</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_measure</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_X</span><span class="p">,</span> <span class="n">axis_Y</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The new field construct may now be inspected:</p>
<div class="literal-block-wrapper docutils container" id="id127">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct.</em></span><a class="headerlink" href="#id127" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tas</span><span class="p">)</span>
<span class="go">Field: air_temperature</span>
<span class="go">----------------------</span>
<span class="go">Data            : air_temperature(grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] K</span>
<span class="go">Dimension coords: time(1) = [2018-12-16 12:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] degrees_north</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] degrees_east</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., j]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : domainancillary0(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : domainancillary1(atmosphere_hybrid_height_coordinate(1)) = [20.0] 1</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] m</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-data-from-an-array-on-disk">
<span id="id38"></span><h3>Creating data from an array on disk<a class="headerlink" href="#creating-data-from-an-array-on-disk" title="Permalink to this headline">¶</a></h3>
<p>All the of above examples use arrays in memory to construct the data
instances for the field and metadata constructs. It is, however,
possible to create data from arrays that reside on disk. The
<a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function creates data in this manner. A pointer to an
array in a netCDF file can be stored in a <a class="reference internal" href="class/cfdm.NetCDFArray.html#cfdm.NetCDFArray" title="cfdm.NetCDFArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NetCDFArray</span></code></a>
instance, which is is used to initialize a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<div class="literal-block-wrapper docutils container" id="id128">
<div class="code-block-caption"><span class="caption-text"><em>Define a variable from a dataset with the netCDF package
and use it to create a NetCDFArray instance with which to
initialize a Data instance.</em></span><a class="headerlink" href="#id128" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">netCDF4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nc</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ta&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdf_array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">NetCDFArray</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;file.nc&#39;</span><span class="p">,</span> <span class="n">ncvar</span><span class="o">=</span><span class="s1">&#39;ta&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">dtype</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">shape</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_disk</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">netcdf_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id129">
<div class="code-block-caption"><span class="caption-text"><em>Read the netCDF variable’s data into memory and
initialise another Data instance with it. Compare the
values of the two data instances.</em></span><a class="headerlink" href="#id129" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_array</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_memory</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_disk</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">data_memory</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<p>Note that data type, number of dimensions, dimension sizes and number
of elements of the array on disk that are used to initialize the
<a class="reference internal" href="class/cfdm.NetCDFArray.html#cfdm.NetCDFArray" title="cfdm.NetCDFArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NetCDFArray</span></code></a> instance are those expected by the CF data model,
which may be different to those of the netCDF variable in the file
(although they are the same in the above example). For example, a
netCDF character array of shape <code class="docutils literal notranslate"><span class="pre">(12,</span> <span class="pre">9)</span></code> is viewed in cfdm as a
one-dimensional string array of shape <code class="docutils literal notranslate"><span class="pre">(12,)</span></code>.</p>
</div>
<div class="section" id="creation-by-conversion">
<span id="id39"></span><h3><strong>Creation by conversion</strong><a class="headerlink" href="#creation-by-conversion" title="Permalink to this headline">¶</a></h3>
<p>An independent field construct may be created from an existing
metadata construct using <a class="reference internal" href="method/cfdm.Field.convert.html#cfdm.Field.convert" title="cfdm.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method of the field
construct, which identifies a unique metadata construct and returns a
new field construct based on its properties and data. The new field
construct always has domain axis constructs corresponding to the data,
and (by default) any other metadata constructs that further define its
domain.</p>
<div class="literal-block-wrapper docutils container" id="id130">
<div class="code-block-caption"><span class="caption-text"><em>Create an independent field construct from the “surface
altitude” metadata construct.</em></span><a class="headerlink" href="#id130" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog</span><span class="p">)</span>
<span class="go">Field: surface_altitude</span>
<span class="go">-----------------------</span>
<span class="go">Data            : surface_altitude(grid_latitude(10), grid_longitude(9)) m</span>
<span class="go">Dimension coords: grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] degrees_north</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] degrees_east</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., j]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] km2</span>
<span class="go">Coord references: rotated_latitude_longitude</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cfdm.Field.convert.html#cfdm.Field.convert" title="cfdm.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method has an option to only include domain axis
constructs in the new field construct, with no other metadata
constructs.</p>
<div class="literal-block-wrapper docutils container" id="id131">
<div class="code-block-caption"><span class="caption-text"><em>Create an independent field construct from the “surface
altitude” metadata construct, but without a complete
domain.</em></span><a class="headerlink" href="#id131" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog1</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">full_domain</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog1</span><span class="p">)</span>
<span class="go">Field: surface_altitude</span>
<span class="go">-----------------------</span>
<span class="go">Data            : surface_altitude(key%domainaxis2(10), key%domainaxis3(9)) m</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creation-by-reading">
<span id="id40"></span><h3><strong>Creation by reading</strong><a class="headerlink" href="#creation-by-reading" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function <a class="reference internal" href="#reading-datasets"><span class="std std-ref">reads a netCDF dataset</span></a> and returns the contents as a list of zero or more
field constructs, each one corresponding to a unique CF-netCDF data
variable in the dataset. For example, the field construct <code class="docutils literal notranslate"><span class="pre">tas</span></code> that
was created manually can be <a class="reference internal" href="#writing-to-disk"><span class="std std-ref">written to a netCDF dataset</span></a> and then read back into memory:</p>
<div class="literal-block-wrapper docutils container" id="id132">
<div class="code-block-caption"><span class="caption-text"><em>Write the field construct that was created manually to
disk, and then read it back into a new field construct.</em></span><a class="headerlink" href="#id132" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tas</span><span class="p">,</span> <span class="s1">&#39;tas.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;tas.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">[&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function also allows field constructs to be derived
directly from the netCDF variables that correspond to particular types
metadata constructs. In this case, the new field constructs will have
a domain limited to that which can be inferred from the corresponding
netCDF variable, but without the connections that are defined by the
parent netCDF data variable. This will often result in a new field
construct that has fewer metadata constructs than one created with the
<a class="reference internal" href="method/cfdm.Field.convert.html#cfdm.Field.convert" title="cfdm.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id133">
<div class="code-block-caption"><span class="caption-text"><em>Read the file, treating formula terms netCDF variables
(which map to domain ancillary constructs) as additional
CF-netCDF data variables.</em></span><a class="headerlink" href="#id133" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fields</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;tas.nc&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="s1">&#39;domain_ancillary&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fields</span>
<span class="go">[&lt;Field: ncvar%a(atmosphere_hybrid_height_coordinate(1)) m&gt;,</span>
<span class="go"> &lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;Field: ncvar%b(atmosphere_hybrid_height_coordinate(1)) 1&gt;,</span>
<span class="go"> &lt;Field: surface_altitude(grid_latitude(10), grid_longitude(9)) m&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog_from_file</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog_from_file</span><span class="p">)</span>
<span class="go">Field: surface_altitude (ncvar%surface_altitude)</span>
<span class="go">------------------------------------------------</span>
<span class="go">Data            : surface_altitude(grid_latitude(10), grid_longitude(9)) m</span>
<span class="go">Dimension coords: grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
</pre></div>
</div>
</div>
<p>Comparing the field constructs <code class="docutils literal notranslate"><span class="pre">orog_from_file</span></code> (created with
<a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a>) and <code class="docutils literal notranslate"><span class="pre">orog</span></code> (created with the <a class="reference internal" href="method/cfdm.Field.convert.html#cfdm.Field.convert" title="cfdm.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method of
the <code class="docutils literal notranslate"><span class="pre">tas</span></code> field construct), the former lacks the auxiliary
coordinate, cell measure and coordinate reference constructs of the
latter. This is because the surface altitude netCDF variable in
<code class="docutils literal notranslate"><span class="pre">tas.nc</span></code> does not have the “coordinates”, “cell_measures” nor
“grid_mapping” netCDF attributes that would link it to auxiliary
coordinate, cell measure and grid mapping netCDF variables.</p>
</div>
</div>
<div class="section" id="copying-and-equality">
<span id="id41"></span><h2><strong>Copying and equality</strong><a class="headerlink" href="#copying-and-equality" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>A field construct may be copied with its <a class="reference internal" href="method/cfdm.Field.copy.html#cfdm.Field.copy" title="cfdm.Field.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a> method. This
produces a “deep copy”, i.e. the new field construct is completely
independent of the original field.</p>
<div class="literal-block-wrapper docutils container" id="id134">
<div class="code-block-caption"><span class="caption-text"><em>Copy a field construct and change elements of the copy,
showing that the original field construct has not been
altered.</em></span><a class="headerlink" href="#id134" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="n">e30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Data(1, 1, 1): [[[-1e+30]]] K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Data(1, 1, 1): [[[-1.0]]] K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">del_construct</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;DimensionCoordinate: grid_latitude(10) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;}</span>
</pre></div>
</div>
</div>
<p>Equivalently, the <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy.deepcopy</span></code></a> function may be used:</p>
<div class="literal-block-wrapper docutils container" id="id135">
<div class="code-block-caption"><span class="caption-text"><em>Copy a field construct with the built-in copy module.</em></span><a class="headerlink" href="#id135" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">copy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Metadata constructs may be copied individually in the same manner:</p>
<div class="literal-block-wrapper docutils container" id="id136">
<div class="code-block-caption"><span class="caption-text"><em>Copy a metadata construct.</em></span><a class="headerlink" href="#id136" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Arrays within <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instances are copied with a <a class="reference external" href="https://en.wikipedia.org/wiki/Copy-on-write">copy-on-write</a> technique. This means
that a copy takes up very little memory, even when the original
constructs contain very large data arrays, and the copy operation is
fast.</p>
<div class="section" id="equality">
<span id="id42"></span><h3><strong>Equality</strong><a class="headerlink" href="#equality" title="Permalink to this headline">¶</a></h3>
<p>Whether or not two field constructs are the same is tested with either
field construct’s <a class="reference internal" href="method/cfdm.Field.equals.html#cfdm.Field.equals" title="cfdm.Field.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id137">
<div class="code-block-caption"><span class="caption-text"><em>A field construct is always equal to itself, a copy of
itself and a complete subspace of itself. The “verbose”
keyword will give some (but not necessarily all) of the
reasons why two field constructs are not the same.</em></span><a class="headerlink" href="#id137" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Field: Different units: &#39;K&#39;, &#39;1&#39;</span>
<span class="go">Field: Different properties</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<p>Equality is strict by default. This means that for two field
constructs to be considered equal they must have corresponding
metadata constructs and for each pair of constructs:</p>
<ul class="simple">
<li>the descriptive properties must be the same (with the exception of
the field construct’s “Conventions” property, which is never
checked), and vector-valued properties must have same the size and
be element-wise equal, and</li>
<li>if there are data arrays then they must have same shape, data type
and be element-wise equal.</li>
</ul>
<p>Two real numbers <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are considered equal if
<span class="math notranslate nohighlight">\(|x - y| \le a_{tol} + r_{tol}|y|\)</span>, where <span class="math notranslate nohighlight">\(a_{tol}\)</span> (the
tolerance on absolute differences) and <span class="math notranslate nohighlight">\(r_{tol}\)</span> (the tolerance
on relative differences) are positive, typically very small
numbers. By default both are set to the system epsilon (the difference
between 1 and the least value greater than 1 that is representable as
a float). Their values may be inspected and changed with the
<a class="reference internal" href="function/cfdm.ATOL.html#cfdm.ATOL" title="cfdm.ATOL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.ATOL</span></code></a> and <a class="reference internal" href="function/cfdm.RTOL.html#cfdm.RTOL" title="cfdm.RTOL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.RTOL</span></code></a> functions:</p>
<div class="literal-block-wrapper docutils container" id="id138">
<div class="code-block-caption"><span class="caption-text"><em>The ATOL and RTOL functions allow the numerical equality
tolerances to be inspected and changed.</em></span><a class="headerlink" href="#id138" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">ATOL</span><span class="p">()</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">()</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">()</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">()</span>
<span class="go">2.220446049250313e-16</span>
</pre></div>
</div>
</div>
<p>Note that the above equation is not symmetric in <span class="math notranslate nohighlight">\(x\)</span> and
<span class="math notranslate nohighlight">\(y\)</span>, so that for two fields <code class="docutils literal notranslate"><span class="pre">f1</span></code> and <code class="docutils literal notranslate"><span class="pre">f2</span></code>, <code class="docutils literal notranslate"><span class="pre">f1.equals(f2)</span></code>
may be different from <code class="docutils literal notranslate"><span class="pre">f2.equals(f1)</span></code> in some rare cases.</p>
<p>NetCDF elements, such as netCDF variable and dimension names, do not
constitute part of the CF data model and so are not checked on any
construct.</p>
<p>The <a class="reference internal" href="method/cfdm.Field.equals.html#cfdm.Field.equals" title="cfdm.Field.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a> method has optional parameters for modifying the
criteria for considering two fields to be equal:</p>
<ul class="simple">
<li>named properties may be omitted from the comparison,</li>
<li>fill value and missing data value properties may be ignored,</li>
<li>the data type of data arrays may be ignored, and</li>
<li>the tolerances on absolute and relative differences for numerical
comparisons may be temporarily changed, without changing the default
settings.</li>
</ul>
<p>Metadata constructs may also be tested for equality:</p>
<div class="literal-block-wrapper docutils container" id="id139">
<div class="code-block-caption"><span class="caption-text"><em>Metadata constructs also have an equals method, that
behaves in a similar manner.</em></span><a class="headerlink" href="#id139" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">orog</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="netcdf-interface">
<span id="id43"></span><h2><strong>NetCDF interface</strong><a class="headerlink" href="#netcdf-interface" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The logical CF data model is independent of netCDF, but the CF
conventions are designed to enable the processing and sharing of
datasets stored in netCDF files. Therefore, the cfdm package includes
methods for recording and editing netCDF elements that are not part of
the CF model, but are nonetheless often required to interpret and
create CF-netCDF datasets. See the section on <a class="reference internal" href="philosophy.html#philosophy"><span class="std std-ref">philosophy</span></a> for a further discussion.</p>
<p>When a netCDF dataset is read, netCDF elements (such as dimension and
variable names, and some attribute values) that do not have a place in
the CF data model are, nevertheless, stored within the appropriate
cfdm constructs. This allows them to be used when writing field
constructs to a new netCDF dataset, and also makes them accessible as
filters to a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance:</p>
<div class="literal-block-wrapper docutils container" id="id140">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve metadata constructs based on their netCDF
names.</em></span><a class="headerlink" href="#id140" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_ncvar</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary1&#39;: &lt;DomainAncillary: ncvar%b(1) &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;ncvar</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">&lt;DimensionCoordinate: grid_longitude(9) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;ncdim</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&lt;Constructs: domain_axis(1)&gt;</span>
</pre></div>
</div>
</div>
<p>Each construct has methods to access the netCDF elements which it
requires. For example, the field construct has the following methods:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.nc_get_variable.html#cfdm.Field.nc_get_variable" title="cfdm.Field.nc_get_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_variable</span></code></a></td>
<td>Return the netCDF variable name</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.nc_set_variable.html#cfdm.Field.nc_set_variable" title="cfdm.Field.nc_set_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></a></td>
<td>Set the netCDF variable name</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.nc_del_variable.html#cfdm.Field.nc_del_variable" title="cfdm.Field.nc_del_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_variable</span></code></a></td>
<td>Remove the netCDF variable name</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.nc_has_variable.html#cfdm.Field.nc_has_variable" title="cfdm.Field.nc_has_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_variable</span></code></a></td>
<td>Whether the netCDF variable name has
been set</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.nc_global_attributes.html#cfdm.Field.nc_global_attributes" title="cfdm.Field.nc_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_global_attributes</span></code></a></td>
<td>Return the selection of properties to
be written as netCDF global attributes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.nc_set_global_attribute.html#cfdm.Field.nc_set_global_attribute" title="cfdm.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a></td>
<td>Set a property to be written as a
netCDF global attribute</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.nc_clear_global_attributes.html#cfdm.Field.nc_clear_global_attributes" title="cfdm.Field.nc_clear_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_global_attributes</span></code></a></td>
<td>Clear the selection of properties
to be written as netCDF global
attributes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.nc_unlimited_dimensions.html#cfdm.Field.nc_unlimited_dimensions" title="cfdm.Field.nc_unlimited_dimensions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_unlimited_dimensions</span></code></a></td>
<td>Return the selection of domain axis
constructs to be written as
netCDF unlimited dimensions</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.nc_set_unlimited_dimensions.html#cfdm.Field.nc_set_unlimited_dimensions" title="cfdm.Field.nc_set_unlimited_dimensions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_unlimited_dimensions</span></code></a></td>
<td>Set the selection of domain axis
constructs to be written as
netCDF unlimited dimensions</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.nc_clear_unlimited_dimensions.html#cfdm.Field.nc_clear_unlimited_dimensions" title="cfdm.Field.nc_clear_unlimited_dimensions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_unlimited_dimensions</span></code></a></td>
<td>Clear the selection of domain
axis constructs to be written
as netCDF unlimited dimensions</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id141">
<div class="code-block-caption"><span class="caption-text"><em>Access netCDF elements associated with the field and
metadata constructs.</em></span><a class="headerlink" href="#id141" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;q&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;project&#39;: None, &#39;Conventions&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_unlimited_dimensions</span><span class="p">()</span>
<span class="go">set()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;humidity&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;humidity&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;lat&#39;</span>
</pre></div>
</div>
</div>
<p>The complete collection of netCDF interface methods is:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="36%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Classes</th>
<th class="head">NetCDF element</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_variable</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>,  <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></td>
<td>Variable name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_variable</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></td>
<td>Variable name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_variable</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></td>
<td>Variable name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></td>
<td>Variable name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Dimension name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Dimension name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Dimension name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Dimension name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_global_attributes</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></td>
<td>Global attributes</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></td>
<td>Global attributes</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_global_attributes</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></td>
<td>Global attributes</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_unlimited_dimensions</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></td>
<td>Unlimited dimension names</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_unlimited_dimensions</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></td>
<td>Unlimited dimension names</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_unlimited_dimensions</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></td>
<td>Unlimited dimension names</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_external</span></code></td>
<td><a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></td>
<td>External variable status</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_external</span></code></td>
<td><a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></td>
<td>External variable status</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_sample_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Sample dimension name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_sample_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Sample dimension name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_sample_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Sample dimension name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Sample dimension name</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="writing-to-disk">
<span id="id44"></span><h2><strong>Writing to disk</strong><a class="headerlink" href="#writing-to-disk" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function writes a field construct, or a sequence of
field constructs, to a new netCDF file on disk:</p>
<div class="literal-block-wrapper docutils container" id="id142">
<div class="code-block-caption"><span class="caption-text"><em>Write a field construct to a netCDF dataset on disk.</em></span><a class="headerlink" href="#id142" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;q_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new dataset is structured as follows:</p>
<div class="literal-block-wrapper docutils container" id="id143">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id143" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ncdump -h q_file.nc
netcdf q_file <span class="o">{</span>
dimensions:
     <span class="nv">lat</span> <span class="o">=</span> <span class="m">5</span> <span class="p">;</span>
     <span class="nv">bounds2</span> <span class="o">=</span> <span class="m">2</span> <span class="p">;</span>
     <span class="nv">lon</span> <span class="o">=</span> <span class="m">8</span> <span class="p">;</span>
variables:
     double lat_bnds<span class="o">(</span>lat, bounds2<span class="o">)</span> <span class="p">;</span>
     double lat<span class="o">(</span>lat<span class="o">)</span> <span class="p">;</span>
             lat:units <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span> <span class="p">;</span>
             lat:standard_name <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span> <span class="p">;</span>
             lat:bounds <span class="o">=</span> <span class="s2">&quot;lat_bnds&quot;</span> <span class="p">;</span>
     double lon_bnds<span class="o">(</span>lon, bounds2<span class="o">)</span> <span class="p">;</span>
     double lon<span class="o">(</span>lon<span class="o">)</span> <span class="p">;</span>
             lon:units <span class="o">=</span> <span class="s2">&quot;degrees_east&quot;</span> <span class="p">;</span>
             lon:standard_name <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span> <span class="p">;</span>
             lon:bounds <span class="o">=</span> <span class="s2">&quot;lon_bnds&quot;</span> <span class="p">;</span>
     double <span class="nb">time</span> <span class="p">;</span>
             time:units <span class="o">=</span> <span class="s2">&quot;days since 2018-12-01&quot;</span> <span class="p">;</span>
             time:standard_name <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
     double humidity<span class="o">(</span>lat, lon<span class="o">)</span> <span class="p">;</span>
             humidity:standard_name <span class="o">=</span> <span class="s2">&quot;specific_humidity&quot;</span> <span class="p">;</span>
             humidity:cell_methods <span class="o">=</span> <span class="s2">&quot;area: mean&quot;</span> <span class="p">;</span>
             humidity:units <span class="o">=</span> <span class="s2">&quot;1&quot;</span> <span class="p">;</span>
             humidity:coordinates <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>

// global attributes:
             :Conventions <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
             :project <span class="o">=</span> <span class="s2">&quot;research&quot;</span> <span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>A sequence of field constructs is written in exactly the same way:</p>
<div class="literal-block-wrapper docutils container" id="id144">
<div class="code-block-caption"><span class="caption-text"><em>Write multiple field constructs to a netCDF dataset on
disk.</em></span><a class="headerlink" href="#id144" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;new_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>By default the output file will be for CF-1.7.</p>
<p>The <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li>set the output netCDF format (all netCDF3 and netCDF4 formats are
possible);</li>
<li>specify which field construct properties should become netCDF data
variable attributes and which should become netCDF global
attributes;</li>
<li>set extra netCDF global attributes;</li>
<li>create <a class="reference internal" href="#external-variables"><span class="std std-ref">external variables</span></a> in an external
file;</li>
<li>specify the version of the CF conventions (from CF-1.6 up to
CF-1.7), and of any other conventions that the file adheres
to;</li>
<li>change the data type of output data arrays;</li>
<li>apply netCDF compression and packing; and</li>
<li>set the endian-ness of the output data.</li>
</ul>
<p>Output netCDF variable and dimension names read from a netCDF dataset
are stored in the resulting field constructs, and may also be set
manually with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension</span></code> methods. If a name has not been set then one
will be generated internally (usually based on the standard name if it
exists).</p>
<p>It is possible to create netCDF unlimited dimensions using the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_unlimited_dimensions</span></code> method of the field construct.</p>
<p>A field construct is not transformed through being written to a file
on disk and subsequently read back from that file.</p>
<div class="literal-block-wrapper docutils container" id="id145">
<div class="code-block-caption"><span class="caption-text"><em>Read a file that has been created by writing a field
construct, and compare the result with the original field
construct in memory.</em></span><a class="headerlink" href="#id145" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;q_file.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="global-attributes">
<span id="id45"></span><h3><strong>Global attributes</strong><a class="headerlink" href="#global-attributes" title="Permalink to this headline">¶</a></h3>
<p>The field construct properties that correspond to the standardised
description-of-file-contents attributes are automatically written as
netCDF global attributes. Other attributes may also be written as
netCDF global attributes if they have been identified as such with the
<em>global_attributes</em> keyword, or via the
<a class="reference internal" href="method/cfdm.Field.nc_set_global_attribute.html#cfdm.Field.nc_set_global_attribute" title="cfdm.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a> method of the field constructs. In
either case, the creation of a netCDF global attribute depends on the
corresponding property values being identical across all of the field
constructs being written to the file. If they are all equal then the
property will be written as a netCDF global attribute and not as an
attribute of any netCDF data variable; if any differ then the property
is written only to each netCDF data variable.</p>
<div class="literal-block-wrapper docutils container" id="id146">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “model” property is written as a netCDF
global attribute, using the “global_attributes” keyword.</em></span><a class="headerlink" href="#id146" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;model_A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">,</span> <span class="n">global_attributes</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id147">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “model” property is written as a netCDF
global attribute, using the “nc_set_global_attribute”
method.</em></span><a class="headerlink" href="#id147" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None, &#39;project&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_set_global_attribute</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None, &#39;model&#39;: None, &#39;project&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>It is possible to create both a netCDF global attribute and a netCDF
data variable attribute with the same name, but with different
values. This may be done by assigning the global value to the property
name with the <a class="reference internal" href="method/cfdm.Field.nc_set_global_attribute.html#cfdm.Field.nc_set_global_attribute" title="cfdm.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a> method, or by via the
<em>file_descriptors</em> keyword. For the former technique, any
inconsistencies arising from multiple field constructs being written
to the same file will be resolved by omitting the netCDF global
attribute from the file.</p>
<div class="literal-block-wrapper docutils container" id="id148">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “information” property is written as
netCDF global and data variable attributes, with
different values, using the “nc_set_global_attribute”
method.</em></span><a class="headerlink" href="#id148" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;information&#39;</span><span class="p">,</span> <span class="s1">&#39;variable information&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;information&#39;: &#39;variable information&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;specific_humidity&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_set_global_attribute</span><span class="p">(</span><span class="s1">&#39;information&#39;</span><span class="p">,</span> <span class="s1">&#39;global information&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None,</span>
<span class="go">&#39;information&#39;: &#39;global information&#39;,</span>
<span class="go"> &#39;model&#39;: None,</span>
<span class="go"> &#39;project&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Netcdf global attributes defined with the <em>file_descriptors</em> keyword
of the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function will always be written as requested,
independently of the netCDF data variable attributes, and superceding
any global attributes that may have been defined with the
<em>global_attributes</em> keyword, or set on the individual field
constructs.</p>
<div class="literal-block-wrapper docutils container" id="id149">
<div class="code-block-caption"><span class="caption-text"><em>Insist that the “history” property is written as netCDF
a global attribute, with the “file_descriptors” keyword.</em></span><a class="headerlink" href="#id149" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">file_descriptors</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;history&#39;</span><span class="p">:</span> <span class="s1">&#39;created in 2019&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;f_file&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;history&#39;: &#39;created in 2019&#39;,</span>
<span class="go"> &#39;information&#39;: &#39;variable information&#39;,</span>
<span class="go"> &#39;model&#39;: &#39;model_A&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;specific_humidity&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None,</span>
<span class="go"> &#39;history&#39;: None,</span>
<span class="go"> &#39;information&#39;: &#39;global information&#39;,</span>
<span class="go"> &#39;project&#39;: None}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conventions">
<span id="id46"></span><h3><strong>Conventions</strong><a class="headerlink" href="#conventions" title="Permalink to this headline">¶</a></h3>
<p>The “Conventions” netCDF global attribute containing the version of
the CF conventions is always automatically created. If the version of
the CF conventions has been set as a field property, or with the
<em>Conventions</em> keyword of the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function, then it is
ignored. However, other conventions that may apply can be set with
either technique.</p>
<div class="literal-block-wrapper docutils container" id="id150">
<div class="code-block-caption"><span class="caption-text"><em>Two ways to add additional conventions to the
“Conventions” netCDF global attribute.</em></span><a class="headerlink" href="#id150" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;Conventions&#39;</span><span class="p">,</span> <span class="s1">&#39;UGRID1.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">,</span> <span class="n">Conventions</span><span class="o">=</span><span class="s1">&#39;UGRID1.0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="scalar-coordinate-variables">
<span id="id47"></span><h3><strong>Scalar coordinate variables</strong><a class="headerlink" href="#scalar-coordinate-variables" title="Permalink to this headline">¶</a></h3>
<p>A CF-netCDF scalar (i.e. zero-dimensional) coordinate variable is
created from a size one dimension coordinate construct that spans a
domain axis construct which is not spanned by the field construct’s
data, nor the data of any other metadata construct. This occurs for
the field construct <code class="docutils literal notranslate"><span class="pre">q</span></code>, for which the “time” dimension coordinate
construct was to the file <code class="docutils literal notranslate"><span class="pre">q_file.nc</span></code> as a scalar coordinate
variable.</p>
<p>To change this so that the “time” dimension coordinate construct is
written as a CF-netCDF size one coordinate variable, the field
construct’s data must be expanded to span the corresponding size one
domain axis construct, by using the <a class="reference internal" href="method/cfdm.Field.insert_dimension.html#cfdm.Field.insert_dimension" title="cfdm.Field.insert_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insert_dimension</span></code></a> method
of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id151">
<div class="code-block-caption"><span class="caption-text"><em>Write the “time” dimension coordinate construct to a
(non-scalar) CF-netCDF coordinate variable by inserting
the corresponding dimension into the field construct’s
data.</em></span><a class="headerlink" href="#id151" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span>
<span class="go">(&#39;domainaxis2&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">insert_dimension</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span>
<span class="go">&lt;Field: specific_humidity(time(1), latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="s1">&#39;q2_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new dataset is structured as follows (note, relative to file
<code class="docutils literal notranslate"><span class="pre">q_file.nc</span></code>, the existence of the “time” dimension and the lack of a
“coordinates” attribute on the, now three-dimensional, data variable):</p>
<div class="literal-block-wrapper docutils container" id="id152">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id152" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ncdump -h q2_file.nc
netcdf q2_file <span class="o">{</span>
dimensions:
     <span class="nv">lat</span> <span class="o">=</span> <span class="m">5</span> <span class="p">;</span>
     <span class="nv">bounds2</span> <span class="o">=</span> <span class="m">2</span> <span class="p">;</span>
     <span class="nv">lon</span> <span class="o">=</span> <span class="m">8</span> <span class="p">;</span>
     <span class="nb">time</span> <span class="o">=</span> <span class="m">1</span> <span class="p">;</span>
variables:
     double lat_bnds<span class="o">(</span>lat, bounds2<span class="o">)</span> <span class="p">;</span>
     double lat<span class="o">(</span>lat<span class="o">)</span> <span class="p">;</span>
             lat:units <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span> <span class="p">;</span>
             lat:standard_name <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span> <span class="p">;</span>
             lat:bounds <span class="o">=</span> <span class="s2">&quot;lat_bnds&quot;</span> <span class="p">;</span>
     double lon_bnds<span class="o">(</span>lon, bounds2<span class="o">)</span> <span class="p">;</span>
     double lon<span class="o">(</span>lon<span class="o">)</span> <span class="p">;</span>
             lon:units <span class="o">=</span> <span class="s2">&quot;degrees_east&quot;</span> <span class="p">;</span>
             lon:standard_name <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span> <span class="p">;</span>
             lon:bounds <span class="o">=</span> <span class="s2">&quot;lon_bnds&quot;</span> <span class="p">;</span>
     double time<span class="o">(</span><span class="nb">time</span><span class="o">)</span> <span class="p">;</span>
             time:units <span class="o">=</span> <span class="s2">&quot;days since 2018-12-01&quot;</span> <span class="p">;</span>
             time:standard_name <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
     double humidity<span class="o">(</span>time, lat, lon<span class="o">)</span> <span class="p">;</span>
             humidity:units <span class="o">=</span> <span class="s2">&quot;1&quot;</span> <span class="p">;</span>
             humidity:standard_name <span class="o">=</span> <span class="s2">&quot;specific_humidity&quot;</span> <span class="p">;</span>
             humidity:cell_methods <span class="o">=</span> <span class="s2">&quot;area: mean&quot;</span> <span class="p">;</span>

// global attributes:
             :Conventions <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
             :project <span class="o">=</span> <span class="s2">&quot;research&quot;</span> <span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="external-variables">
<span id="id48"></span><h2><strong>External variables</strong><a class="headerlink" href="#external-variables" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p><a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#external-variables">External variables</a> are those in a netCDF file that are referred to,
but which are not present in it. Instead, such variables are stored in
other netCDF files known as “external files”. External variables may,
however, be incorporated into the field constructs of the dataset, as
if they had actually been stored in the same file, simply by providing
the external file names to the <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function.</p>
<p>This is illustrated with the files <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code> (<a class="reference download internal" download="" href="_downloads/609a18ba1ee2929f9c738c4cd0a7b960/parent.nc"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 2kB) <a class="footnote-reference" href="#files" id="id49">[2]</a>:</p>
<div class="literal-block-wrapper docutils container" id="id153">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the parent dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id153" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ncdump -h parent.nc
netcdf parent <span class="o">{</span>
dimensions:
     <span class="nv">latitude</span> <span class="o">=</span> <span class="m">10</span> <span class="p">;</span>
     <span class="nv">longitude</span> <span class="o">=</span> <span class="m">9</span> <span class="p">;</span>
variables:
     double latitude<span class="o">(</span>latitude<span class="o">)</span> <span class="p">;</span>
             latitude:units <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span> <span class="p">;</span>
             latitude:standard_name <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span> <span class="p">;</span>
     double longitude<span class="o">(</span>longitude<span class="o">)</span> <span class="p">;</span>
             longitude:units <span class="o">=</span> <span class="s2">&quot;degrees_east&quot;</span> <span class="p">;</span>
             longitude:standard_name <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span> <span class="p">;</span>
     double eastward_wind<span class="o">(</span>latitude, longitude<span class="o">)</span> <span class="p">;</span>
             eastward_wind:units <span class="o">=</span> <span class="s2">&quot;m s-1&quot;</span> <span class="p">;</span>
             eastward_wind:standard_name <span class="o">=</span> <span class="s2">&quot;eastward_wind&quot;</span> <span class="p">;</span>
             eastward_wind:cell_measures <span class="o">=</span> <span class="s2">&quot;area: areacella&quot;</span> <span class="p">;</span>

// global attributes:
             :Conventions <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
             :external_variables <span class="o">=</span> <span class="s2">&quot;areacella&quot;</span> <span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>and <code class="docutils literal notranslate"><span class="pre">external.nc</span></code> (<a class="reference download internal" download="" href="_downloads/d6b6919b7acbac5509f39600030ec26a/external.nc"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>,
1kB) <a class="footnote-reference" href="#files" id="id50">[2]</a>:</p>
<div class="literal-block-wrapper docutils container" id="id154">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the external dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id154" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ncdump -h external.nc
netcdf external <span class="o">{</span>
dimensions:
     <span class="nv">latitude</span> <span class="o">=</span> <span class="m">10</span> <span class="p">;</span>
     <span class="nv">longitude</span> <span class="o">=</span> <span class="m">9</span> <span class="p">;</span>
variables:
     double areacella<span class="o">(</span>longitude, latitude<span class="o">)</span> <span class="p">;</span>
             areacella:units <span class="o">=</span> <span class="s2">&quot;m2&quot;</span> <span class="p">;</span>
             areacella:standard_name <span class="o">=</span> <span class="s2">&quot;cell_area&quot;</span> <span class="p">;</span>

// global attributes:
             :Conventions <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>The dataset in <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code> may be read <em>without</em> specifying the
external file <code class="docutils literal notranslate"><span class="pre">external.nc</span></code>. In this case a cell measure construct
is still created, but one without any metadata or data:</p>
<div class="literal-block-wrapper docutils container" id="id155">
<div class="code-block-caption"><span class="caption-text"><em>Read the parent dataset without specifying the location
of any external datasets.</em></span><a class="headerlink" href="#id155" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;parent.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Cell measures   : measure:area (external variable: ncvar%areacella)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CellMeasure: measure:area &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_external</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;areacella&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<p>If this field construct were to be written to disk using <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a>,
then the output file would be identical to the original <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code>
file, i.e. the netCDF variable name of the cell measure construct
(“areacella”) would be listed by the “external_variables” global
attribute.</p>
<p>However, the dataset may also be read <em>with</em> the external file. In
this case a cell measure construct is created with all of the metadata
and data from the external file, as if the netCDF cell measure
variable had been present in the parent dataset:</p>
<div class="literal-block-wrapper docutils container" id="id156">
<div class="code-block-caption"><span class="caption-text"><em>Read the parent dataset whilst providing the external
dataset containing the external variables.</em></span><a class="headerlink" href="#id156" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;parent.nc&#39;</span><span class="p">,</span> <span class="n">external</span><span class="o">=</span><span class="s1">&#39;external.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Cell measures   : cell_area(longitude(9), latitude(10)) = [[100000.5, ..., 100089.5]] m2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CellMeasure: cell_area(9, 10) m2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_external</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;areacella&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;cell_area&#39;, &#39;units&#39;: &#39;m2&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(9, 10): [[100000.5, ..., 100089.5]] m2&gt;</span>
</pre></div>
</div>
</div>
<p>If this field construct were to be written to disk using <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a>
then by default the cell measure construct, with all of its metadata
and data, would be written to the named output file, along with all of
the other constructs. There would be no “external_variables” global
attribute.</p>
<p>To create a reference to an external variable in an output netCDF
file, set the status of the cell measure construct to “external” with
its <a class="reference internal" href="method/cfdm.CellMeasure.nc_set_external.html#cfdm.CellMeasure.nc_set_external" title="cfdm.CellMeasure.nc_set_external"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_external</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id157">
<div class="code-block-caption"><span class="caption-text"><em>Flag the cell measure as external and write the field
construct to a new file.</em></span><a class="headerlink" href="#id157" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_set_external</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;new_parent.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To create a reference to an external variable in the an output netCDF
file and simultaneously create an external file containing the
variable, set the status of the cell measure construct to “external”
and provide an external file name to the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function:</p>
<div class="literal-block-wrapper docutils container" id="id158">
<div class="code-block-caption"><span class="caption-text"><em>Write the field construct to a new file and the cell
measure construct to an external file.</em></span><a class="headerlink" href="#id158" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;new_parent.nc&#39;</span><span class="p">,</span> <span class="n">external</span><span class="o">=</span><span class="s1">&#39;new_external.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="external-files-with-cfdump">
<span id="external-variables-with-cfdump"></span><h3><strong>External files with cfdump</strong><a class="headerlink" href="#external-files-with-cfdump" title="Permalink to this headline">¶</a></h3>
<p>One or more external files may also be included with <a class="reference internal" href="#cfdump"><span class="std std-ref">cfdump</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id159">
<div class="code-block-caption"><span class="caption-text"><em>Use cfdump to describe the parent file without resolving
the external variable reference.</em></span><a class="headerlink" href="#id159" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ cfdump parent.nc
Field: eastward_wind <span class="o">(</span>ncvar%eastward_wind<span class="o">)</span>
------------------------------------------
Data            : eastward_wind<span class="o">(</span>latitude<span class="o">(</span>10<span class="o">)</span>, longitude<span class="o">(</span>9<span class="o">))</span> m s-1
Dimension coords: latitude<span class="o">(</span>10<span class="o">)</span> <span class="o">=</span> <span class="o">[</span>0.0, ..., 9.0<span class="o">]</span> degrees_north
                : longitude<span class="o">(</span>9<span class="o">)</span> <span class="o">=</span> <span class="o">[</span>0.0, ..., 8.0<span class="o">]</span> degrees_east
Cell measures   : measure:area <span class="o">(</span>external variable: ncvar%areacella<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id160">
<div class="code-block-caption"><span class="caption-text"><em>Providing an external file with the “-e” option allows
the reference to be resolved.</em></span><a class="headerlink" href="#id160" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ cfdump -e external.nc parent.nc
Field: eastward_wind <span class="o">(</span>ncvar%eastward_wind<span class="o">)</span>
------------------------------------------
Data            : eastward_wind<span class="o">(</span>latitude<span class="o">(</span>10<span class="o">)</span>, longitude<span class="o">(</span>9<span class="o">))</span> m s-1
Dimension coords: latitude<span class="o">(</span>10<span class="o">)</span> <span class="o">=</span> <span class="o">[</span>0.0, ..., 9.0<span class="o">]</span> degrees_north
                : longitude<span class="o">(</span>9<span class="o">)</span> <span class="o">=</span> <span class="o">[</span>0.0, ..., 8.0<span class="o">]</span> degrees_east
Cell measures   : measure:area<span class="o">(</span>longitude<span class="o">(</span>9<span class="o">)</span>, latitude<span class="o">(</span>10<span class="o">))</span> <span class="o">=</span> <span class="o">[[</span>100000.5, ..., 100089.5<span class="o">]]</span> m2
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="compression">
<span id="id51"></span><h2><strong>Compression</strong><a class="headerlink" href="#compression" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The CF conventions have support for saving space by identifying
unwanted missing data.  Such compression techniques store the data
more efficiently and result in no precision loss. The CF data model,
however, views compressed arrays in their uncompressed form.</p>
<p>Therefore, the field construct contains domain axis constructs for the
compressed dimensions and presents a view of compressed data in its
uncompressed form, even though the “underlying array” (i.e. the actual
array on disk or in memory that is contained in a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance) is
compressed. This means that the cfdm package includes algorithms for
uncompressing each type of compressed array.</p>
<p>There are two basic types of compression supported by the CF
conventions: ragged arrays (as used by <a class="reference internal" href="#discrete-sampling-geometries"><span class="std std-ref">discrete sampling
geometries</span></a>) and <a class="reference internal" href="#gathering"><span class="std std-ref">compression by
gathering</span></a>, each of which has particular implementation
details, but the following access patterns and behaviours apply to
both:</p>
<ul class="simple">
<li>Whether or not the data are compressed is tested with the
<a class="reference internal" href="method/cfdm.Data.get_compression_type.html#cfdm.Data.get_compression_type" title="cfdm.Data.get_compression_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_compression_type</span></code></a> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</li>
</ul>
<ul class="simple">
<li>Accessing the data via the <a class="reference internal" href="attribute/cfdm.Data.array.html#cfdm.Data.array" title="cfdm.Data.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> attribute of a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a>
instance returns a numpy array that is uncompressed. The underlying
array will, however, remain in its compressed form. The compressed
underlying array may be retrieved as a numpy array with the
<a class="reference internal" href="attribute/cfdm.Data.compressed_array.html#cfdm.Data.compressed_array" title="cfdm.Data.compressed_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compressed_array</span></code></a> attribute of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</li>
</ul>
<ul class="simple">
<li>A <a class="reference internal" href="#subspacing"><span class="std std-ref">subspace</span></a> of a field construct is created with
indices of the uncompressed form of the data. The new subspace will
no longer be compressed, i.e. its underlying arrays will be
uncompressed, but the original data will remain compressed. It
follows that to uncompress all of the data in a field construct,
index the field construct with (indices equivalent to) <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Ellipsis</span></code></a>.</li>
</ul>
<ul class="simple">
<li>If data elements are modified by <a class="reference internal" href="#assignment"><span class="std std-ref">assigning</span></a> to
indices of the uncompressed form of the data, then the compressed
underlying array is replaced by its uncompressed form.</li>
</ul>
<ul class="simple">
<li>If an underlying array is compressed at the time of writing to disk
with the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function, then it is written to the file as a
compressed array, along with the supplementary netCDF variables and
attributes that are required for the encoding. This means that if a
dataset using compression is read from disk then it will be written
back to disk with the same compression, unless data elements have
been modified by assignment. Any compressed arrays that have been
modified will be written to an output dataset as uncompressed
arrays.</li>
</ul>
<p>Examples of all of the above may be found in the sections on
<a class="reference internal" href="#discrete-sampling-geometries"><span class="std std-ref">discrete sampling geometries</span></a> and
<a class="reference internal" href="#gathering"><span class="std std-ref">gathering</span></a>.</p>
<div class="section" id="discrete-sampling-geometries">
<span id="id52"></span><h3><strong>Discrete sampling geometries</strong><a class="headerlink" href="#discrete-sampling-geometries" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#discrete-sampling-geometries">Discrete sampling geometry (DSG)</a> features may be compressed by
combining them using one of three ragged array representations:
<a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#_contiguous_ragged_array_representation">contiguous</a>, <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#_indexed_ragged_array_representation">indexed</a> or <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#_ragged_array_representation_of_time_series_profiles">indexed contiguous</a>.</p>
<p>The count variable that is required to uncompress a contiguous, or
indexed contiguous, ragged array is stored in a <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a> instance and
is accessed with the <a class="reference internal" href="method/cfdm.Data.get_count.html#cfdm.Data.get_count" title="cfdm.Data.get_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_count</span></code></a> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<p>The index variable that is required to uncompress an indexed, or
indexed contiguous, ragged array is stored in an <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a> instance and
is accessed with the <a class="reference internal" href="method/cfdm.Data.get_index.html#cfdm.Data.get_index" title="cfdm.Data.get_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_index</span></code></a> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<p>The contiguous case is is illustrated with the file <code class="docutils literal notranslate"><span class="pre">contiguous.nc</span></code>
(<a class="reference download internal" download="" href="_downloads/41a48ffbe06eb316ee6f08e9b82c6304/contiguous.nc"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 2kB) <a class="footnote-reference" href="#files" id="id53">[2]</a>:</p>
<div class="literal-block-wrapper docutils container" id="id161">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the compressed dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id161" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ncdump -h contiguous.nc
dimensions:
     <span class="nv">station</span> <span class="o">=</span> <span class="m">4</span> <span class="p">;</span>
     <span class="nv">obs</span> <span class="o">=</span> <span class="m">24</span> <span class="p">;</span>
     <span class="nv">strlen8</span> <span class="o">=</span> <span class="m">8</span> <span class="p">;</span>
variables:
     int row_size<span class="o">(</span>station<span class="o">)</span> <span class="p">;</span>
             row_size:long_name <span class="o">=</span> <span class="s2">&quot;number of observations for this station&quot;</span> <span class="p">;</span>
             row_size:sample_dimension <span class="o">=</span> <span class="s2">&quot;obs&quot;</span> <span class="p">;</span>
     double time<span class="o">(</span>obs<span class="o">)</span> <span class="p">;</span>
             time:units <span class="o">=</span> <span class="s2">&quot;days since 1970-01-01 00:00:00&quot;</span> <span class="p">;</span>
             time:standard_name <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
     double lat<span class="o">(</span>station<span class="o">)</span> <span class="p">;</span>
             lat:units <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span> <span class="p">;</span>
             lat:standard_name <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span> <span class="p">;</span>
     double lon<span class="o">(</span>station<span class="o">)</span> <span class="p">;</span>
             lon:units <span class="o">=</span> <span class="s2">&quot;degrees_east&quot;</span> <span class="p">;</span>
             lon:standard_name <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span> <span class="p">;</span>
     double alt<span class="o">(</span>station<span class="o">)</span> <span class="p">;</span>
             alt:units <span class="o">=</span> <span class="s2">&quot;m&quot;</span> <span class="p">;</span>
             alt:positive <span class="o">=</span> <span class="s2">&quot;up&quot;</span> <span class="p">;</span>
             alt:standard_name <span class="o">=</span> <span class="s2">&quot;height&quot;</span> <span class="p">;</span>
             alt:axis <span class="o">=</span> <span class="s2">&quot;Z&quot;</span> <span class="p">;</span>
     char station_name<span class="o">(</span>station, strlen8<span class="o">)</span> <span class="p">;</span>
             station_name:long_name <span class="o">=</span> <span class="s2">&quot;station name&quot;</span> <span class="p">;</span>
             station_name:cf_role <span class="o">=</span> <span class="s2">&quot;timeseries_id&quot;</span> <span class="p">;</span>
     double humidity<span class="o">(</span>obs<span class="o">)</span> <span class="p">;</span>
             humidity:standard_name <span class="o">=</span> <span class="s2">&quot;specific_humidity&quot;</span> <span class="p">;</span>
             humidity:coordinates <span class="o">=</span> <span class="s2">&quot;time lat lon alt station_name&quot;</span> <span class="p">;</span>
             humidity:_FillValue <span class="o">=</span> -999.9 <span class="p">;</span>

// global attributes:
             :Conventions <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
             :featureType <span class="o">=</span> <span class="s2">&quot;timeSeries&quot;</span> <span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>Reading and inspecting this file shows the data presented in
two-dimensional uncompressed form, whilst the underlying array is
still in the one-dimension ragged representation described in the
file:</p>
<div class="literal-block-wrapper docutils container" id="id162">
<div class="code-block-caption"><span class="caption-text"><em>Read a field construct from a dataset that has been
compressed with contiguous ragged arrays, and inspect its
data in uncompressed form.</em></span><a class="headerlink" href="#id162" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;contiguous.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(ncdim%station(4), ncdim%timeseries(9))</span>
<span class="go">Dimension coords:</span>
<span class="go">Auxiliary coords: time(ncdim%station(4), ncdim%timeseries(9)) = [[1969-12-29 00:00:00, ..., 1970-01-07 00:00:00]]</span>
<span class="go">                : latitude(ncdim%station(4)) = [-9.0, ..., 78.0] degrees_north</span>
<span class="go">                : longitude(ncdim%station(4)) = [-23.0, ..., 178.0] degrees_east</span>
<span class="go">                : height(ncdim%station(4)) = [0.5, ..., 345.0] m</span>
<span class="go">                : cf_role:timeseries_id(ncdim%station(4)) = [station1, ..., station4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.12 0.05 0.18   --   --   --   --   --   --]</span>
<span class="go"> [0.05 0.11 0.2  0.15 0.08 0.04 0.06   --   --]</span>
<span class="go"> [0.15 0.19 0.15 0.17 0.07   --   --   --   --]</span>
<span class="go"> [0.11 0.03 0.14 0.16 0.02 0.09 0.1  0.04 0.11]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id163">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the underlying compressed array and the count
variable that defines how to uncompress the data.</em></span><a class="headerlink" href="#id163" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[0.12 0.05 0.18 0.05 0.11 0.2 0.15 0.08 0.04 0.06 0.15 0.19 0.15 0.17 0.07</span>
<span class="go"> 0.11 0.03 0.14 0.16 0.02 0.09 0.1 0.04 0.11]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span>
<span class="go">&lt;Count: long_name=number of observations for this station(4) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_variable</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[3 7 5 9]</span>
</pre></div>
</div>
</div>
<p>The timeseries for the second station is easily selected by indexing
the “station” axis of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id164">
<div class="code-block-caption"><span class="caption-text"><em>Get the data for the second station.</em></span><a class="headerlink" href="#id164" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">station2</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">station2</span>
<span class="go">&lt;Field: specific_humidity(ncdim%station(1), ncdim%timeseries(9))&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">station2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.05 0.11 0.2 0.15 0.08 0.04 0.06 -- --]]</span>
</pre></div>
</div>
</div>
<p>The underlying array of original data remains in compressed form until
data array elements are modified:</p>
<div class="literal-block-wrapper docutils container" id="id165">
<div class="code-block-caption"><span class="caption-text"><em>Change an element of the data and show that the
underlying array is no longer compressed.</em></span><a class="headerlink" href="#id165" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.12 0.05 0.18   --   --   --   --   --   --]</span>
<span class="go"> [0.05 0.11 -9.0 0.15 0.08 0.04 0.06   --   --]</span>
<span class="go"> [0.15 0.19 0.15 0.17 0.07   --   --   --   --]</span>
<span class="go"> [0.11 0.03 0.14 0.16 0.02 0.09 0.1  0.04 0.11]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</div>
<p>A construct with an underlying ragged array is created by initialising
a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance with a ragged array that is stored in one of three
special array objects: <a class="reference internal" href="class/cfdm.RaggedContiguousArray.html#cfdm.RaggedContiguousArray" title="cfdm.RaggedContiguousArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedContiguousArray</span></code></a>, <a class="reference internal" href="class/cfdm.RaggedIndexedArray.html#cfdm.RaggedIndexedArray" title="cfdm.RaggedIndexedArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedIndexedArray</span></code></a>
or <a class="reference internal" href="class/cfdm.RaggedIndexedContiguousArray.html#cfdm.RaggedIndexedContiguousArray" title="cfdm.RaggedIndexedContiguousArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedIndexedContiguousArray</span></code></a>. The following code creates a simple
field construct with an underlying contiguous ragged array:</p>
<div class="literal-block-wrapper docutils container" id="id166">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with compressed data.</em></span><a class="headerlink" href="#id166" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Define the ragged array values</span>
<span class="n">ragged_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">279</span><span class="p">,</span> <span class="mi">278</span><span class="p">,</span> <span class="mf">279.5</span><span class="p">],</span>
                           <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="c1"># Define the count array values</span>
<span class="n">count_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="c1"># Create the count variable</span>
<span class="n">count_variable</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">count_array</span><span class="p">))</span>
<span class="n">count_variable</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;number of obs for this timeseries&#39;</span><span class="p">)</span>

<span class="c1"># Create the contiguous ragged array object, specifying the</span>
<span class="c1"># uncompressed shape</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">RaggedContiguousArray</span><span class="p">(</span>
                 <span class="n">compressed_array</span><span class="o">=</span><span class="n">ragged_array</span><span class="p">,</span>
                 <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">count_variable</span><span class="o">=</span><span class="n">count_variable</span><span class="p">)</span>

<span class="c1"># Create the field construct with the domain axes and the ragged</span>
<span class="c1"># array</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;featureType&#39;</span><span class="p">:</span> <span class="s1">&#39;timeSeries&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs for the uncompressed array</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The new field construct can now be inspected and written to a netCDF file:</p>
<div class="literal-block-wrapper docutils container" id="id167">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct and write it to disk.</em></span><a class="headerlink" href="#id167" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span>
<span class="go">&lt;Field: air_temperature(key%domainaxis1(2), key%domainaxis0(4)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[280.0    --    --    --]</span>
<span class="go"> [281.0 279.0 278.0 279.5]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[280.  281.  279.  278.  279.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span>
<span class="go">&lt;Count: long_name=number of obs for this timeseries(2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_variable</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;T_contiguous.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The content of the new file is:</p>
<div class="literal-block-wrapper docutils container" id="id168">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new compressed dataset with the ncdump
command line tool.</em></span><a class="headerlink" href="#id168" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ncdump T_contiguous.nc
netcdf T_contiguous <span class="o">{</span>
dimensions:
     <span class="nv">dim</span> <span class="o">=</span> <span class="m">2</span> <span class="p">;</span>
     <span class="nv">element</span> <span class="o">=</span> <span class="m">5</span> <span class="p">;</span>
variables:
     int64 count<span class="o">(</span>dim<span class="o">)</span> <span class="p">;</span>
             count:long_name <span class="o">=</span> <span class="s2">&quot;number of obs for this timeseries&quot;</span> <span class="p">;</span>
             count:sample_dimension <span class="o">=</span> <span class="s2">&quot;element&quot;</span> <span class="p">;</span>
     float air_temperature<span class="o">(</span>element<span class="o">)</span> <span class="p">;</span>
             air_temperature:units <span class="o">=</span> <span class="s2">&quot;K&quot;</span> <span class="p">;</span>
             air_temperature:standard_name <span class="o">=</span> <span class="s2">&quot;air_temperature&quot;</span> <span class="p">;</span>

// global attributes:
             :Conventions <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
             :featureType <span class="o">=</span> <span class="s2">&quot;timeSeries&quot;</span> <span class="p">;</span>
data:

 <span class="nv">count</span> <span class="o">=</span> 1, <span class="m">4</span> <span class="p">;</span>

 <span class="nv">air_temperature</span> <span class="o">=</span> 280, 281, 279, 278, 279.5 <span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="gathering">
<span id="id54"></span><h3><strong>Gathering</strong><a class="headerlink" href="#gathering" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#compression-by-gathering">Compression by gathering</a> combines axes of a multidimensional array
into a new, discrete axis whilst omitting the missing values and thus
reducing the number of values that need to be stored.</p>
<p>The list variable that is required to uncompress a gathered array is
stored in a <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a> object and is retrieved with the <a class="reference internal" href="method/cfdm.Data.get_list.html#cfdm.Data.get_list" title="cfdm.Data.get_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_list</span></code></a>
method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<p>This is illustrated with the file <code class="docutils literal notranslate"><span class="pre">gathered.nc</span></code> (<a class="reference download internal" download="" href="_downloads/d347af6e208d56e9f7ef78113aa117b2/gathered.nc"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 1kB) <a class="footnote-reference" href="#files" id="id55">[2]</a>:</p>
<div class="literal-block-wrapper docutils container" id="id169">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the compressed dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id169" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ncdump -h gathered.nc
netcdf gathered <span class="o">{</span>
dimensions:
     <span class="nb">time</span> <span class="o">=</span> <span class="m">2</span> <span class="p">;</span>
     <span class="nv">lat</span> <span class="o">=</span> <span class="m">4</span> <span class="p">;</span>
     <span class="nv">lon</span> <span class="o">=</span> <span class="m">5</span> <span class="p">;</span>
     <span class="nv">landpoint</span> <span class="o">=</span> <span class="m">7</span> <span class="p">;</span>
variables:
     double time<span class="o">(</span><span class="nb">time</span><span class="o">)</span> <span class="p">;</span>
             time:standard_name <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
             time:units <span class="o">=</span> <span class="s2">&quot;days since 2000-1-1&quot;</span> <span class="p">;</span>
     double lat<span class="o">(</span>lat<span class="o">)</span> <span class="p">;</span>
             lat:standard_name <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span> <span class="p">;</span>
             lat:units <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span> <span class="p">;</span>
     double lon<span class="o">(</span>lon<span class="o">)</span> <span class="p">;</span>
             lon:standard_name <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span> <span class="p">;</span>
             lon:units <span class="o">=</span> <span class="s2">&quot;degrees_east&quot;</span> <span class="p">;</span>
     int landpoint<span class="o">(</span>landpoint<span class="o">)</span> <span class="p">;</span>
             landpoint:compress <span class="o">=</span> <span class="s2">&quot;lat lon&quot;</span> <span class="p">;</span>
     double pr<span class="o">(</span>time, landpoint<span class="o">)</span> <span class="p">;</span>
             pr:standard_name <span class="o">=</span> <span class="s2">&quot;precipitation_flux&quot;</span> <span class="p">;</span>
             pr:units <span class="o">=</span> <span class="s2">&quot;kg m2 s-1&quot;</span> <span class="p">;</span>

// global attributes:
             :Conventions <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>Reading and inspecting this file shows the data presented in
three-dimensional uncompressed form, whilst the underlying array is
still in the two-dimensional gathered representation described in the
file:</p>
<div class="literal-block-wrapper docutils container" id="id170">
<div class="code-block-caption"><span class="caption-text"><em>Read a field construct from a dataset that has been
compressed by gathering, and inspect its data in
uncompressed form.</em></span><a class="headerlink" href="#id170" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;gathered.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">Field: precipitation_flux (ncvar%pr)</span>
<span class="go">------------------------------------</span>
<span class="go">Data            : precipitation_flux(time(2), latitude(4), longitude(5)) kg m2 s-1</span>
<span class="go">Dimension coords: time(2) = [2000-02-01 00:00:00, 2000-03-01 00:00:00]</span>
<span class="go">                : latitude(4) = [-90.0, ..., -75.0] degrees_north</span>
<span class="go">                : longitude(5) = [0.0, ..., 40.0] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[--       0.000122 0.0008   --       --      ]</span>
<span class="go">  [0.000177 --       0.000175 0.00058  --      ]</span>
<span class="go">  [--       --       --       --       --      ]</span>
<span class="go">  [--       0.000206 --       0.0007   --      ]]</span>

<span class="go"> [[--       0.000202 0.000174 --       --      ]</span>
<span class="go">  [0.00084  --       0.000201 0.0057   --      ]</span>
<span class="go">  [--       --       --       --       --      ]</span>
<span class="go">  [--       0.000223 --       0.000102 --      ]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id171">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the underlying compressed array and the list
variable that defines how to uncompress the data.</em></span><a class="headerlink" href="#id171" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[[0.000122 0.0008   0.000177 0.000175 0.00058 0.000206 0.0007  ]</span>
<span class="go"> [0.000202 0.000174 0.00084  0.000201 0.0057  0.000223 0.000102]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span>
<span class="go">&lt;List: ncvar%landpoint(7) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">list_variable</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 2 5 7 8 16 18]</span>
</pre></div>
</div>
</div>
<p>Subspaces based on the uncompressed axes of the field construct are
easily created:</p>
<div class="literal-block-wrapper docutils container" id="id172">
<div class="code-block-caption"><span class="caption-text"><em>Get subspaces based on indices of the uncompressed
data.</em></span><a class="headerlink" href="#id172" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Field: precipitation_flux(time(1), latitude(4), longitude(5)) kg m2 s-1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">&lt;Field: precipitation_flux(time(1), latitude(4), longitude(2)) kg m2 s-1&gt;</span>
</pre></div>
</div>
</div>
<p>The underlying array of original data remains in compressed form until
data array elements are modified:</p>
<div class="literal-block-wrapper docutils container" id="id173">
<div class="code-block-caption"><span class="caption-text"><em>Change an element of the data and show that the
underlying array is no longer compressed.</em></span><a class="headerlink" href="#id173" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</div>
<p>A construct with an underlying gathered array is created by
initializing a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance with a gathered array that is stored in
the special <a class="reference internal" href="class/cfdm.GatheredArray.html#cfdm.GatheredArray" title="cfdm.GatheredArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GatheredArray</span></code></a> array object. The following code creates a
simple field construct with an underlying gathered array:</p>
<div class="literal-block-wrapper docutils container" id="id174">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with compressed data.</em></span><a class="headerlink" href="#id174" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Define the gathered values</span>
<span class="n">gathered_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="c1"># Define the list array values</span>
<span class="n">list_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Create the list variable</span>
<span class="n">list_variable</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">list_array</span><span class="p">))</span>

<span class="c1"># Create the gathered array object, specifying the uncompressed</span>
<span class="c1"># shape</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">GatheredArray</span><span class="p">(</span>
                 <span class="n">compressed_array</span><span class="o">=</span><span class="n">gathered_array</span><span class="p">,</span>
                 <span class="n">compressed_dimension</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                 <span class="n">list_variable</span><span class="o">=</span><span class="n">list_variable</span><span class="p">)</span>

<span class="c1"># Create the field construct with the domain axes and the gathered</span>
<span class="c1"># array</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;kg m-2 s-1&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs for the uncompressed array</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">P</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Note that, because compression by gathering acts on a subset of the
array dimensions, it is necessary to state the position of the
compressed dimension in the compressed array (with the
<code class="docutils literal notranslate"><span class="pre">compressed_dimension</span></code> parameter of the <a class="reference internal" href="class/cfdm.GatheredArray.html#cfdm.GatheredArray" title="cfdm.GatheredArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GatheredArray</span></code></a>
initialisation).</p>
<p>The new field construct can now be inspected and written a netCDF file:</p>
<div class="literal-block-wrapper docutils container" id="id175">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct and write it to disk.</em></span><a class="headerlink" href="#id175" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span>
<span class="go">&lt;Field: precipitation_flux(key%domainaxis0(2), key%domainaxis1(3), key%domainaxis2(2)) kg m-2 s-1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rray</span><span class="p">)</span>
<span class="go">[[[ -- 2.0]</span>
<span class="go">  [ --  --]</span>
<span class="go">  [1.0 3.0]]</span>

<span class="go"> [[ -- 4.0]</span>
<span class="go">  [ --  --]</span>
<span class="go">  [0.0 5.0]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[[2. 1. 3.]</span>
<span class="go"> [4. 0. 5.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span>
<span class="go">&lt;List: (3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">list_variable</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 4 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="s1">&#39;P_gathered.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The content of the new file is:</p>
<div class="literal-block-wrapper docutils container" id="id176">
<div class="code-block-caption"><span class="caption-text"><em>Inspect new the compressed dataset with the ncdump
command line tool.</em></span><a class="headerlink" href="#id176" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ncdump P_gathered.nc
netcdf P_gathered <span class="o">{</span>
dimensions:
     <span class="nv">dim</span> <span class="o">=</span> <span class="m">2</span> <span class="p">;</span>
     <span class="nv">dim_1</span> <span class="o">=</span> <span class="m">3</span> <span class="p">;</span>
     <span class="nv">dim_2</span> <span class="o">=</span> <span class="m">2</span> <span class="p">;</span>
     <span class="nv">list</span> <span class="o">=</span> <span class="m">3</span> <span class="p">;</span>
variables:
     int64 list<span class="o">(</span>list<span class="o">)</span> <span class="p">;</span>
             list:compress <span class="o">=</span> <span class="s2">&quot;dim_1 dim_2&quot;</span> <span class="p">;</span>
     float precipitation_flux<span class="o">(</span>dim, list<span class="o">)</span> <span class="p">;</span>
             precipitation_flux:units <span class="o">=</span> <span class="s2">&quot;kg m-2 s-1&quot;</span> <span class="p">;</span>
             precipitation_flux:standard_name <span class="o">=</span> <span class="s2">&quot;precipitation_flux&quot;</span> <span class="p">;</span>

// global attributes:
             :Conventions <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
data:

 <span class="nv">list</span> <span class="o">=</span> 1, 4, <span class="m">5</span> <span class="p">;</span>

 <span class="nv">precipitation_flux</span> <span class="o">=</span>
  2, 1, 3,
  4, 0, <span class="m">5</span> <span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p class="rubric">Footnotes</p>
<hr class="docutils" />
<table class="docutils footnote" frame="void" id="dap" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[1]</a></td><td>Requires the netCDF4 python package to have been built with
OPeNDAP support enabled. See
<a class="reference external" href="http://unidata.github.io/netcdf4-python">http://unidata.github.io/netcdf4-python</a> for details.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="files" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id49">2</a>, <a class="fn-backref" href="#id50">3</a>, <a class="fn-backref" href="#id53">4</a>, <a class="fn-backref" href="#id55">5</a>)</em> The tutorial files may be also found in the <a class="reference external" href="https://github.com/NCAS-CMS/cfdm/tree/master/docs/_downloads">downloads
directory</a>
of the on-line code repository.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="masked" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id20">[3]</a></td><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.masked</span></code> is an alias of <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/maskedarray.baseclass.html#numpy.ma.masked" title="(in NumPy v1.16)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ma.masked</span></code></a>.</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2019, David Hassell.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/tutorial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>