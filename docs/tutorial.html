
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Tutorial &#8212; Documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reference manual" href="reference.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>Tutorial</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cf-version"><strong>CF version</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-datasets"><strong>Reading datasets</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#inspection"><strong>Inspection</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#properties"><strong>Properties</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#data"><strong>Data</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#subspacing"><strong>Subspacing</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadata-constructs"><strong>Metadata constructs</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#netcdf-interface"><strong>NetCDF interface</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-to-disk"><strong>Writing to disk</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#field-creation"><strong>Field creation</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#domain"><strong>Domain</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#copying"><strong>Copying</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#equality"><strong>Equality</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#external-variables"><strong>External variables</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#compression"><strong>Compression</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#discrete-sampling-geometries"><strong>Discrete sampling geometries</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#gathering"><strong>Gathering</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html"><strong>Reference manual</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="subclassing.html"><strong>Subclassing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html"><strong>Philosophy</strong></a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter"><strong>Installation</strong></a></li>
      <li>Next: <a href="reference.html" title="next chapter"><strong>Reference manual</strong></a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial">
<span id="id1"></span><h1><strong>Tutorial</strong><a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>Version 1.7b4</p>
<hr class="docutils" />
<p>The code examples in this tutorial are available in an <strong>IPython
notebook</strong> (<a class="reference download internal" href="_downloads/tutorial.ipynb" download=""><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 70kB)
<a class="footnote-reference" href="#files" id="id2">[1]</a>.</p>
<p>The cfdm package is imported as follows:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cfdm</span>
</pre></div>
</div>
<div class="section" id="cf-version">
<span id="id3"></span><h2><strong>CF version</strong><a class="headerlink" href="#cf-version" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The version of the <a class="reference external" href="http://cfconventions.org">CF conventions</a> and
the CF data model being used may be found with the <a class="reference internal" href="function/cfdm.CF.html#cfdm.CF" title="cfdm.CF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.CF</span></code></a> function:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">CF</span><span class="p">()</span>
<span class="go">&#39;1.7&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-datasets">
<span id="reading"></span><h2><strong>Reading datasets</strong><a class="headerlink" href="#reading-datasets" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function reads a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">netCDF</a> file from disk, or
from an <a class="reference external" href="https://www.opendap.org/">OPeNDAP</a> URL <a class="footnote-reference" href="#opendap2" id="id4">[2]</a>, and
returns the contents as a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> of zero or more <a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a> class
instances, each of which represents a field construct <a class="footnote-reference" href="#language" id="id5">[3]</a>.</p>
<p>For example, to read the file <strong>file.nc</strong> (<a class="reference download internal" href="_downloads/file.nc" download=""><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 9kB) <a class="footnote-reference" href="#files" id="id6">[1]</a>:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cfdm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">list</span>
</pre></div>
</div>
<p>All formats of netCDF3 and netCDF4 files can be read.</p>
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li>provide files that contain <a class="reference internal" href="#external-variables"><span class="std std-ref">external variables</span></a>, and</li>
<li>return “metadata” netCDF variables (i.e. those that are referenced
from CF-netCDF data variables) as independent field constructs.</li>
</ul>
<dl class="docutils">
<dt><em>Note on performance</em></dt>
<dd>Descriptive properties are always read into memory, but <a class="reference external" href="https://en.wikipedia.org/wiki/Lazy_loading">lazy
loading</a> is employed
for all data arrays, which means that no data is read into memory
until the data is required for inspection or to modify the array
contents. This maximises the number of fields that may be read
within a session, and makes the read operation fast.</dd>
</dl>
</div>
<div class="section" id="inspection">
<span id="id7"></span><h2><strong>Inspection</strong><a class="headerlink" href="#inspection" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The contents of a field construct may be inspected at three different
levels of detail.</p>
<div class="section" id="minimal-detail">
<h3><strong>Minimal detail</strong><a class="headerlink" href="#minimal-detail" title="Permalink to this headline">¶</a></h3>
<p>The built-in <a class="reference external" href="https://docs.python.org/3/library/functions.html#repr" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repr</span></code></a> function returns a short, one-line description:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
</pre></div>
</div>
<p>This gives the identity of the field construct
(e.g. “specific_humidity”), the identities and sizes of the dimensions
spanned by the data array (latitude and longitude with sizes 5 and 8
respectively) and the units of the data (“1”).</p>
</div>
<div class="section" id="medium-detail">
<h3><strong>Medium detail</strong><a class="headerlink" href="#medium-detail" title="Permalink to this headline">¶</a></h3>
<p>The built-in <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> function returns similar information as the
one-line output, along with short descriptions of the metadata
constructs, which include the first and last values of their data
arrays:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.81, ..., 0.78]] K</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name:Grid latitude name(grid_latitude(10)) = [--, ..., kappa]</span>
<span class="go">Cell measures   : measure%area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
</pre></div>
</div>
</div>
<div class="section" id="full-detail">
<h3><strong>Full detail</strong><a class="headerlink" href="#full-detail" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="method/cfdm.Field.dump.html#cfdm.Field.dump" title="cfdm.Field.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump</span></code></a> method of the field construct gives all
properties of all constructs, including metadata constructs and their
components, and shows the first and last values of all data arrays:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">----------------------------------</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Conventions = &#39;CF-1.7&#39;</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;specific_humidity&#39;</span>
<span class="go">units = &#39;1&#39;</span>

<span class="go">Data(latitude(5), longitude(8)) = [[0.003, ..., 0.032]] 1</span>

<span class="go">Cell Method: area: mean</span>

<span class="go">Domain Axis: latitude(5)</span>
<span class="go">Domain Axis: longitude(8)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_north&#39;</span>
<span class="go">    Data(latitude(5)) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">    Bounds:Data(latitude(5), 2) = [[-90.0, ..., 90.0]]</span>

<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(longitude(8)) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">    Bounds:Data(longitude(8), 2) = [[0.0, ..., 360.0]]</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2019-01-01 00:00:00]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">---------------------------------</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Conventions = &#39;CF-1.7&#39;</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;air_temperature&#39;</span>
<span class="go">units = &#39;K&#39;</span>

<span class="go">Data(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) = [[[0.0, ..., 89.0]]] K</span>

<span class="go">Cell Method: grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees)</span>
<span class="go">Cell Method: time(1): maximum</span>

<span class="go">Field Ancillary: air_temperature standard_error</span>
<span class="go">    standard_name = &#39;air_temperature standard_error&#39;</span>
<span class="go">    units = &#39;K&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[0.81, ..., 0.78]] K</span>

<span class="go">Domain Axis: atmosphere_hybrid_height_coordinate(1)</span>
<span class="go">Domain Axis: grid_latitude(10)</span>
<span class="go">Domain Axis: grid_longitude(9)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: atmosphere_hybrid_height_coordinate</span>
<span class="go">    computed_standard_name = &#39;altitude&#39;</span>
<span class="go">    standard_name = &#39;atmosphere_hybrid_height_coordinate&#39;</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [1.5]</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[1.0, 2.0]]</span>

<span class="go">Dimension coordinate: grid_latitude</span>
<span class="go">    standard_name = &#39;grid_latitude&#39;</span>
<span class="go">    units = &#39;degrees&#39;</span>
<span class="go">    Data(grid_latitude(10)) = [2.2, ..., -1.76] degrees</span>
<span class="go">    Bounds:Data(grid_latitude(10), 2) = [[2.42, ..., -1.98]]</span>

<span class="go">Dimension coordinate: grid_longitude</span>
<span class="go">    standard_name = &#39;grid_longitude&#39;</span>
<span class="go">    units = &#39;degrees&#39;</span>
<span class="go">    Data(grid_longitude(9)) = [-4.7, ..., -1.18] degrees</span>
<span class="go">    Bounds:Data(grid_longitude(9), 2) = [[-4.92, ..., -0.96]]</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2019-01-01 00:00:00]</span>

<span class="go">Auxiliary coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_N&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>

<span class="go">Auxiliary coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_E&#39;</span>
<span class="go">    Data(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>

<span class="go">Auxiliary coordinate: long_name:Grid latitude name</span>
<span class="go">    long_name = &#39;Grid latitude name&#39;</span>
<span class="go">    Data(grid_latitude(10)) = [--, ..., kappa]</span>

<span class="go">Domain ancillary: ncvar%a</span>
<span class="go">    units = &#39;m&#39;</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[5.0, 15.0]]</span>

<span class="go">Domain ancillary: ncvar%b</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[14.0, 26.0]]</span>

<span class="go">Domain ancillary: surface_altitude</span>
<span class="go">    standard_name = &#39;surface_altitude&#39;</span>
<span class="go">    units = &#39;m&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>

<span class="go">Coordinate reference: atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:computed_standard_name = altitude</span>
<span class="go">    Coordinate conversion:standard_name = atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:a = Domain Ancillary: ncvar%a</span>
<span class="go">    Coordinate conversion:b = Domain Ancillary: ncvar%b</span>
<span class="go">    Coordinate conversion:orog = Domain Ancillary: surface_altitude</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Dimension Coordinate: atmosphere_hybrid_height_coordinate</span>

<span class="go">Coordinate reference: rotated_latitude_longitude</span>
<span class="go">    Coordinate conversion:grid_mapping_name = rotated_latitude_longitude</span>
<span class="go">    Coordinate conversion:grid_north_pole_latitude = 38.0</span>
<span class="go">    Coordinate conversion:grid_north_pole_longitude = 190.0</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Dimension Coordinate: grid_longitude</span>
<span class="go">    Dimension Coordinate: grid_latitude</span>
<span class="go">    Auxiliary Coordinate: longitude</span>
<span class="go">    Auxiliary Coordinate: latitude</span>

<span class="go">Cell measure: measure%area</span>
<span class="go">    units = &#39;km2&#39;</span>
<span class="go">    Data(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="properties">
<span id="id8"></span><h2><strong>Properties</strong><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Descriptive properties that apply to field construct as a whole may be
retrieved with the <a class="reference internal" href="method/cfdm.Field.properties.html#cfdm.Field.properties" title="cfdm.Field.properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">properties</span></code></a> method:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
</pre></div>
</div>
<p>Individual properties may be accessed and modified with the
<a class="reference internal" href="method/cfdm.Field.del_property.html#cfdm.Field.del_property" title="cfdm.Field.del_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_property</span></code></a>, <a class="reference internal" href="method/cfdm.Field.get_property.html#cfdm.Field.get_property" title="cfdm.Field.get_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_property</span></code></a>, <a class="reference internal" href="method/cfdm.Field.has_property.html#cfdm.Field.has_property" title="cfdm.Field.has_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_property</span></code></a>,
and <a class="reference internal" href="method/cfdm.Field.set_property.html#cfdm.Field.set_property" title="cfdm.Field.set_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_property</span></code></a> methods:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;not set&#39;</span><span class="p">)</span>
<span class="go">&#39;not set&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;not set&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
</pre></div>
</div>
<p>The properties may be completely replaced with another collection by
providing a new set of properties to the <a class="reference internal" href="method/cfdm.Field.properties.html#cfdm.Field.properties" title="cfdm.Field.properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">properties</span></code></a> method:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;foo&#39;: &#39;bar&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="go">{&#39;foo&#39;: &#39;bar&#39;,</span>
<span class="go">  &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
</pre></div>
</div>
</div>
<div class="section" id="data">
<span id="id9"></span><h2><strong>Data</strong><a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The field construct’s data array is stored in a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> class instance
that is accessed with the <a class="reference internal" href="method/cfdm.Field.get_data.html#cfdm.Field.get_data" title="cfdm.Field.get_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data</span></code></a> method:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="go">&lt;Data(1, 10, 9): [[[262.8, ..., 269.7]]] K&gt;</span>
</pre></div>
</div>
<p>The data array may be retrieved as an independent (possibly masked)
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code></a> array with the <a class="reference internal" href="method/cfdm.Field.get_array.html#cfdm.Field.get_array" title="cfdm.Field.get_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_array</span></code></a> method:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[[262.8 270.5 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7 268.4 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7 279.1 273.4 274.2 279.6 270.2 280.0 272.5 263.7]</span>
<span class="go">  [261.7 260.6 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.0 263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.0 270.6]</span>
<span class="go">  [267.9 273.5 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9 278.7 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4 264.2 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
<p>The field construct also has a <a class="reference internal" href="attribute/cfdm.Field.data.html#cfdm.Field.data" title="cfdm.Field.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a> attribute that is an
alias for the <a class="reference internal" href="method/cfdm.Field.get_data.html#cfdm.Field.get_data" title="cfdm.Field.get_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data</span></code></a> method, which makes it easier to
access attributes and methods of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float64&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span>
<span class="go">90</span>
</pre></div>
</div>
<div class="section" id="indexing">
<span id="id10"></span><h3><strong>Indexing</strong><a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h3>
<p>Indexing a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance follows rules that are very similar to the
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">numpy indexing rules</a>,
the only differences being:</p>
<ul class="simple">
<li><strong>An integer index i takes the i-th element but does not reduce the
rank by one.</strong></li>
</ul>
<ul class="simple">
<li><strong>When two or more dimensions’ indices are sequences of integers
then these indices work independently along each dimension (similar
to the way vector subscripts work in Fortran). This is the same
behaviour as indexing on a</strong> <code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code> <strong>object of the</strong> <a class="reference external" href="http://unidata.github.io/netcdf4-python">netCDF4
package</a><strong>.</strong></li>
</ul>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 1, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 3, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 1)</span>
</pre></div>
</div>
</div>
<div class="section" id="assignment">
<span id="data-assignment"></span><h3><strong>Assignment</strong><a class="headerlink" href="#assignment" title="Permalink to this headline">¶</a></h3>
<p>Data array elements are changed by assigning to elements selected by
indexing the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance using the <a class="reference internal" href="#indexing"><span class="std std-ref">cfdm indexing rules</span></a>.</p>
<p>The value, or values, being assigned must be broadcastable to the
shape defined by the indices, using the <a class="reference external" href="https://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">numpy broadcasting rules</a>.</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span> <span class="o">=</span>  <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[[  0.0   1.0   2.0   3.0   4.0   5.0   6.0 --   8.0]</span>
<span class="go">  [272.7 -10.0 279.5 278.9 263.8 263.3 274.2 -- 279.5]</span>
<span class="go">  [269.7 -10.0 273.4 274.2  -2.0 270.2 280.0 --  -3.0]</span>
<span class="go">  [261.7 -10.0 270.8 260.3 265.6 279.4 276.9 -- 260.6]</span>
<span class="go">  [264.2 -10.0 262.5  -3.0  -2.0  -1.0 270.4 -- 275.3]</span>
<span class="go">  [263.9 -10.0 272.1  -6.0  -5.0  -4.0 260.0 -- 270.2]</span>
<span class="go">  [273.8 -10.0 268.5  -9.0  -8.0  -7.0 270.6 -- 270.6]</span>
<span class="go">  [267.9 -10.0 279.8 260.3 261.2 275.3 271.2 -- 268.9]</span>
<span class="go">  [270.9 -10.0 273.2 261.7 271.6 265.8 273.0 -- 266.4]</span>
<span class="go">  [276.4 -10.0 276.3 266.1  -2.0 268.1 277.0 --  -3.0]]]</span>
</pre></div>
</div>
</div>
<div class="section" id="data-dimensions">
<h3><strong>Data dimensions</strong><a class="headerlink" href="#data-dimensions" title="Permalink to this headline">¶</a></h3>
<p>The dimensions of a field construct’s data may be reordered, have size
one dimensions removed and have new new size one dimensions included
by using the following field construct methods:</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.transpose.html#cfdm.Field.transpose" title="cfdm.Field.transpose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transpose</span></code></a></td>
<td>Reorder data dimensions</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.expand_dims.html#cfdm.Field.expand_dims" title="cfdm.Field.expand_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_dims</span></code></a></td>
<td>Insert a new size one data dimension</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.squeeze.html#cfdm.Field.squeeze" title="cfdm.Field.squeeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">squeeze</span></code></a></td>
<td>Remove size one data dimensions</td>
</tr>
</tbody>
</table>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span>
<span class="go">&lt;Field: air_temperature(grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;domainaxis3&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span>
<span class="go">&lt;Field: air_temperature(grid_latitude(10), time(1), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">&lt;Field: air_temperature(grid_longitude(9), grid_latitude(10), time(1)) K&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="subspacing">
<span id="id11"></span><h2><strong>Subspacing</strong><a class="headerlink" href="#subspacing" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Creation of a new field construct which spans a subspace of the
original domain is achieved by indexing the field directly (rather
than its <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance). The new subspace contains the same
properties and similar metadata constructs to the original field, but
the latter are also subspaced when they span domain axis constructs
that have been changed. Subspacing uses the same <a class="reference internal" href="#indexing"><span class="std std-ref">cfdm indexing
rules</span></a> that apply to the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> class.</p>
<p>In this example a new field is created whose domain spans the first
latitude of the original, and with a reversed longitude axis:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(1), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(1) = [-75.0] degrees_north</span>
<span class="go">                : longitude(8) = [337.5, ..., 22.5] degrees_east</span>
</pre></div>
</div>
</div>
<div class="section" id="metadata-constructs">
<span id="constructs"></span><h2><strong>Metadata constructs</strong><a class="headerlink" href="#metadata-constructs" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The metadata constructs are all of the constructs that serve to
describe the field construct that contains them. Each CF data model
metadata construct has a corresponding cfdm class:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="41%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">CF data model construct</th>
<th class="head">Description</th>
<th class="head">cfdm class</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Domain axis</td>
<td>Independent axes of the domain</td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></td>
</tr>
<tr class="row-odd"><td>Dimension coordinate</td>
<td>Domain cell locations</td>
<td><a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a></td>
</tr>
<tr class="row-even"><td>Auxiliary coordinate</td>
<td>Domain cell locations</td>
<td><a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a></td>
</tr>
<tr class="row-odd"><td>Coordinate reference</td>
<td>Domain coordinate systems</td>
<td><a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a></td>
</tr>
<tr class="row-even"><td>Domain ancillary</td>
<td>Cell locations in alternative
coordinate systems</td>
<td><a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a></td>
</tr>
<tr class="row-odd"><td>Cell measure</td>
<td>Domain cell size or shape</td>
<td><a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></td>
</tr>
<tr class="row-even"><td>Field ancillary</td>
<td>Ancillary metadata which vary
within the domain</td>
<td><a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a></td>
</tr>
<tr class="row-odd"><td>Cell method</td>
<td>Describes how data represent
variation within cells</td>
<td><a class="reference internal" href="class/cfdm.CellMethod.html#cfdm.CellMethod" title="cfdm.CellMethod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMethod</span></code></a></td>
</tr>
</tbody>
</table>
<p>The metadata constructs are returned by the <a class="reference internal" href="method/cfdm.Field.constructs.html#cfdm.Field.constructs" title="cfdm.Field.constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constructs</span></code></a> method
of the field construct, which provides a dictionary of the metadata
constructs, each of which is keyed by a unique identifier called a
“construct identifier”.</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">()</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CellMethod: area: mean&gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: latitude(5) degrees_north&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: longitude(8) degrees_east&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;,</span>
<span class="go"> &#39;domainaxis0&#39;: &lt;DomainAxis: 5&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: 8&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: 1&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">()</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name:Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CellMeasure: measure%area(9, 10) km2&gt;,</span>
<span class="go"> &#39;cellmethod0&#39;: &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;,</span>
<span class="go"> &#39;coordinatereference0&#39;: &lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;,</span>
<span class="go"> &#39;coordinatereference1&#39;: &lt;CoordinateReference: rotated_latitude_longitude&gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;,</span>
<span class="go"> &#39;domainancillary0&#39;: &lt;DomainAncillary: ncvar%a(1) m&gt;,</span>
<span class="go"> &#39;domainancillary1&#39;: &lt;DomainAncillary: ncvar%b(1) &gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;domainaxis0&#39;: &lt;DomainAxis: 1&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: 10&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: 9&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;DomainAxis: 1&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
<p>The construct identifiers are usually generated internally by the
field construct and are</p>
<ul class="simple">
<li><em>robust</em> (each metadata construct is guaranteed to have a unique
identifier within its parent field construct),</li>
<li><em>arbitrary</em> (no semantic meaning should be attached to the
identifier, and the same identifier will usually refer to different
metadata constructs in different field constructs), and</li>
<li><em>unstable</em> (the identifiers could be different each time the field
construct is created).</li>
</ul>
<p>The <a class="reference internal" href="method/cfdm.Field.constructs.html#cfdm.Field.constructs" title="cfdm.Field.constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constructs</span></code></a> method has optional parameters to filter the
metadata constructs by</p>
<ul class="simple">
<li>metadata construct type,</li>
<li>property value,</li>
<li>whether or the data array spans particular domain axis constructs,</li>
<li>netCDF variable name,</li>
<li>netCDF dimension name, and</li>
<li>construct identifier.</li>
</ul>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">)</span>
<span class="go">{&#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="n">construct_type</span><span class="o">=</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">)</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domainaxis1&#39;</span><span class="p">])</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name:Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CellMeasure: measure%area(9, 10) km2&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domainaxis3&#39;</span><span class="p">])</span>
<span class="go">{&#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="n">construct_type</span><span class="o">=</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domainaxis1&#39;</span><span class="p">])</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;wavelength&#39;</span><span class="p">)</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>Selection by construct identifier is useful for systematic metadata
construct access, and for when a metadata construct is not
identifiable by other means.</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="n">cid</span><span class="o">=</span><span class="s1">&#39;domainancillary2&#39;</span><span class="p">)</span>
<span class="go">{&#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;cid</span><span class="si">%c</span><span class="s1">ellmethod1&#39;</span><span class="p">)</span>
<span class="go">{&#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="n">cid</span><span class="o">=</span><span class="s1">&#39;auxiliarycoordinate999&#39;</span><span class="p">)</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>An individual metadata construct may be returned without its construct
identifier, via the <a class="reference internal" href="method/cfdm.Field.get_construct.html#cfdm.Field.get_construct" title="cfdm.Field.get_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_construct</span></code></a> method of the field
construct, which supports the same filtering options as the
<a class="reference internal" href="method/cfdm.Field.constructs.html#cfdm.Field.constructs" title="cfdm.Field.constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constructs</span></code></a> method. The existence of a metadata construct may
be checked with the <a class="reference internal" href="method/cfdm.Field.has_construct.html#cfdm.Field.has_construct" title="cfdm.Field.has_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_construct</span></code></a> method of the field
construct:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;units:km2&#39;</span><span class="p">)</span>
<span class="go">&lt;CellMeasure: measure%area(9, 10) km2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;units:degrees&#39;</span><span class="p">)</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;units:degrees&#39;</span><span class="p">)</span>
<span class="go">ValueError: More than one construct meets criteria</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_construct</span><span class="p">(</span><span class="s1">&#39;units:degrees&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Metadata constructs of a particular type can also be retrieved with
the following methods of the field construct:</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.domain_axes.html#cfdm.Field.domain_axes" title="cfdm.Field.domain_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_axes</span></code></a></td>
<td>The domain axis constructs</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.cell_methods.html#cfdm.Field.cell_methods" title="cfdm.Field.cell_methods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_methods</span></code></a></td>
<td>The ordered cell method constructs</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.field_ancillaries.html#cfdm.Field.field_ancillaries" title="cfdm.Field.field_ancillaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">field_ancillaries</span></code></a></td>
<td>The field ancillary constructs</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.auxiliary_coordinates.html#cfdm.Field.auxiliary_coordinates" title="cfdm.Field.auxiliary_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auxiliary_coordinates</span></code></a></td>
<td>The auxiliary coordinate constructs</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.cell_measures.html#cfdm.Field.cell_measures" title="cfdm.Field.cell_measures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_measures</span></code></a></td>
<td>The cell measure constructs</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.dimension_coordinates.html#cfdm.Field.dimension_coordinates" title="cfdm.Field.dimension_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimension_coordinates</span></code></a></td>
<td>The dimension coordinates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.domain_ancillaries.html#cfdm.Field.domain_ancillaries" title="cfdm.Field.domain_ancillaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_ancillaries</span></code></a></td>
<td>The domain ancillary constructs</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.coordinate_references.html#cfdm.Field.coordinate_references" title="cfdm.Field.coordinate_references"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinate_references</span></code></a></td>
<td>The coordinate reference constructs</td>
</tr>
</tbody>
</table>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cell_methods</span><span class="p">()</span>
<span class="go">OrderedDict([(&#39;cellmethod0&#39;,</span>
<span class="go">               &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;),</span>
<span class="go">             (&#39;cellmethod1&#39;, &lt;CellMethod: domainaxis3: maximum&gt;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">dimension_coordinates</span><span class="p">()</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
</pre></div>
</div>
<div class="section" id="domain-axes">
<h3><strong>Domain axes</strong><a class="headerlink" href="#domain-axes" title="Permalink to this headline">¶</a></h3>
<p>The domain axis constructs spanned by a metadata construct’s data are
found with the <a class="reference internal" href="method/cfdm.Field.construct_axes.html#cfdm.Field.construct_axes" title="cfdm.Field.construct_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct_axes</span></code></a> method of the field construct:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct_axes</span><span class="p">()</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;),</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: (&#39;domainaxis2&#39;, &#39;domainaxis1&#39;),</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;cellmeasure0&#39;: (&#39;domainaxis2&#39;, &#39;domainaxis1&#39;),</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: (&#39;domainaxis2&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: (&#39;domainaxis3&#39;,),</span>
<span class="go"> &#39;domainancillary0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;domainancillary1&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;domainancillary2&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;),</span>
<span class="go"> &#39;fieldancillary0&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)}</span>
</pre></div>
</div>
<p>The domain axis constructs spanned by the field construct’s data found
with the <a class="reference internal" href="method/cfdm.Field.get_data_axes.html#cfdm.Field.get_data_axes" title="cfdm.Field.get_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_axes</span></code></a> method of the field construct:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">()</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;DomainAxis: 1&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: 10&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: 9&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;DomainAxis: 1&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">()</span>
<span class="go">(&#39;domainaxis0&#39;, &#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="properties-and-data">
<h3><strong>Properties and data</strong><a class="headerlink" href="#properties-and-data" title="Permalink to this headline">¶</a></h3>
<p>Where applicable, metadata constructs share the same API as the field
construct. This means, for instance, that any construct that has a
data array (such as auxiliary coordinate construct) will have a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">get_array</span></code> method to access its data as an independent numpy array:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span>
<span class="go">&lt;DimensionCoordinate: longitude(8) degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;units&#39;: &#39;degrees_east&#39;,</span>
<span class="go"> &#39;long_name&#39;: &#39;Longitude&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;longitude&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&lt;Data(1): [112.5] degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">133.33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[22.5 67.5 133.33 157.5 202.5 247.5 292.5 337.5]</span>
</pre></div>
</div>
</div>
<div class="section" id="components">
<h3><strong>Components</strong><a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h3>
<p>Other classes are required to represent metadata construct components
that are neither “properties” nor “data”:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="41%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">cfdm class</th>
<th class="head">Description</th>
<th class="head">cfdm parent classes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a></td>
<td>Cell bounds.</td>
<td><a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="class/cfdm.CoordinateConversion.html#cfdm.CoordinateConversion" title="cfdm.CoordinateConversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateConversion</span></code></a></td>
<td>A formula for
converting coordinate values
taken from the dimension or
auxiliary coordinate
constructs
to a different coordinate
system.</td>
<td><a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a></td>
<td>The zeroes
of the dimension
and auxiliary coordinate
constructs which define a
coordinate system.</td>
<td><a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a></td>
</tr>
</tbody>
</table>
<p>Where applicable, these classes also share the same API as the field:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;grid_longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">lon</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span>
<span class="go">&lt;Bounds: ncvar%grid_longitude_bounds(9, 2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="go">&lt;Data(9, 2): [[-4.92, ..., -0.96]]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[-4.92 -4.48]</span>
<span class="go"> [-4.48 -4.04]</span>
<span class="go"> [-4.04 -3.6 ]</span>
<span class="go"> [-3.6  -3.16]</span>
<span class="go"> [-3.16 -2.72]</span>
<span class="go"> [-2.72 -2.28]</span>
<span class="go"> [-2.28 -1.84]</span>
<span class="go"> [-1.84 -1.4 ]</span>
<span class="go"> [-1.4  -0.96]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;rotated_latitude_longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">datum</span>
<span class="go">&lt;Datum: Parameters: earth_radius&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
<span class="go">{&#39;earth_radius&#39;: 6371007}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">construct_type</span><span class="o">=</span><span class="s1">&#39;coordinate_reference&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span><span class="o">.</span><span class="n">domain_ancillaries</span><span class="p">()</span>
<span class="go">{&#39;a&#39;: &#39;domainancillary0&#39;,</span>
<span class="go"> &#39;b&#39;: &#39;domainancillary1&#39;,</span>
<span class="go"> &#39;orog&#39;: &#39;domainancillary2&#39;}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="netcdf-interface">
<span id="id12"></span><h2><strong>NetCDF interface</strong><a class="headerlink" href="#netcdf-interface" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The logical CF data model is independent of netCDF, but the CF
conventions are designed to enable the processing and sharing of
datasets stored in netCDF files. Therefore, the cfdm package includes
methods for recording and editing netCDF elements that are not part of
the CF model, but are nonetheless often required to interpret and
create CF-netCDF datasets. See the section on <a class="reference internal" href="philosophy.html#philosophy"><span class="std std-ref">philosophy</span></a> for a further discussion.</p>
<p>When a netCDF dataset is read, netCDF elements (such as dimension and
variable names, and some attribute values) that do not have a place in
the CF data model are, nevertheless, stored within the appropriate
cfdm objects. This allows them to be used when writing field
constructs to a new netCDF dataset, and also makes them accessible for
<a class="reference internal" href="#constructs"><span class="std std-ref">metadata construct identification</span></a>.</p>
<p>Each construct has methods to access the netCDF elements which it
requires. For example, the field construct has the following methods:</p>
<table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.nc_get_variable.html#cfdm.Field.nc_get_variable" title="cfdm.Field.nc_get_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_variable</span></code></a></td>
<td>Return the netCDF variable name</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.nc_set_variable.html#cfdm.Field.nc_set_variable" title="cfdm.Field.nc_set_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></a></td>
<td>Set the netCDF variable name</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.nc_del_variable.html#cfdm.Field.nc_del_variable" title="cfdm.Field.nc_del_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_variable</span></code></a></td>
<td>Remove the netCDF variable name</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.nc_has_variable.html#cfdm.Field.nc_has_variable" title="cfdm.Field.nc_has_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_variable</span></code></a></td>
<td>Whether the netCDF variable name has
been set</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.nc_global_attributes.html#cfdm.Field.nc_global_attributes" title="cfdm.Field.nc_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_global_attributes</span></code></a></td>
<td>Return or replace the selection of
properties to be written as netCDF
global attributes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.nc_unlimited_dimensions.html#cfdm.Field.nc_unlimited_dimensions" title="cfdm.Field.nc_unlimited_dimensions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_unlimited_dimensions</span></code></a></td>
<td>Return or replace the selection of
domain axis constructs to be written
as netCDF unlimited dimensions</td>
</tr>
</tbody>
</table>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;q&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;project&#39;, &#39;Conventions&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_unlimited_dimensions</span><span class="p">()</span>
<span class="go">set()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;humidity&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;humidity&#39;</span>
</pre></div>
</div>
<p>The complete collection of netCDF interface methods is:</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="38%" />
<col width="36%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Classes</th>
<th class="head">NetCDF element</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_variable</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>,  <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></td>
<td>Variable name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_variable</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></td>
<td>Variable name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_variable</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></td>
<td>Variable name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></td>
<td>Variable name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></td>
<td>Dimension name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></td>
<td>Dimension name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></td>
<td>Dimension name</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></td>
<td>Dimension name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_global_attributes</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></td>
<td>Global attributes</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_unlimited_dimensions</span></code></td>
<td><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></td>
<td>Unlimited dimensions</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_external</span></code></td>
<td><a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></td>
<td>External variable status</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_instance_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Instance dimension of a ragged array</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_instance_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Instance dimension of a ragged array</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_instance_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Instance dimension of a ragged array</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_instance_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Instance dimension of a ragged array</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_sample_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Sample dimension of a ragged array</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_sample_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Sample dimension of a ragged array</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_sample_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Sample dimension of a ragged array</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension</span></code></td>
<td><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></td>
<td>Sample  dimension of a ragged array</td>
</tr>
</tbody>
</table>
<p>NetCDF variable and dimension names may be used to identify metadata
constructs via the <a class="reference internal" href="method/cfdm.Field.constructs.html#cfdm.Field.constructs" title="cfdm.Field.constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constructs</span></code></a> and <a class="reference internal" href="method/cfdm.Field.get_construct.html#cfdm.Field.get_construct" title="cfdm.Field.get_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_construct</span></code></a>
methods of the field construct:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;ncvar%b&#39;</span><span class="p">)</span>
<span class="go">{&#39;domainancillary1&#39;: &lt;DomainAncillary: ncvar%b(1) &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;ncvar</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&lt;DimensionCoordinate: grid_longitude(9) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;ncdim</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&lt;DomainAxis: 9&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-to-disk">
<span id="write"></span><h2><strong>Writing to disk</strong><a class="headerlink" href="#writing-to-disk" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function writes a field construct, or a sequence of
field constructs, to a new netCDF file on disk:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;q_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The new dataset is structured as follows:</p>
<div class="code bash highlight-python notranslate"><div class="highlight"><pre><span></span>$ ncdump -h q_file.nc
netcdf q_file {
dimensions:
     lat = 5 ;
     bounds2 = 2 ;
     lon = 8 ;
variables:
     double lat_bnds(lat, bounds2) ;
     double lat(lat) ;
             lat:units = &quot;degrees_north&quot; ;
             lat:standard_name = &quot;latitude&quot; ;
             lat:bounds = &quot;lat_bnds&quot; ;
     double lon_bnds(lon, bounds2) ;
     double lon(lon) ;
             lon:units = &quot;degrees_east&quot; ;
             lon:standard_name = &quot;longitude&quot; ;
             lon:bounds = &quot;lon_bnds&quot; ;
     double time ;
             time:units = &quot;days since 2018-12-01&quot; ;
             time:standard_name = &quot;time&quot; ;
     double humidity(lat, lon) ;
             humidity:standard_name = &quot;specific_humidity&quot; ;
             humidity:cell_methods = &quot;area: mean&quot; ;
             humidity:units = &quot;1&quot; ;
             humidity:coordinates = &quot;time&quot; ;

// global attributes:
             :Conventions = &quot;CF-1.7&quot; ;
             :project = &quot;research&quot; ;
}
</pre></div>
</div>
<p>A sequence of field constructs is written in exactly the same way:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;new_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li>set the output netCDF format (all netCDF3 and netCDF4 formats are
possible);</li>
<li>specify which field construct properties should become netCDF data
variable attributes and which should, if possible, become netCDF
global attributes;</li>
<li>create <a class="reference internal" href="#external-variables"><span class="std std-ref">external variables</span></a> in an external
file;</li>
<li>change the data type of output data arrays;</li>
<li>apply netCDF compression and packing; and</li>
<li>set the endian-ness of the output data.</li>
</ul>
<p>Output netCDF variable and dimension names read from a netCDF dataset
are stored in the resulting field constructs, and may also be set
manually with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension</span></code>
methods. If a name has not been set then one will be generated
internally (usually based on the standard name if it exists).</p>
<p>It is possible to create netCDF unlimited dimensions and set the HDF5
chunk size using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_unlimited_dimensions</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_chunksize</span></code> methods of the field construct.</p>
<div class="section" id="scalar-coordinate-variables">
<h3><strong>Scalar coordinate variables</strong><a class="headerlink" href="#scalar-coordinate-variables" title="Permalink to this headline">¶</a></h3>
<p>CF-netCDF scalar (i.e. zero-dimensional) coordinate variables are
created when there is a size one domain axis construct which is
spanned by a dimension coordinate construct’s data array, but not the
field construct’s data, nor the data of any other metadata construct.</p>
<p>This is the case for the “specific humidity” field construct <code class="docutils literal notranslate"><span class="pre">q</span></code>
that was written to the file <strong>q_file.nc</strong>.</p>
<p>To change this so that the “time” dimension coordinate construct is
written as a CF-netCDF size one coordinate variable, the field
construct’s data must be expanded to span the corresponding size one
domain axis construct, by using the <a class="reference internal" href="method/cfdm.Field.expand_dims.html#cfdm.Field.expand_dims" title="cfdm.Field.expand_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_dims</span></code></a> method of the
field construct:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">dimension_coordinates</span><span class="p">()</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: latitude(5) degrees_north&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: longitude(8) degrees_east&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">construct_axes</span><span class="p">()</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: (&#39;domainaxis2&#39;,)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;domainaxis2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span>
<span class="go">&lt;Field: specific_humidity(time(1), latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="s1">&#39;q2_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The new dataset is structured as follows (note, relative to file
<strong>q_file.nc</strong>, the existence of the “time” dimension and the lack of a
“coordinates” attribute on the, now three-dimensional, data variable):</p>
<div class="code bash highlight-python notranslate"><div class="highlight"><pre><span></span>$ ncdump -h q2_file.nc
netcdf q2_file {
dimensions:
     lat = 5 ;
     bounds2 = 2 ;
     lon = 8 ;
     time = 1 ;
variables:
     double lat_bnds(lat, bounds2) ;
     double lat(lat) ;
             lat:units = &quot;degrees_north&quot; ;
             lat:standard_name = &quot;latitude&quot; ;
             lat:bounds = &quot;lat_bnds&quot; ;
     double lon_bnds(lon, bounds2) ;
     double lon(lon) ;
             lon:units = &quot;degrees_east&quot; ;
             lon:standard_name = &quot;longitude&quot; ;
             lon:bounds = &quot;lon_bnds&quot; ;
     double time(time) ;
             time:units = &quot;days since 2018-12-01&quot; ;
             time:standard_name = &quot;time&quot; ;
     double humidity(time, lat, lon) ;
             humidity:units = &quot;1&quot; ;
             humidity:standard_name = &quot;specific_humidity&quot; ;
             humidity:cell_methods = &quot;area: mean&quot; ;

// global attributes:
             :Conventions = &quot;CF-1.7&quot; ;
             :project = &quot;research&quot; ;
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="field-creation">
<span id="id13"></span><h2><strong>Field creation</strong><a class="headerlink" href="#field-creation" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Creation of a field construct has three stages:</p>
<p><strong>Stage 1:</strong> The field construct is created without metadata constructs.</p>
<p><strong>Stage 2:</strong> Metadata constructs are created independently.</p>
<p><strong>Stage 3:</strong> The metadata constructs are inserted into the field
construct with cross-references to other, related metadata constructs
if required (for example, an auxiliary coordinate construct is related
to an ordered list of the domain axis constructs which correspond to
its data array dimensions).</p>
<p>There are two equivalent approaches to stages <strong>1</strong> and <strong>2</strong>.</p>
<p>Either as much of the content as possible is specified during object
instantiation:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: precipitation_flux&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">},</span>
<span class="gp">... </span>                              <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;DimensionCoordinate: long_name:Longitude(3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux status_flag&#39;</span><span class="p">},</span>
<span class="gp">... </span>       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: precipitation_flux status_flag(3) &gt;</span>
</pre></div>
</div>
<p>or else some or all content is added after instantiation via object
methods:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: precipitation_flux&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;DimensionCoordinate:  &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]))</span>
<span class="go">&lt;DimensionCoordinate: long_name:Longitude(3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: (3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux status_flag&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: precipitation_flux status_flag(3) &gt;</span>
</pre></div>
</div>
<p>For stage <strong>3</strong>, the field construct has the following methods for
setting metadata constructs and mapping data array dimensions to
domain axis constructs:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method for setting a metadata construct</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.set_domain_axis.html#cfdm.Field.set_domain_axis" title="cfdm.Field.set_domain_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_domain_axis</span></code></a></td>
<td>Set a domain axis construct</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.set_cell_method.html#cfdm.Field.set_cell_method" title="cfdm.Field.set_cell_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_cell_method</span></code></a></td>
<td>Set a cell method construct</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.set_field_ancillary.html#cfdm.Field.set_field_ancillary" title="cfdm.Field.set_field_ancillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_field_ancillary</span></code></a></td>
<td>Set a field ancillary construct and the axes spanned by its data</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.set_auxiliary_coordinate.html#cfdm.Field.set_auxiliary_coordinate" title="cfdm.Field.set_auxiliary_coordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_auxiliary_coordinate</span></code></a></td>
<td>Set an auxiliary coordinate construct and the axes spanned by its data</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.set_cell_measure.html#cfdm.Field.set_cell_measure" title="cfdm.Field.set_cell_measure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_cell_measure</span></code></a></td>
<td>Set an cell measure construct and the axes spanned by its data</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.set_dimension_coordinate.html#cfdm.Field.set_dimension_coordinate" title="cfdm.Field.set_dimension_coordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_dimension_coordinate</span></code></a></td>
<td>Set a dimension coordinate construct and the axes spanned by its data</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="method/cfdm.Field.set_domain_ancillary.html#cfdm.Field.set_domain_ancillary" title="cfdm.Field.set_domain_ancillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_domain_ancillary</span></code></a></td>
<td>Set a domain ancillary and the axes spanned by its data</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="method/cfdm.Field.set_coordinate_reference.html#cfdm.Field.set_coordinate_reference" title="cfdm.Field.set_coordinate_reference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_coordinate_reference</span></code></a></td>
<td>Set a coordinate reference construct</td>
</tr>
</tbody>
</table>
<p>These methods all return the construct identifier for the metadata
construct which can be used when other metadata constructs are added
to the field (e.g. to specify which domain axis constructs correspond
to a data array), or when other metadata constructs are created
(e.g. to identify the domain ancillary constructs forming part of a
coordinate reference construct):</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_axis</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_axis</span>
<span class="go">&#39;domainaxis0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cid</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_dimension_coordinate</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">longitude_axis</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cid</span>
<span class="go">&#39;dimensioncoordinate0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">longitude_axis</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;minimum&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">set_cell_method</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="go">&#39;cellmethod0&#39;</span>
</pre></div>
</div>
<p>In general, the order in which metadata constructs are added to the
field does not matter, except when one metadata construct is required
by another, in which case the former must be added to the field first
so that its construct identifier is available to the latter.</p>
<p>One other restriction is that cell method constructs must be set in
the relative order in which their methods were applied to the data.</p>
<p>The domain axis constructs spanned by a metadata construct’s data may
be changed after insertion with the <a class="reference internal" href="method/cfdm.Field.set_construct_axes.html#cfdm.Field.set_construct_axes" title="cfdm.Field.set_construct_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_construct_axes</span></code></a> method
of the field construct.</p>
<p>The following code creates a field construct with properties; data;
and domain axis, cell method and dimension coordinate metadata
constructs (data arrays have been generated with dummy values using
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html#numpy.arange" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.arange</span></code></a>):</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Initialise the field with properties</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;specific_humidity&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axes</span>
<span class="n">domain_axisT</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">domain_axisY</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">domain_axisX</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Insert the domain axes into the field. The set_domain_axis method</span>
<span class="c1"># returns the domain axis construct identifier that will be used</span>
<span class="c1"># later to specify which domain axis corresponds to which dimension</span>
<span class="c1"># coordinate construct.</span>
<span class="n">axisT</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">domain_axisT</span><span class="p">)</span>
<span class="n">axisY</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">domain_axisY</span><span class="p">)</span>
<span class="n">axisX</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">domain_axisX</span><span class="p">)</span>

<span class="c1"># Field data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">40.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axisY</span><span class="p">,</span> <span class="n">axisX</span><span class="p">])</span>

<span class="c1"># Create the cell methods</span>
<span class="n">cell_method1</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">],</span> <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>

<span class="n">cell_method2</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">()</span>
<span class="n">cell_method2</span><span class="o">.</span><span class="n">set_axes</span><span class="p">([</span><span class="n">axisT</span><span class="p">])</span>
<span class="n">cell_method2</span><span class="o">.</span><span class="n">properties</span><span class="p">({</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;maximum&#39;</span><span class="p">})</span>

<span class="c1"># Insert the cell methods into the field</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_cell_method</span><span class="p">(</span><span class="n">cell_method1</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_cell_method</span><span class="p">(</span><span class="n">cell_method2</span><span class="p">)</span>

<span class="c1"># Create the dimension Coordinates</span>
<span class="n">dimT</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
         <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days since 2018-12-01&#39;</span><span class="p">},</span>
         <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">15.5</span><span class="p">]),</span>
         <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mf">31.</span><span class="p">]])))</span>

<span class="n">dimY</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">})</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>
<span class="n">bounds_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">bounds_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="n">bounds_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">bounds_array</span><span class="p">))</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

<span class="n">dimX</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">8.</span><span class="p">)))</span>
<span class="n">dimX</span><span class="o">.</span><span class="n">properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">})</span>

<span class="c1"># Insert the dimension coordinates into the field, specifying to</span>
<span class="c1"># which domain axis each one corresponds</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_dimension_coordinate</span><span class="p">(</span><span class="n">dimT</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axisT</span><span class="p">])</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_dimension_coordinate</span><span class="p">(</span><span class="n">dimY</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axisY</span><span class="p">])</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_dimension_coordinate</span><span class="p">(</span><span class="n">dimX</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axisX</span><span class="p">])</span>
</pre></div>
</div>
<p>The new field construct may now be inspected:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">------------------------</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;specific_humidity&#39;</span>
<span class="go">units = &#39;1&#39;</span>

<span class="go">Data(latitude(5), longitude(8)) = [[0.0, ..., 39.0]] 1</span>

<span class="go">Cell Method: area: mean</span>
<span class="go">Cell Method: time(1): maximum</span>

<span class="go">Domain Axis: latitude(5)</span>
<span class="go">Domain Axis: longitude(8)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2018-12-16 12:00:00]</span>
<span class="go">    Bounds:Data(time(1), 2) = [[2018-12-01 00:00:00, 2019-01-01 00:00:00]]</span>

<span class="go">Dimension coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_north&#39;</span>
<span class="go">    Data(latitude(5)) = [0.0, ..., 4.0] degrees_north</span>
<span class="go">    Bounds:Data(latitude(5), 2) = [[-0.5, ..., 4.5]] degrees_north</span>

<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(longitude(8)) = [0.0, ..., 7.0] degrees_east</span>
</pre></div>
</div>
<p>It is not necessary to set the “Conventions” property, because this is
automatically included in output files as a netCDF global
“Conventions” attribute corresponding to the version number of CF
being used, as returned by the <a class="reference internal" href="function/cfdm.CF.html#cfdm.CF" title="cfdm.CF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.CF</span></code></a> function. For example, a CF
version of <code class="docutils literal notranslate"><span class="pre">'1.7'</span></code> will produce a “Conventions” attribute value of
<code class="docutils literal notranslate"><span class="pre">'CF-1.7'</span></code>.</p>
<p>If this field were to be written to a netCDF dataset then, in the
absence of pre-defined names, default netCDF variable and dimension
names would be automatically generated (based on standard names where
they exist). The setting of bespoke names is, however, easily done
with the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>

<span class="n">domain_axisT</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">domain_axisY</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">domain_axisX</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>

<span class="n">dimT</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">dimX</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is a more complete example which creates a field construct that
contains every type of metadata construct (again, data arrays have
been generated with dummy values using <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html#numpy.arange" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.arange</span></code></a>):</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Initialize the field</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>

<span class="c1"># Create and set domain axes</span>
<span class="n">axis_T</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axis_Z</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axis_Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">axis_X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>

<span class="c1"># Set the field data</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
             <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create and set the cell methods</span>
<span class="n">cell_method1</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span>
          <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">],</span>
          <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;where&#39;</span><span class="p">:</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;intervals&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">)]})</span>

<span class="n">cell_method2</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span>
                 <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_T</span><span class="p">],</span>
                 <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;maximum&#39;</span><span class="p">})</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_cell_method</span><span class="p">(</span><span class="n">cell_method1</span><span class="p">)</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_cell_method</span><span class="p">(</span><span class="n">cell_method2</span><span class="p">)</span>

<span class="c1"># Create and set the field ancillaries</span>
<span class="n">field_ancillary</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
             <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">},</span>
             <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_field_ancillary</span><span class="p">(</span><span class="n">field_ancillary</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create and set the dimension coordinates</span>
<span class="n">dimension_coordinate_T</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
                           <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days since 2018-12-01&#39;</span><span class="p">},</span>
                           <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">15.5</span><span class="p">]),</span>
                           <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">31</span><span class="p">]])))</span>

<span class="n">dimension_coordinate_Z</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;computed_standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">},</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">1.5</span><span class="p">]),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])))</span>

<span class="n">dimension_coordinate_Y</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;grid_latitude&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.</span><span class="p">)),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>

<span class="n">dimension_coordinate_X</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;grid_longitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_dimension_coordinate</span><span class="p">(</span><span class="n">dimension_coordinate_T</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_T</span><span class="p">])</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_dimension_coordinate</span><span class="p">(</span><span class="n">dimension_coordinate_Z</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Z</span><span class="p">])</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_dimension_coordinate</span><span class="p">(</span><span class="n">dimension_coordinate_Y</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">])</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_dimension_coordinate</span><span class="p">(</span><span class="n">dimension_coordinate_X</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create and set the auxiliary coordinates</span>
<span class="n">auxiliary_coordinate_lat</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                      <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">},</span>
                      <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">auxiliary_coordinate_lon</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                      <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">},</span>
                      <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdefghij&#39;</span><span class="p">))</span>
<span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="n">auxiliary_coordinate_name</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Grid latitude name&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_auxiliary_coordinate</span><span class="p">(</span><span class="n">auxiliary_coordinate_lat</span><span class="p">,</span>
                             <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_auxiliary_coordinate</span><span class="p">(</span><span class="n">auxiliary_coordinate_lon</span><span class="p">,</span>
                             <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_X</span><span class="p">,</span> <span class="n">axis_Y</span><span class="p">])</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_auxiliary_coordinate</span><span class="p">(</span><span class="n">auxiliary_coordinate_name</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">])</span>

<span class="c1"># Create and set domain ancillaries</span>
<span class="n">domain_ancillary_a</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">10.</span><span class="p">]),</span>
                       <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">]])))</span>

<span class="n">domain_ancillary_b</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">20.</span><span class="p">]),</span>
                       <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">14</span><span class="p">,</span> <span class="mf">26.</span><span class="p">]])))</span>

<span class="n">domain_ancillary_orog</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                          <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;surface_altitude&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                          <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_domain_ancillary</span><span class="p">(</span><span class="n">domain_ancillary_a</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Z</span><span class="p">])</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_domain_ancillary</span><span class="p">(</span><span class="n">domain_ancillary_b</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Z</span><span class="p">])</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_domain_ancillary</span><span class="p">(</span><span class="n">domain_ancillary_orog</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create and set the coordinate references</span>
<span class="n">datum</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Datum</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;earth_radius&#39;</span><span class="p">:</span> <span class="mf">6371007.</span><span class="p">})</span>

<span class="n">coordinate_conversion_h</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateConversion</span><span class="p">(</span>
              <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;grid_mapping_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rotated_latitude_longitude&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;grid_north_pole_latitude&#39;</span><span class="p">:</span> <span class="mf">38.0</span><span class="p">,</span>
                          <span class="s1">&#39;grid_north_pole_longitude&#39;</span><span class="p">:</span> <span class="mf">190.0</span><span class="p">})</span>

<span class="n">horizontal_crs</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateReference</span><span class="p">(</span>
                   <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
                   <span class="n">coordinate_conversion</span><span class="o">=</span><span class="n">coordinate_conversion_h</span><span class="p">,</span>
                   <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">dimension_coordinate_X</span><span class="p">,</span>
                                <span class="n">dimension_coordinate_Y</span><span class="p">,</span>
                                <span class="n">auxiliary_coordinate_lat</span><span class="p">,</span>
                                <span class="n">auxiliary_coordinate_lon</span><span class="p">])</span>

<span class="n">coordinate_conversion_v</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateConversion</span><span class="p">(</span>
         <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;computed_standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">},</span>
         <span class="n">domain_ancillaries</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">domain_ancillary_a</span><span class="p">,</span>
                             <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">domain_ancillary_a</span><span class="p">,</span>
                             <span class="s1">&#39;orog&#39;</span><span class="p">:</span> <span class="n">domain_ancillary_orog</span><span class="p">})</span>

<span class="n">vertical_crs</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateReference</span><span class="p">(</span>
                 <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
                 <span class="n">coordinate_conversion</span><span class="o">=</span><span class="n">coordinate_conversion_v</span><span class="p">,</span>
                 <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">dimension_coordinate_Z</span><span class="p">])</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_coordinate_reference</span><span class="p">(</span><span class="n">horizontal_crs</span><span class="p">)</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_coordinate_reference</span><span class="p">(</span><span class="n">vertical_crs</span><span class="p">)</span>

<span class="c1"># Create and set the cell measures</span>
<span class="n">cell_measure</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMeasure</span><span class="p">(</span><span class="n">measure</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">,</span>
                 <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;km2&#39;</span><span class="p">},</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_cell_measure</span><span class="p">(</span><span class="n">cell_measure</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_X</span><span class="p">,</span> <span class="n">axis_Y</span><span class="p">])</span>
</pre></div>
</div>
<p>The new field construct may now be inspected:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">tas</span><span class="p">)</span>
<span class="go">Field: air_temperature</span>
<span class="go">----------------------</span>
<span class="go">Data            : air_temperature(grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] K</span>
<span class="go">Dimension coords: time(1) = [2018-12-16 12:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] degrees_north</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] degrees_east</span>
<span class="go">                : long_name:Grid latitude name(grid_latitude(10)) = [--, ..., j]</span>
<span class="go">Cell measures   : measure%area(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : domainancillary0(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : domainancillary1(atmosphere_hybrid_height_coordinate(1)) = [20.0] 1</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] m</span>
</pre></div>
</div>
</div>
<div class="section" id="domain">
<span id="id14"></span><h2><strong>Domain</strong><a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The domain of the CF data model describes the locations of the field
construct’s data and is represented by the <a class="reference internal" href="class/cfdm.Domain.html#cfdm.Domain" title="cfdm.Domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Domain</span></code></a> class. The domain
instance may be accessed with the <a class="reference internal" href="method/cfdm.Field.get_domain.html#cfdm.Field.get_domain" title="cfdm.Field.get_domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_domain</span></code></a> method of the
field construct:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span>
<span class="go">&lt;Domain: {1, 1, 9, 10}&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
<span class="go">Dimension coords: atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name:Grid latitude name(grid_latitude(10)) = [--, ..., kappa]</span>
<span class="go">Cell measures   : measure%area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">description</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Changes to domain instance are seen by the field construct, and vice
versa. This is because the domain instance is merely “view” of the
relevant metadata constructs contained in the field construct. The
field construct also has a <a class="reference internal" href="attribute/cfdm.Field.domain.html#cfdm.Field.domain" title="cfdm.Field.domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain</span></code></a> attribute that is an alias
for the <a class="reference internal" href="method/cfdm.Field.get_domain.html#cfdm.Field.get_domain" title="cfdm.Field.get_domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_domain</span></code></a> method, which makes it easier to access
attributes and methods of the domain instance:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;set by domain&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">&#39;set by domain&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;set by field&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">&#39;set by field&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">&#39;set by field&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<div class="section" id="copying">
<span id="id15"></span><h2><strong>Copying</strong><a class="headerlink" href="#copying" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>A field construct may be copied with its <a class="reference internal" href="method/cfdm.Field.copy.html#cfdm.Field.copy" title="cfdm.Field.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a> method. This
produces a deep copy, i.e. the new field construct is completely
independent of the original field.</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">del_construct</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;DimensionCoordinate: grid_latitude(10) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;}</span>
</pre></div>
</div>
<p>Equivalently, the <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy.deepcopy</span></code></a> function may be used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">copy</span>
<span class="go">   &gt;&gt;&gt; u = copy.deepcopy(t)</span>
</pre></div>
</div>
<p>Metadata constructs may be copied individually in the same manner:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt><em>Note on performance</em></dt>
<dd><a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instances within the field are copied with a <a class="reference external" href="https://en.wikipedia.org/wiki/Copy-on-write">copy-on-write</a> technique. This
means that a copy of a field takes up very little extra memory, even
when the original field construct contains very large data arrays,
and the copy operation is fast.</dd>
</dl>
</div>
<div class="section" id="equality">
<span id="id16"></span><h2><strong>Equality</strong><a class="headerlink" href="#equality" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Whether or not two field constructs are the same is tested with either
field construct’s <a class="reference internal" href="method/cfdm.Field.equals.html#cfdm.Field.equals" title="cfdm.Field.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a> method.</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">traceback</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Field: Different units: &#39;K&#39;, &#39;1&#39;</span>
<span class="go">Field: Different properties</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Equality is strict by default. This means that for two field
constructs to be considered equal they must have corresponding
metadata constructs and for each pair of constructs:</p>
<ul class="simple">
<li>the descriptive properties must be the same (with the exception of
the field construct’s “Conventions” property, which is never
checked), and</li>
<li>if there are data arrays then they must have same shape, data type
and be element-wise equal.</li>
</ul>
<p>Two numerical data elements <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are considered
equal if <span class="math notranslate nohighlight">\(|a - b| \le atol + rtol|b|\)</span>, where <span class="math notranslate nohighlight">\(atol\)</span> (the
tolerance on absolute differences) and <span class="math notranslate nohighlight">\(rtol\)</span> (the tolerance on
relative differences) are positive, typically very small numbers. By
default both are set to the system epsilon (the difference between 1
and the least value greater than 1 that is representable as a
float). Their values may be inspected and changed with the <a class="reference internal" href="function/cfdm.ATOL.html#cfdm.ATOL" title="cfdm.ATOL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.ATOL</span></code></a>
and <a class="reference internal" href="function/cfdm.RTOL.html#cfdm.RTOL" title="cfdm.RTOL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.RTOL</span></code></a> functions:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">ATOL</span><span class="p">()</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">()</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">()</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">RTOL</span><span class="p">()</span>
<span class="go">2.220446049250313e-16</span>
</pre></div>
</div>
<p>NetCDF elements, such as netCDF variable and dimension names, do not
constitute part of the CF data model and so are not checked on any
construct.</p>
<p>The <a class="reference internal" href="method/cfdm.Field.equals.html#cfdm.Field.equals" title="cfdm.Field.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a> method has optional parameters for modifying the
criteria for considering two fields to be equal:</p>
<ul class="simple">
<li>named properties may be omitted from the comparison,</li>
<li>the missing data value may be ignored,</li>
<li>the data type of arrays may be ignored (i.e. arrays with different
data types but equal elements will be accepted as being the same),
and</li>
<li>the tolerances on absolute and relative differences for numerical
comparisons may be temporarily changed, without changing the default
settings.</li>
</ul>
</div>
<div class="section" id="external-variables">
<span id="id17"></span><h2><strong>External variables</strong><a class="headerlink" href="#external-variables" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p><a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#external-variables">External variables</a> are those referred to in a netCDF dataset, but
which are not present in it. Instead, such variables are stored in
other netCDF files known as “external files”. External variables may,
however, be incorporated into the field constructs of the dataset, as
if they had actually been stored in the same file, simply by providing
the external file names to the <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function.</p>
<p>This is illustrated with the files <strong>parent.nc</strong> (<a class="reference download internal" href="_downloads/parent.nc" download=""><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 2kB) and <strong>external.nc</strong>
(<a class="reference download internal" href="_downloads/external.nc" download=""><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 1kB) <a class="footnote-reference" href="#files" id="id18">[1]</a>:</p>
<div class="code bash highlight-python notranslate"><div class="highlight"><pre><span></span>$ ncdump -h parent.nc
netcdf parent {
dimensions:
     latitude = 10 ;
     longitude = 9 ;
variables:
     double latitude(latitude) ;
             latitude:units = &quot;degrees_north&quot; ;
             latitude:standard_name = &quot;latitude&quot; ;
     double longitude(longitude) ;
             longitude:units = &quot;degrees_east&quot; ;
             longitude:standard_name = &quot;longitude&quot; ;
     double eastward_wind(latitude, longitude) ;
             eastward_wind:units = &quot;m s-1&quot; ;
             eastward_wind:standard_name = &quot;eastward_wind&quot; ;
             eastward_wind:cell_measures = &quot;area: areacella&quot; ;

// global attributes:
             :Conventions = &quot;CF-1.7&quot; ;
             :external_variables = &quot;areacella&quot; ;
}

$ ncdump -h external.nc
netcdf external {
dimensions:
     latitude = 10 ;
     longitude = 9 ;
variables:
     double areacella(longitude, latitude) ;
             areacella:units = &quot;m2&quot; ;
             areacella:standard_name = &quot;cell_area&quot; ;

// global attributes:
             :Conventions = &quot;CF-1.7&quot; ;
}
</pre></div>
</div>
<p>The dataset in <strong>parent.nc</strong> may be read <em>without</em> specifying the
external file <strong>external.nc</strong>. In this case a cell measure construct
is still created, but one without any metadata or data:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;parent.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Cell measures   : measure%area (external variable: ncvar%areacella)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;measure%area&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CellMeasure: measure%area &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_external</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;areacella&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If this field construct were to be written to disk using <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a>,
then the output file would be identical to the original <strong>parent.nc</strong>
file, i.e. the netCDF variable name of the cell measure construct
(“areacella”) would be listed by the “external_variables” global
attribute.</p>
<p>However, the dataset may also be read <em>with</em> the external file. In
this case a cell measure construct is created with all of the metadata
and data from the external file, as if the netCDF cell measure
variable had been present in the parent dataset:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;parent.nc&#39;</span><span class="p">,</span> <span class="n">external_files</span><span class="o">=</span><span class="s1">&#39;external.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Cell measures   : cell_area(longitude(9), latitude(10)) = [[100000.5, ..., 100089.5]] m2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;cell_area&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CellMeasure: cell_area(9, 10) m2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_external</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;areacella&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;cell_area&#39;, &#39;units&#39;: &#39;m2&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="go">&lt;Data(9, 10): [[100000.5, ..., 100089.5]] m2&gt;</span>
</pre></div>
</div>
<p>If this field construct were to be written to disk using <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a>
then by default the cell measure construct, with all of its metadata
and data, would be written to the named output file, along with all of
the other constructs. There would be no “external_variables” global
attribute.</p>
<p>In order to write a metadata construct to an external file, and refer
to it with the “external_variables” global attribute in the parent
output file, simply set the status of the cell measure construct to
“external” with its <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_external</span></code> method, and provide an
external file name to the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_external</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;new_parent.nc&#39;</span><span class="p">,</span> <span class="n">external_file</span><span class="o">=</span><span class="s1">&#39;new_external.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="compression">
<span id="id19"></span><h2><strong>Compression</strong><a class="headerlink" href="#compression" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>The CF conventions have support for space saving by identifying
unwanted missing data.  Such compression techniques store the data
more efficiently and result in no precision loss. The CF data model,
however, views arrays that are compressed in their uncompressed
form.</p>
<p>Therefore, the field construct contains domain axis constructs for the
compressed dimensions and presents a view of compressed data in its
uncompressed form, even though their “underlying” arrays (i.e. the
arrays contained in <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instances) are compressed. This means that
the cfdm package includes the algorithms that are required to
uncompress each type of compressed array.</p>
<p>There are two basic types of compression supported by the CF
conventions: <a class="reference internal" href="#dsg"><span class="std std-ref">discrete sampling geometry ragged array
representations</span></a> and <a class="reference internal" href="#gathering"><span class="std std-ref">compression by gathering</span></a>, each of which has particular implementation details, but
the following access patterns and behaviours apply to all:</p>
<ul class="simple">
<li>Accessing the data by a call to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_array</span></code> method of a field
or metadata construct returns a numpy array that is
uncompressed. The underlying array will, however, remain in its
compressed form. The underlying compressed array may be retrieved as
a numpy array with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_compressed_array</span></code> method of the
<a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</li>
</ul>
<ul class="simple">
<li>A <a class="reference internal" href="#subspacing"><span class="std std-ref">subspace</span></a> of a field construct is created with
indices of the uncompressed form of the data. The new subspace will
no longer be compressed, i.e. its underlying arrays will be
uncompressed, but the original data will remain compressed. It
follows that to uncompress all of the data in a field construct,
index the field construct with <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Ellipsis</span></code></a>.</li>
</ul>
<ul class="simple">
<li>If data elements are modified by <a class="reference internal" href="#data-assignment"><span class="std std-ref">assigning</span></a>
to indices of the uncompressed form of the data, then the underlying
compressed array is replaced by its uncompressed form.</li>
</ul>
<ul class="simple">
<li>If an underlying array is compressed at the time of writing to disk
with the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function, then it is written to the file as a
compressed array, along with the supplementary netCDF variables and
attributes that are required for the encoding. This means that if a
dataset using compression is read from disk then it will be written
back to disk with the same compression, unless data elements have
been modified by assignment. Any compressed arrays that have been
modified will be written to an output dataset as uncompressed
arrays.</li>
</ul>
<p>Examples of all of the above may be found in the sections on
<a class="reference internal" href="#dsg"><span class="std std-ref">discrete sampling geometries</span></a> and <a class="reference internal" href="#gathering"><span class="std std-ref">gathering</span></a>.</p>
</div>
<div class="section" id="discrete-sampling-geometries">
<span id="dsg"></span><h2><strong>Discrete sampling geometries</strong><a class="headerlink" href="#discrete-sampling-geometries" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p><a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#discrete-sampling-geometries">Discrete sampling geometry (DSG)</a> features may be compressed by
combining them using one of three ragged array representations:
<a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#_contiguous_ragged_array_representation">contiguous</a>, <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#_indexed_ragged_array_representation">indexed</a> or <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#_ragged_array_representation_of_time_series_profiles">indexed contiguous</a>.</p>
<p>The count variable that is required to uncompress a contiguous, or
indexed contiguous, ragged array is stored in a <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a> instance and
is accessed with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_count_variable</span></code> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a>
instance.</p>
<p>The index variable that is required to uncompress an indexed, or
indexed contiguous, ragged array is stored in an <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a> instance and
is accessed with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_index_variable</span></code> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a>
instance.</p>
<p>The contiguous case is is illustrated with the file <strong>contiguous.nc</strong>
(<a class="reference download internal" href="_downloads/contiguous.nc" download=""><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 2kB) <a class="footnote-reference" href="#files" id="id20">[1]</a>:</p>
<div class="code bash highlight-python notranslate"><div class="highlight"><pre><span></span>$ ncdump -h contiguous.nc
dimensions:
     station = 4 ;
     obs = 24 ;
     strlen8 = 8 ;
variables:
     int row_size(station) ;
             row_size:long_name = &quot;number of observations for this station&quot; ;
             row_size:sample_dimension = &quot;obs&quot; ;
     double time(obs) ;
             time:units = &quot;days since 1970-01-01 00:00:00&quot; ;
             time:standard_name = &quot;time&quot; ;
     double lat(station) ;
             lat:units = &quot;degrees_north&quot; ;
             lat:standard_name = &quot;latitude&quot; ;
     double lon(station) ;
             lon:units = &quot;degrees_east&quot; ;
             lon:standard_name = &quot;longitude&quot; ;
     double alt(station) ;
             alt:units = &quot;m&quot; ;
             alt:positive = &quot;up&quot; ;
             alt:standard_name = &quot;height&quot; ;
             alt:axis = &quot;Z&quot; ;
     char station_name(station, strlen8) ;
             station_name:long_name = &quot;station name&quot; ;
             station_name:cf_role = &quot;timeseries_id&quot; ;
     double humidity(obs) ;
             humidity:standard_name = &quot;specific_humidity&quot; ;
             humidity:coordinates = &quot;time lat lon alt station_name&quot; ;
             humidity:_FillValue = -999.9 ;

// global attributes:
             :Conventions = &quot;CF-1.7&quot; ;
             :featureType = &quot;timeSeries&quot; ;
}
</pre></div>
</div>
<p>Reading and inspecting this file shows the data presented in
two-dimensional uncompressed form, whilst the underlying array is
still in the one-dimension ragged representation described in the
file:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;contiguous.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(ncdim%station(4), ncdim%timeseries(9))</span>
<span class="go">Dimension coords:</span>
<span class="go">Auxiliary coords: time(ncdim%station(4), ncdim%timeseries(9)) = [[1969-12-29 00:00:00, ..., 1970-01-07 00:00:00]]</span>
<span class="go">                : latitude(ncdim%station(4)) = [-9.0, ..., 78.0] degrees_north</span>
<span class="go">                : longitude(ncdim%station(4)) = [-23.0, ..., 178.0] degrees_east</span>
<span class="go">                : height(ncdim%station(4)) = [0.5, ..., 345.0] m</span>
<span class="go">                : cf_role:timeseries_id(ncdim%station(4)) = [station1, ..., station4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[0.12 0.05 0.18   --   --   --   --   --   --]</span>
<span class="go"> [0.05 0.11 0.2  0.15 0.08 0.04 0.06   --   --]</span>
<span class="go"> [0.15 0.19 0.15 0.17 0.07   --   --   --   --]</span>
<span class="go"> [0.11 0.03 0.14 0.16 0.02 0.09 0.1  0.04 0.11]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compressed_array</span><span class="p">())</span>
<span class="go">[0.12 0.05 0.18 0.05 0.11 0.2 0.15 0.08 0.04 0.06 0.15 0.19 0.15 0.17 0.07</span>
<span class="go"> 0.11 0.03 0.14 0.16 0.02 0.09 0.1 0.04 0.11]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_count_variable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span>
<span class="go">&lt;Count: long_name:number of observations for this station(4) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">count_variable</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[3 7 5 9]</span>
</pre></div>
</div>
<p>We can easily select the timeseries for the second station by indexing
the “station” axis of the field construct:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">station</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">station</span>
<span class="go">&lt;Field: specific_humidity(ncdim%station(1), ncdim%timeseries(9))&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">station</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[0.05 0.11 0.2 0.15 0.08 0.04 0.06 -- --]]</span>
</pre></div>
</div>
<p>The underlying array of original data remains in compressed form until
data array elements are modified:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[0.12 0.05 0.18   --   --   --   --   --   --]</span>
<span class="go"> [0.05 0.11 -9.0 0.15 0.08 0.04 0.06   --   --]</span>
<span class="go"> [0.15 0.19 0.15 0.17 0.07   --   --   --   --]</span>
<span class="go"> [0.11 0.03 0.14 0.16 0.02 0.09 0.1  0.04 0.11]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<p>A construct with an underlying ragged array is created by initialising
a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance with a ragged array that is stored in one of three
special array objects: <a class="reference internal" href="class/cfdm.RaggedContiguousArray.html#cfdm.RaggedContiguousArray" title="cfdm.RaggedContiguousArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedContiguousArray</span></code></a>, <a class="reference internal" href="class/cfdm.RaggedIndexedArray.html#cfdm.RaggedIndexedArray" title="cfdm.RaggedIndexedArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedIndexedArray</span></code></a>
or <a class="reference internal" href="class/cfdm.RaggedIndexedContiguousArray.html#cfdm.RaggedIndexedContiguousArray" title="cfdm.RaggedIndexedContiguousArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedIndexedContiguousArray</span></code></a>. The following code creates a simple
field construct with an underlying contiguous ragged array:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Define the ragged array values</span>
<span class="n">ragged_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mf">282.5</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">279</span><span class="p">,</span> <span class="mi">278</span><span class="p">,</span> <span class="mf">279.5</span><span class="p">],</span>
                           <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="c1"># Define the count array values</span>
<span class="n">count_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="c1"># Create the count variable</span>
<span class="n">count_variable</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">count_array</span><span class="p">))</span>
<span class="n">count_variable</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;number of obs for this timeseries&#39;</span><span class="p">)</span>

<span class="c1"># Create the contiguous ragged array object</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">RaggedContiguousArray</span><span class="p">(</span>
                 <span class="n">compressed_array</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">NumpyArray</span><span class="p">(</span><span class="n">ragged_array</span><span class="p">),</span>
                 <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">count_variable</span><span class="o">=</span><span class="n">count_variable</span><span class="p">)</span>

<span class="c1"># Create the field construct with the domain axes and the ragged</span>
<span class="c1"># array</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="n">tas</span><span class="o">.</span><span class="n">properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>
                <span class="s1">&#39;featureType&#39;</span><span class="p">:</span> <span class="s1">&#39;timeSeries&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs for the uncompressed array</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">])</span>
</pre></div>
</div>
<p>We can now inspect the new field construct…</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tas</span>
<span class="go">&lt;Field: air_temperature(cid%domainaxis1(2), cid%domainaxis0(4)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">tas</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[280.0 282.5    --    --]</span>
<span class="go"> [281.0 279.0 278.0 279.5]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tas</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">tas</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compressed_array</span><span class="p">())</span>
<span class="go">[280.  282.5 281.  279.  278.  279.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_count_variable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span>
<span class="go">&lt;Count: long_name:number of obs for this timeseries(2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">count_variable</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[2 4]</span>
</pre></div>
</div>
<p>…write it to a netCDF file…</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tas</span><span class="p">,</span> <span class="s1">&#39;tas_contiguous.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>…and inspect the file:</p>
<div class="code bash highlight-python notranslate"><div class="highlight"><pre><span></span>$ ncdump tas_contiguous.nc
netcdf tas_contiguous {
dimensions:
     dim = 2 ;
     element = 6 ;
variables:
     int64 count(dim) ;
             count:long_name = &quot;number of obs for this timeseries&quot; ;
             count:sample_dimension = &quot;element&quot; ;
     float air_temperature(element) ;
             air_temperature:units = &quot;K&quot; ;
             air_temperature:standard_name = &quot;air_temperature&quot; ;

// global attributes:
             :Conventions = &quot;CF-1.7&quot; ;
             :featureType = &quot;timeSeries&quot; ;
data:

 count = 2, 4 ;

 air_temperature = 280, 282.5, 281, 279, 278, 279.5 ;
}
</pre></div>
</div>
</div>
<div class="section" id="gathering">
<span id="id21"></span><h2><strong>Gathering</strong><a class="headerlink" href="#gathering" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p><a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#compression-by-gathering">Compression by gathering</a> combines axes of a multidimensional array
into a new, discrete axis whilst omitting the missing values and thus
reducing the number of values that need to be stored.</p>
<p>The list variable that is required to uncompress a gathered array is
stored in a <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a> object and is retrieved with the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">get_list_variable</span></code> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<p>This is illustrated with the file <strong>gathered.nc</strong> (<a class="reference download internal" href="_downloads/gathered.nc" download=""><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 1kB) <a class="footnote-reference" href="#files" id="id22">[1]</a>:</p>
<div class="code bash highlight-python notranslate"><div class="highlight"><pre><span></span>$ ncdump -h gathered.nc
netcdf gathered {
dimensions:
     time = 2 ;
     lat = 4 ;
     lon = 5 ;
     landpoint = 7 ;
variables:
     double time(time) ;
             time:standard_name = &quot;time&quot; ;
             time:units = &quot;days since 2000-1-1&quot; ;
     double lat(lat) ;
             lat:standard_name = &quot;latitude&quot; ;
             lat:units = &quot;degrees_north&quot; ;
     double lon(lon) ;
             lon:standard_name = &quot;longitude&quot; ;
             lon:units = &quot;degrees_east&quot; ;
     int landpoint(landpoint) ;
             landpoint:compress = &quot;lat lon&quot; ;
     double pr(time, landpoint) ;
             pr:standard_name = &quot;precipitation_flux&quot; ;
             pr:units = &quot;kg m2 s-1&quot; ;

// global attributes:
             :Conventions = &quot;CF-1.7&quot; ;
}
</pre></div>
</div>
<p>Reading and inspecting this file shows the data presented in
three-dimensional uncompressed form, whilst the underlying array is
still in the two-dimensional gathered representation described in the
file:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;gathered.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">Field: precipitation_flux (ncvar%pr)</span>
<span class="go">------------------------------------</span>
<span class="go">Data            : precipitation_flux(time(2), latitude(4), longitude(5)) kg m2 s-1</span>
<span class="go">Dimension coords: time(2) = [2000-02-01 00:00:00, 2000-03-01 00:00:00]</span>
<span class="go">                : latitude(4) = [-90.0, ..., -75.0] degrees_north</span>
<span class="go">                : longitude(5) = [0.0, ..., 40.0] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[[--       0.000122 0.0008   --       --      ]</span>
<span class="go">  [0.000177 --       0.000175 0.00058  --      ]</span>
<span class="go">  [--       --       --       --       --      ]</span>
<span class="go">  [--       0.000206 --       0.0007   --      ]]</span>

<span class="go"> [[--       0.000202 0.000174 --       --      ]</span>
<span class="go">  [0.00084  --       0.000201 0.0057   --      ]</span>
<span class="go">  [--       --       --       --       --      ]</span>
<span class="go">  [--       0.000223 --       0.000102 --      ]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compressed_array</span><span class="p">())</span>
<span class="go">[[0.000122 0.0008   0.000177 0.000175 0.00058 0.000206 0.0007  ]</span>
<span class="go"> [0.000202 0.000174 0.00084  0.000201 0.0057  0.000223 0.000102]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_list_variable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span>
<span class="go">&lt;List: ncvar%landpoint(7) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_variable</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[1 2 5 7 8 16 18]</span>
</pre></div>
</div>
<p>We can easily create subspaces based on the uncompressed axes of the
field construct:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Field: precipitation_flux(time(1), latitude(4), longitude(5)) kg m2 s-1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">&lt;Field: precipitation_flux(time(1), latitude(4), longitude(2)) kg m2 s-1&gt;</span>
</pre></div>
</div>
<p>The underlying array of original data remains in compressed form until
data array elements are modified:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<p>A construct with an underlying gathered array is created by
initializing a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance with a gathered array that is stored in
the special <a class="reference internal" href="class/cfdm.GatheredArray.html#cfdm.GatheredArray" title="cfdm.GatheredArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GatheredArray</span></code></a> array object. The following code creates a
simple field construct with an underlying gathered array:</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Define the gathered values</span>
<span class="n">gathered_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">280</span><span class="p">,</span> <span class="mf">282.5</span><span class="p">,</span> <span class="mi">281</span><span class="p">],</span> <span class="p">[</span><span class="mi">279</span><span class="p">,</span> <span class="mi">278</span><span class="p">,</span> <span class="mf">277.5</span><span class="p">]],</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="c1"># Define the list array values</span>
<span class="n">list_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Create the list variable</span>
<span class="n">list_variable</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">list_array</span><span class="p">))</span>

<span class="c1"># Create the gathered array object</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">GatheredArray</span><span class="p">(</span>
                 <span class="n">compressed_array</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">NumpyArray</span><span class="p">(</span><span class="n">gathered_array</span><span class="p">),</span>
                 <span class="n">compressed_dimension</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                 <span class="n">list_variable</span><span class="o">=</span><span class="n">list_variable</span><span class="p">)</span>

<span class="c1"># Create the field construct with the domain axes and the gathered</span>
<span class="c1"># array</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs for the uncompressed array</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_domain_axis</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">])</span>
</pre></div>
</div>
<p>Note that, because compression by gathering acts on a subset of the
array dimensions, it is necessary to state the position of the
compressed dimension in the compressed array (with the
<em>compressed_dimension</em> parameter of the <a class="reference internal" href="class/cfdm.GatheredArray.html#cfdm.GatheredArray" title="cfdm.GatheredArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GatheredArray</span></code></a>
initialisation).</p>
<p>We can now inspect the new field construct…</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tas</span>
<span class="go">&lt;Field: air_temperature(cid%domainaxis0(2), cid%domainaxis1(3), cid%domainaxis2(2)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">tas</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[[[--    280.0]</span>
<span class="go">  [--    --   ]</span>
<span class="go">  [282.5 281.0]]</span>

<span class="go"> [[--    279.0]</span>
<span class="go">  [--    --   ]</span>
<span class="go">  [278.0 277.5]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tas</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">tas</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compressed_array</span><span class="p">())</span>
<span class="go">[[ 280.   282.5  281. ]</span>
<span class="go"> [ 279.   278.   277.5]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_list_variable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span>
<span class="go">&lt;List: (3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_variable</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
<span class="go">[1 4 5]</span>
</pre></div>
</div>
<p>…write it to a netCDF file…</p>
<div class="code python highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tas</span><span class="p">,</span> <span class="s1">&#39;tas_gathered.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>…and inspect the file:</p>
<div class="code bash highlight-python notranslate"><div class="highlight"><pre><span></span>$ ncdump tas_gathered.nc
netcdf tas_gathered {
dimensions:
     dim = 2 ;
     dim_1 = 3 ;
     dim_2 = 2 ;
     list = 3 ;
variables:
     int64 list(list) ;
             list:compress = &quot;dim_1 dim_2&quot; ;
     float air_temperature(dim, list) ;
             air_temperature:units = &quot;K&quot; ;
             air_temperature:standard_name = &quot;air_temperature&quot; ;

// global attributes:
             :Conventions = &quot;CF-1.7&quot; ;
data:

 list = 1, 4, 5 ;

 air_temperature =
  280, 282.5, 281,
  279, 278, 277.5 ;
}
</pre></div>
</div>
<hr class="docutils" />
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="files" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id6">2</a>, <a class="fn-backref" href="#id18">3</a>, <a class="fn-backref" href="#id20">4</a>, <a class="fn-backref" href="#id22">5</a>)</em> The tutorial files may be also found in the
<a class="reference external" href="https://github.com/NCAS-CMS/cfdm/tree/master/docs/_downloads">docs/_downloads</a>
directory of the code repository.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="opendap2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>Requires the netCDF4 python package to have been built
with OPeNDAP support enabled. See
<a class="reference external" href="http://unidata.github.io/netcdf4-python">http://unidata.github.io/netcdf4-python</a> for details.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="language" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td>In the terminology of the CF data model, a “construct”
is an abstract concept which is distinct from its
realization, e.g. a <a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a> instance is not, strictly
speaking, a field construct. However, the distinction
is moot and the descriptive language used in this
tutorial is greatly simplified by allowing the term
“construct” to mean “class instance” (e.g. “field
construct” means “<a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a> instance”), and this
convention is applied throughout this tutorial. The
phrase “CF data model construct” is used on the few
occasions when the original abstract meaning is
intended.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, David Hassell.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/tutorial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>