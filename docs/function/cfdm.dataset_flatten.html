<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cfdm.dataset_flatten &#8212; Documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=a5d0ad34" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/customise-alabaster.css?v=056948bf" />
    <script src="../_static/documentation_options.js?v=b5e78ec1"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=a56c686a"></script>
    <script src="../_static/toggleprompt.js?v=1b41717f"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cfdm.netcdf_indexer" href="cfdm.netcdf_indexer.html" />
    <link rel="prev" title="cfdm.write" href="cfdm.write.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">



<h1 class="logo"><a href="../index.html">cfdm 1.13.0.0</a></h1>



<p class="blurb">A Python reference implementation of the CF data model</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NCAS-CMS&repo=cfdm&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../cf_data_model.html"><strong>CF data model</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html"><strong>Contributing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html"><strong>Tutorial</strong></a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_reference.html"><strong>API reference</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../philosophy.html"><strong>Philosophy</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html"><strong>Performance</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions.html"><strong>Extensions</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html"><strong>Releases</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Changelog.html"><strong>Change log</strong></a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api_reference.html"><strong>API reference</strong></a><ul>
  <li><a href="../functions.html"><strong>cfdm functions</strong></a><ul>
      <li>Previous: <a href="cfdm.write.html" title="previous chapter">cfdm.write</a></li>
      <li>Next: <a href="cfdm.netcdf_indexer.html" title="next chapter">cfdm.netcdf_indexer</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>

<br>
cfdm development has been supported by
the <a href="https://erc.europa.eu/">ERC</a>
through <a href="https://cordis.europa.eu/project/id/786427">Couplet</a>;
by the <a href="https://ec.europa.eu/programmes/horizon2020/">EC
Horizon 2020 programme</a> through
<a href="https://cordis.europa.eu/project/id/824084">IS-ENES3</a>;
by <a href="https://nerc.ukri.org/">NERC</a> through
<a href="https://gtr.ukri.org/project/0D95A6DB-0B95-48F7-8A8B-7B9A47DEA117">UKFAFMIP</a>;
and by <a href="https://ncas.ac.uk/">NCAS</a>.
<br>
<br>
<img src="../_templates/logo_EC.png" height="40">
<img src="../_templates/logo_ERC.png" height="40">
<img src="../_templates/logo_NERC.png" height="40">
<br>
<img src="../_templates/logo_NCAS.png" height="40">
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            


  <section id="cfdm-dataset-flatten">
<h1>cfdm.dataset_flatten<a class="headerlink" href="#cfdm-dataset-flatten" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="cfdm.dataset_flatten">
<span class="sig-prename descclassname"><span class="pre">cfdm.</span></span><span class="sig-name descname"><span class="pre">dataset_flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_dimension_search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'closest_ancestor'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NCAS-CMS/cfdm/blob/v1.13.0.0/cfdm/read_write/netcdf/flatten/flatten.py#L48-L178"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cfdm.dataset_flatten" title="Link to this definition">¶</a></dt>
<dd><p>Create a flattened version of a grouped CF dataset.</p>
<p>The following dataset formats can be flattened: netCDF and Zarr.</p>
<p><strong>CF coordinate variables</strong></p>
<p>When a CF coordinate variable (i.e. a one-dimensional variable
with the same name as its dimension) in the input dataset is in a
different group to its corresponding dimension, the same variable
in the output flattened dataset will no longer be a CF coordinate
variable, as its name will be prefixed with a different group
identifier than its dimension.</p>
<p>In such cases it is up to the user to apply the proximal and
lateral search algorithms to the flattened dataset returned by
<a class="reference internal" href="#cfdm.dataset_flatten" title="cfdm.dataset_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dataset_flatten</span></code></a>, in conjunction with the mappings defined in the
newly created global attributes <code class="docutils literal notranslate"><span class="pre">_flattener_variable_map</span></code> and
<code class="docutils literal notranslate"><span class="pre">_flattener_dimension_map</span></code>, to find which variables are acting
as CF coordinate variables in the flattened dataset. See CF
conventions section 2.7 Groups for details.</p>
<p>For example, if an input dataset has dimension <code class="docutils literal notranslate"><span class="pre">lat</span></code> in the root
group and coordinate variable <code class="docutils literal notranslate"><span class="pre">lat(lat)</span></code> in group <code class="docutils literal notranslate"><span class="pre">/group1</span></code>,
then the flattened dataset will contain dimension <code class="docutils literal notranslate"><span class="pre">lat</span></code> and
variable <code class="docutils literal notranslate"><span class="pre">group1__lat(lat)</span></code>, both in its root group. In this
case, the <code class="docutils literal notranslate"><span class="pre">_flattener_variable_map</span></code> global attribute of the
flattened dataset will contain the mapping <code class="docutils literal notranslate"><span class="pre">'group1__lat:</span>
<span class="pre">/group1/lat'</span></code>, and the <code class="docutils literal notranslate"><span class="pre">_flattener_dimension_map</span></code> global
attribute will contain the mapping <code class="docutils literal notranslate"><span class="pre">'lat:</span> <span class="pre">/lat'</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version (cfdm): </span>1.11.2.0</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt>input_ds:</dt><dd><p>The dataset to be flattened. Must be an open dataet object
with the same API as <code class="xref py py-obj docutils literal notranslate"><span class="pre">netCDF4.Dataset</span></code>, <a class="reference external" href="https://h5netcdf.org/generated/h5netcdf.File.html#h5netcdf.File" title="(in h5netcdf)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">h5netcdf.File</span></code></a>,
or <a class="reference external" href="https://zarr.readthedocs.io/en/stable/api/zarr/group/#zarr.Group" title="(in zarr-python v0.0.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">zarr.Group</span></code></a>.</p>
</dd>
<dt>output_ds: <code class="xref py py-obj docutils literal notranslate"><span class="pre">netCDF4.Dataset</span></code></dt><dd><p>A container for the flattened dataset that will get
updated in-place with the flattened input dataset.</p>
</dd>
<dt>strict: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional</dt><dd><p>If True, the default, then failing to resolve a reference
raises an exception. If False, a warning is issued and
flattening is continued.</p>
</dd>
<dt>copy_data: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional</dt><dd><p>By default, <em>copy_data</em> is True and all data arrays from
<em>input_ds</em> are copied to <em>output_ds</em>. If False then no
data arrays are copied, instead all variables’ data will
be represented by the fill value, but without having to
actually create these arrays in memory or on disk.</p>
</dd>
<dt>group_dimension_search: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional</dt><dd><p>How to interpret a dimension name that contains no
group-separator characters, such as <code class="docutils literal notranslate"><span class="pre">dim</span></code> (as opposed to
<code class="docutils literal notranslate"><span class="pre">group/dim</span></code>, <code class="docutils literal notranslate"><span class="pre">/group/dim</span></code>, <code class="docutils literal notranslate"><span class="pre">../dim</span></code>, etc.). The
<em>group_dimension_search</em> parameter must be one of:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'closest_ancestor'</span></code></p>
<p>This is the default and is the behaviour defined by the
CF conventions (section 2.7 Groups).</p>
<p>Assume that the sub-group dimension is the same as the
dimension with the same name and size in an ancestor
group, if one exists. If multiple such dimensions exist,
then the correspondence is with the dimension in the
ancestor group that is <strong>closest</strong> to the sub-group
(i.e. that is furthest away from the root group).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'furthest_ancestor'</span></code></p>
<p>This behaviour is different to that defined by the CF
conventions (section 2.7 Groups).</p>
<p>Assume that the sub-group dimension is the same as the
one with the same name and size in an ancestor group, if
one exists. If multiple such dimensions exist, then the
correspondence is with the dimension in the ancestor
group that is <strong>furthest away</strong> from the sub-group
(i.e. that is closest to the root group).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'local'</span></code></p>
<p>This behaviour is different to that defined by the CF
conventions (section 2.7 Groups).</p>
<p>Assume that the sub-group dimension is different to any
with the same name and size in all ancestor groups.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a netCDF dataset, for which it is always
well-defined in which group a dimension is
defined, <em>group_dimension_search</em> may only take
the default value of <code class="docutils literal notranslate"><span class="pre">'closest_ancestor'</span></code>,
which applies the behaviour defined by the CF
conventions (section 2.7 Groups).</p>
<p>For a Zarr dataset, for which there is no means
of indicating whether or not the same dimension
names that appear in different groups correspond
to each other, setting this parameter may be
necessary for the correct interpretation of the
dataset in the event that its dimensions are
named in a manner that is inconsistent with CF
rules defined by the CF conventions (section 2.7
Groups).</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version (cfdm): </span>1.13.0.0</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>



          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2026, NCAS | Page built on 2026-01-15.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>