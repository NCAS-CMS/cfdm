
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Tutorial &#8212; Documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/customise-alabaster.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/clipboard.min.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="_static/toggleprompt.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API reference" href="api_reference.html" />
    <link rel="prev" title="Contributing" href="contributing.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">



<h1 class="logo"><a href="index.html">cfdm 1.9.0.4</a></h1>



<p class="blurb">A Python reference implementation of the CF data model</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NCAS-CMS&repo=cfdm&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="cf_data_model.html"><strong>CF data model</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html"><strong>Contributing</strong></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>Tutorial</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html"><strong>API reference</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html"><strong>Philosophy</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html"><strong>Performance</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html"><strong>Extensions</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html"><strong>Releases</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html"><strong>Change log</strong></a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="contributing.html" title="previous chapter"><strong>Contributing</strong></a></li>
      <li>Next: <a href="api_reference.html" title="next chapter"><strong>API reference</strong></a></li>
  </ul></li>
</ul>
</div>

<br>
cfdm development has been supported by
the <a href="https://erc.europa.eu/">ERC</a>
through <a href="https://cordis.europa.eu/project/id/786427">Couplet</a>;
by the <a href="https://ec.europa.eu/programmes/horizon2020/">EC
Horizon 2020 programme</a> through
<a href="https://cordis.europa.eu/project/id/824084">IS-ENES3</a>;
by <a href="https://nerc.ukri.org/">NERC</a> through
<a href="https://gtr.ukri.org/project/0D95A6DB-0B95-48F7-8A8B-7B9A47DEA117">UKFAFMIP</a>;
and by <a href="https://ncas.ac.uk/">NCAS</a>.
<br>
<br>
<img src="_templates/logo_EC.png" height="40">
<img src="_templates/logo_ERC.png" height="40">
<img src="_templates/logo_NERC.png" height="40">
<br>
<img src="_templates/logo_NCAS.png" height="40">
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            


  <section id="tutorial">
<span id="id1"></span><h1><strong>Tutorial</strong><a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Version 1.9.0.4 for version 1.9 of the CF conventions.</p>
<p>All of the Python code in this tutorial is available in an executable
script (<a class="reference download internal" download="" href="_downloads/tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 12kB).</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#sample-datasets" id="id208"><strong>Sample datasets</strong></a></p></li>
<li><p><a class="reference internal" href="#import" id="id209"><strong>Import</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#cf-version" id="id210">CF version</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#field-and-domain-constructs" id="id211"><strong>Field and domain constructs</strong></a></p></li>
<li><p><a class="reference internal" href="#reading-field-or-domain-constructs-from-datasets" id="id212"><strong>Reading field or domain constructs from datasets</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#cf-compliance" id="id213">CF-compliance</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#inspection" id="id214"><strong>Inspection</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#minimal-detail" id="id215">Minimal detail</a></p></li>
<li><p><a class="reference internal" href="#medium-detail" id="id216">Medium detail</a></p></li>
<li><p><a class="reference internal" href="#full-detail" id="id217">Full detail</a></p></li>
<li><p><a class="reference internal" href="#cfdump" id="id218">cfdump</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#properties" id="id219"><strong>Properties</strong></a></p></li>
<li><p><a class="reference internal" href="#metadata-constructs" id="id220"><strong>Metadata constructs</strong></a></p></li>
<li><p><a class="reference internal" href="#data" id="id221"><strong>Data</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#data-axes" id="id222">Data axes</a></p></li>
<li><p><a class="reference internal" href="#date-time" id="id223">Date-time</a></p></li>
<li><p><a class="reference internal" href="#manipulating-dimensions" id="id224">Manipulating dimensions</a></p></li>
<li><p><a class="reference internal" href="#data-mask" id="id225">Data mask</a></p></li>
<li><p><a class="reference internal" href="#indexing" id="id226">Indexing</a></p></li>
<li><p><a class="reference internal" href="#assignment" id="id227">Assignment</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#subspacing" id="id228"><strong>Subspacing</strong></a></p></li>
<li><p><a class="reference internal" href="#selecting-metadata-constructs" id="id229"><strong>Selecting metadata constructs</strong></a></p></li>
<li><p><a class="reference internal" href="#metadata-construct-access" id="id230"><strong>Metadata construct access</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#metadata-construct-properties" id="id231">Metadata construct properties</a></p></li>
<li><p><a class="reference internal" href="#metadata-construct-data" id="id232">Metadata construct data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#time" id="id233"><strong>Time</strong></a></p></li>
<li><p><a class="reference internal" href="#domain" id="id234"><strong>Domain</strong></a></p></li>
<li><p><a class="reference internal" href="#domain-axes" id="id235"><strong>Domain axes</strong></a></p></li>
<li><p><a class="reference internal" href="#coordinates" id="id236"><strong>Coordinates</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#bounds" id="id237">Bounds</a></p></li>
<li><p><a class="reference internal" href="#geometry-cells" id="id238">Geometry cells</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#domain-ancillaries" id="id239"><strong>Domain ancillaries</strong></a></p></li>
<li><p><a class="reference internal" href="#coordinate-systems" id="id240"><strong>Coordinate systems</strong></a></p></li>
<li><p><a class="reference internal" href="#cell-methods" id="id241"><strong>Cell methods</strong></a></p></li>
<li><p><a class="reference internal" href="#field-ancillaries" id="id242"><strong>Field ancillaries</strong></a></p></li>
<li><p><a class="reference internal" href="#field-creation-in-memory" id="id243"><strong>Field creation in memory</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#ab-initio-creation" id="id244">Ab initio creation</a></p></li>
<li><p><a class="reference internal" href="#command-modification" id="id245">Command modification</a></p></li>
<li><p><a class="reference internal" href="#creating-data-from-an-array-on-disk" id="id246">Creating data from an array on disk</a></p></li>
<li><p><a class="reference internal" href="#creation-by-conversion" id="id247">Creation by conversion</a></p></li>
<li><p><a class="reference internal" href="#creation-by-reading" id="id248">Creation by reading</a></p></li>
<li><p><a class="reference internal" href="#creating-compressed-constructs" id="id249">Creating compressed constructs</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#copying" id="id250"><strong>Copying</strong></a></p></li>
<li><p><a class="reference internal" href="#equality" id="id251"><strong>Equality</strong></a></p></li>
<li><p><a class="reference internal" href="#netcdf-interface" id="id252"><strong>NetCDF interface</strong></a></p></li>
<li><p><a class="reference internal" href="#writing-to-disk" id="id253"><strong>Writing to disk</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#global-attributes" id="id254">Global attributes</a></p></li>
<li><p><a class="reference internal" href="#conventions" id="id255">Conventions</a></p></li>
<li><p><a class="reference internal" href="#scalar-coordinate-variables" id="id256">Scalar coordinate variables</a></p></li>
<li><p><a class="reference internal" href="#compressed-constructs" id="id257">Compressed constructs</a></p></li>
<li><p><a class="reference internal" href="#strings" id="id258">Strings</a></p></li>
<li><p><a class="reference internal" href="#groups" id="id259">Groups</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#hierarchical-groups" id="id260"><strong>Hierarchical groups</strong></a></p></li>
<li><p><a class="reference internal" href="#external-variables" id="id261"><strong>External variables</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#external-files-with-cfdump" id="id262">External files with cfdump</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#compression" id="id263"><strong>Compression</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#discrete-sampling-geometries" id="id264">Discrete sampling geometries</a></p></li>
<li><p><a class="reference internal" href="#gathering" id="id265">Gathering</a></p></li>
<li><p><a class="reference internal" href="#coordinate-subsampling" id="id266">Coordinate subsampling</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#controlling-output-messages" id="id267"><strong>Controlling output messages</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#logging" id="id268">Logging</a></p></li>
<li><p><a class="reference internal" href="#function-verbosity" id="id269">Function verbosity</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="sample-datasets">
<span id="id2"></span><h2><a class="toc-backref" href="#id208"><strong>Sample datasets</strong></a><a class="headerlink" href="#sample-datasets" title="Permalink to this headline">¶</a></h2>
<p>This tutorial uses a number of small sample datasets, all of which can
be found in the zip file <code class="docutils literal notranslate"><span class="pre">cfdm_tutorial_files.zip</span></code>
(<a class="reference download internal" download="" href="_downloads/cfdm_tutorial_files.zip"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>,
8kB):</p>
<div class="literal-block-wrapper docutils container" id="id66">
<div class="code-block-caption"><span class="caption-text"><em>Unpack the sample datasets.</em></span><a class="headerlink" href="#id66" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> unzip -q cfdm_tutorial_files.zip
<span class="gp">$</span> ls -1
<span class="go">cfdm_tutorial_files.zip</span>
<span class="go">contiguous.nc</span>
<span class="go">external.nc</span>
<span class="go">file.nc</span>
<span class="go">gathered.nc</span>
<span class="go">geometry.nc</span>
<span class="go">parent.nc</span>
</pre></div>
</div>
</div>
<p>The tutorial examples assume that the Python session is being run from
the directory that contains the zip file and its unpacked contents,
and no other files.</p>
<hr class="docutils" />
</section>
<section id="import">
<span id="id3"></span><h2><a class="toc-backref" href="#id209"><strong>Import</strong></a><a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h2>
<p>The cfdm package is imported as follows:</p>
<div class="literal-block-wrapper docutils container" id="id67">
<div class="code-block-caption"><span class="caption-text"><em>Import the cfdm package.</em></span><a class="headerlink" href="#id67" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cfdm</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is possible to change the extent to which cfdm outputs
feedback messages and it may be instructive to increase the
verbosity whilst working through this tutorial to see and
learn more about what cfdm is doing under the hood and about
the nature of the dataset being operated on. This can be done
for example by running:</p>
<div class="literal-block-wrapper docutils container" id="id68">
<div class="code-block-caption"><span class="caption-text"><em>Increase the verbosity of cfdm from the
default.</em></span><a class="headerlink" href="#id68" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">log_level</span><span class="p">(</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>See <a class="reference internal" href="#logging"><span class="std std-ref">the section on ‘Logging’</span></a> for more
information.</p>
</div>
<section id="cf-version">
<span id="id4"></span><h3><a class="toc-backref" href="#id210">CF version</a><a class="headerlink" href="#cf-version" title="Permalink to this headline">¶</a></h3>
<p>The version of the <a class="reference external" href="http://cfconventions.org">CF conventions</a> and
the <a class="reference internal" href="cf_data_model.html#cf-data-model"><span class="std std-ref">CF data model</span></a> being used may be found with
the <a class="reference internal" href="function/cfdm.CF.html#cfdm.CF" title="cfdm.CF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.CF</span></code></a> function:</p>
<div class="literal-block-wrapper docutils container" id="id69">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the version of the CF conventions.</em></span><a class="headerlink" href="#id69" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">CF</span><span class="p">()</span>
<span class="go">&#39;1.9&#39;</span>
</pre></div>
</div>
</div>
<p>This indicates which version of the CF conventions are represented by
this release of the cfdm package, and therefore the version can not be
changed.</p>
<p>Note, however, that datasets of different versions may also be
<a class="reference internal" href="#reading-datasets"><span class="std std-ref">read</span></a> from, or <a class="reference internal" href="#writing-to-disk"><span class="std std-ref">written</span></a> to, disk.</p>
<hr class="docutils" />
</section>
</section>
<section id="field-and-domain-constructs">
<span id="id5"></span><h2><a class="toc-backref" href="#id211"><strong>Field and domain constructs</strong></a><a class="headerlink" href="#field-and-domain-constructs" title="Permalink to this headline">¶</a></h2>
<p>The central constructs of CF are the <a class="reference internal" href="cf_data_model.html#term-field-construct"><span class="xref std std-term">field construct</span></a> and
<a class="reference internal" href="cf_data_model.html#term-domain-construct"><span class="xref std std-term">domain construct</span></a>.</p>
<p>The field construct, that corresponds to a CF-netCDF data variable,
includes all of the metadata to describe it:</p>
<blockquote>
<div><ul class="simple">
<li><p>descriptive properties that apply to field construct as a whole
(e.g. the standard name),</p></li>
<li><p>a data array, and</p></li>
<li><p>“metadata constructs” that describe the locations of each cell
(i.e. the “domain”) of the data array, and the physical nature
of each cell’s datum.</p></li>
</ul>
</div></blockquote>
<p>Likewise, the domain construct, that corresponds to a CF-netCDF domain
variable or to the domain of a field construct, includes all of the
metadata to describe it:</p>
<blockquote>
<div><ul class="simple">
<li><p>descriptive properties that apply to field construct as a whole
(e.g. the long name), and</p></li>
<li><p>metadata constructs that describe the locations of each cell of
the domain.</p></li>
</ul>
</div></blockquote>
<p>A field construct or domain construct is stored in a <a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.Field</span></code></a>
instance or <a class="reference internal" href="class/cfdm.Domain.html#cfdm.Domain" title="cfdm.Domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.Domain</span></code></a> instance respectively. Henceforth the phrase
“field construct” will be assumed to mean “<a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.Field</span></code></a> instance”, and
“domain construct” will be assumed to mean “<a class="reference internal" href="class/cfdm.Domain.html#cfdm.Domain" title="cfdm.Domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.Domain</span></code></a> instance”.</p>
<hr class="docutils" />
</section>
<section id="reading-field-or-domain-constructs-from-datasets">
<span id="reading-datasets"></span><h2><a class="toc-backref" href="#id212"><strong>Reading field or domain constructs from datasets</strong></a><a class="headerlink" href="#reading-field-or-domain-constructs-from-datasets" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function reads a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">netCDF</a> file from disk, or
from an <a class="reference external" href="https://www.opendap.org/">OPeNDAP</a> URL <a class="footnote-reference brackets" href="#dap" id="id6">1</a>, and by
default returns the contents as a Python list of zero or more field
constructs. This list contains a field construct to represent each of
the CF-netCDF data variables in the file.</p>
<p>Datasets of any version of CF up to and including CF-1.9 can be
read <a class="footnote-reference brackets" href="#caveat" id="id7">2</a>.</p>
<p>All formats of netCDF3 and netCDF4 files can be read.</p>
<p>The file name may describe relative paths, and standard tilde and
shell parameter expansions are applied to it.</p>
<p>The following file types can be read:</p>
<ul class="simple">
<li><p>All formats of netCDF3 and netCDF4 files can be read, containing
datasets for versions of CF up to and including CF-1.9.</p></li>
</ul>
<ul class="simple">
<li><p>Files in <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/netcdf_working_with_netcdf_files.html#netcdf_utilities">CDL format</a>,
with or without the data array values.</p></li>
</ul>
<p>For example, to read the file <code class="docutils literal notranslate"><span class="pre">file.nc</span></code> (found in the <a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample
datasets</span></a>), which contains two field constructs:</p>
<div class="literal-block-wrapper docutils container" id="id70">
<div class="code-block-caption"><span class="caption-text"><em>Read file.nc and show that the result is a two-element
list.</em></span><a class="headerlink" href="#id70" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">&lt;type &#39;list&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<p>Descriptive properties are always read into memory, but <a class="reference external" href="https://en.wikipedia.org/wiki/Lazy_loading">lazy loading</a> is employed for all
data arrays, which means that no data is read into memory until the
data is required for inspection or to modify the array contents. This
maximises the number of field constructs that may be read within a
session, and makes the read operation fast.</p>
<p>Note that when reading netCDF4 files that contain <a class="reference internal" href="#hierarchical-groups"><span class="std std-ref">hierachical
groups</span></a>, the group structure is saved via the
<a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a> so that it may be re-used,
or modified, if the field constructs are written to back to disk.</p>
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li><p>allow the user to provide files that contain <a class="reference internal" href="#external-variables"><span class="std std-ref">external
variables</span></a>;</p></li>
<li><p>request <a class="reference internal" href="#creation-by-reading"><span class="std std-ref">extra field constructs to be created from “metadata”
netCDF variables</span></a>, i.e. those that are
referenced from CF-netCDF data variables, but which are not regarded
by default as data variables in their own right;</p></li>
<li><p>return only domain constructs derived from CF-netCDF domain
variables;</p></li>
<li><p>request that masking is <em>not</em> applied by convention to data elements
(see <a class="reference internal" href="#data-mask"><span class="std std-ref">data masking</span></a>);</p></li>
<li><p>issue warnings when <code class="docutils literal notranslate"><span class="pre">valid_min</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_max</span></code> and <code class="docutils literal notranslate"><span class="pre">valid_range</span></code>
attributes are present (see <a class="reference internal" href="#data-mask"><span class="std std-ref">data masking</span></a>); and</p></li>
<li><p>display information and issue warnings about the mapping of the
netCDF file contents to CF data model constructs.</p></li>
</ul>
<section id="cf-compliance">
<span id="id8"></span><h3><a class="toc-backref" href="#id213">CF-compliance</a><a class="headerlink" href="#cf-compliance" title="Permalink to this headline">¶</a></h3>
<p>If the dataset is partially CF-compliant to the extent that it is not
possible to unambiguously map an element of the netCDF dataset to an
element of the CF data model, then a field construct is still
returned, but may be incomplete. This is so that datasets which are
partially conformant may nonetheless be modified in memory and written
to new datasets. Such “structural” non-compliance would occur, for
example, if the <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> attribute of a CF-netCDF data variable
refers to another variable that does not exist, or refers to a
variable that spans a netCDF dimension that does not apply to the data
variable. Other types of non-compliance are not checked, such whether
or not controlled vocabularies have been adhered to. The structural
compliance of the dataset may be checked with the
<a class="reference internal" href="method/cfdm.Field.dataset_compliance.html#cfdm.Field.dataset_compliance" title="cfdm.Field.dataset_compliance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dataset_compliance</span></code></a> method of the field construct, as
well as optionally displayed when the dataset is read.</p>
<hr class="docutils" />
</section>
</section>
<section id="inspection">
<span id="id9"></span><h2><a class="toc-backref" href="#id214"><strong>Inspection</strong></a><a class="headerlink" href="#inspection" title="Permalink to this headline">¶</a></h2>
<p>The contents of a field construct may be inspected at three different
levels of detail.</p>
<section id="minimal-detail">
<span id="id10"></span><h3><a class="toc-backref" href="#id215">Minimal detail</a><a class="headerlink" href="#minimal-detail" title="Permalink to this headline">¶</a></h3>
<p>The built-in <a class="reference external" href="https://docs.python.org/3/library/functions.html#repr" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repr</span></code></a> function returns a short, one-line description:</p>
<div class="literal-block-wrapper docutils container" id="id71">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs from
the dataset and create a Python variable for each of
them.</em></span><a class="headerlink" href="#id71" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
</pre></div>
</div>
</div>
<p>This gives the identity of the field construct
(e.g. “specific_humidity”), the identities and sizes of the dimensions
spanned by the data array (“latitude” and “longitude” with sizes 5 and
8 respectively) and the units of the data (“1”).</p>
</section>
<section id="medium-detail">
<span id="id11"></span><h3><a class="toc-backref" href="#id216">Medium detail</a><a class="headerlink" href="#medium-detail" title="Permalink to this headline">¶</a></h3>
<p>The built-in <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> function returns similar information as the
one-line output, along with short descriptions of the metadata
constructs, which include the first and last values of their data
arrays:</p>
<div class="literal-block-wrapper docutils container" id="id72">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs with
medium detail.</em></span><a class="headerlink" href="#id72" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.81, ..., 0.78]] K</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., kappa]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
</pre></div>
</div>
</div>
<p>Note that <a class="reference internal" href="#time"><span class="std std-ref">time values</span></a> are converted to date-times with
the <a class="reference external" href="https://unidata.github.io/cftime/">cftime package</a>.</p>
</section>
<section id="full-detail">
<span id="id12"></span><h3><a class="toc-backref" href="#id217">Full detail</a><a class="headerlink" href="#full-detail" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="method/cfdm.Field.dump.html#cfdm.Field.dump" title="cfdm.Field.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump</span></code></a> method of the field construct gives all
properties of all constructs, including metadata constructs and their
components, and shows the first and last values of all data arrays:</p>
<div class="literal-block-wrapper docutils container" id="id73">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs with
full detail.</em></span><a class="headerlink" href="#id73" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">----------------------------------</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Conventions = &#39;CF-1.9&#39;</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;specific_humidity&#39;</span>
<span class="go">units = &#39;1&#39;</span>

<span class="go">Data(latitude(5), longitude(8)) = [[0.003, ..., 0.032]] 1</span>

<span class="go">Cell Method: area: mean</span>

<span class="go">Domain Axis: latitude(5)</span>
<span class="go">Domain Axis: longitude(8)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_north&#39;</span>
<span class="go">    Data(latitude(5)) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">    Bounds:Data(latitude(5), 2) = [[-90.0, ..., 90.0]]</span>

<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(longitude(8)) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">    Bounds:Data(longitude(8), 2) = [[0.0, ..., 360.0]]</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2019-01-01 00:00:00]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">---------------------------------</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Conventions = &#39;CF-1.9&#39;</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;air_temperature&#39;</span>
<span class="go">units = &#39;K&#39;</span>

<span class="go">Data(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) = [[[0.0, ..., 89.0]]] K</span>

<span class="go">Cell Method: grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees)</span>
<span class="go">Cell Method: time(1): maximum</span>

<span class="go">Field Ancillary: air_temperature standard_error</span>
<span class="go">    standard_name = &#39;air_temperature standard_error&#39;</span>
<span class="go">    units = &#39;K&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[0.81, ..., 0.78]] K</span>

<span class="go">Domain Axis: atmosphere_hybrid_height_coordinate(1)</span>
<span class="go">Domain Axis: grid_latitude(10)</span>
<span class="go">Domain Axis: grid_longitude(9)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: atmosphere_hybrid_height_coordinate</span>
<span class="go">    computed_standard_name = &#39;altitude&#39;</span>
<span class="go">    standard_name = &#39;atmosphere_hybrid_height_coordinate&#39;</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [1.5]</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[1.0, 2.0]]</span>

<span class="go">Dimension coordinate: grid_latitude</span>
<span class="go">    standard_name = &#39;grid_latitude&#39;</span>
<span class="go">    units = &#39;degrees&#39;</span>
<span class="go">    Data(grid_latitude(10)) = [2.2, ..., -1.76] degrees</span>
<span class="go">    Bounds:Data(grid_latitude(10), 2) = [[2.42, ..., -1.98]]</span>

<span class="go">Dimension coordinate: grid_longitude</span>
<span class="go">    standard_name = &#39;grid_longitude&#39;</span>
<span class="go">    units = &#39;degrees&#39;</span>
<span class="go">    Data(grid_longitude(9)) = [-4.7, ..., -1.18] degrees</span>
<span class="go">    Bounds:Data(grid_longitude(9), 2) = [[-4.92, ..., -0.96]]</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2019-01-01 00:00:00]</span>

<span class="go">Auxiliary coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_N&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>

<span class="go">Auxiliary coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_E&#39;</span>
<span class="go">    Data(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>

<span class="go">Auxiliary coordinate: long_name=Grid latitude name</span>
<span class="go">    long_name = &#39;Grid latitude name&#39;</span>
<span class="go">    Data(grid_latitude(10)) = [--, ..., kappa]</span>

<span class="go">Domain ancillary: ncvar%a</span>
<span class="go">    units = &#39;m&#39;</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[5.0, 15.0]]</span>

<span class="go">Domain ancillary: ncvar%b</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[14.0, 26.0]]</span>

<span class="go">Domain ancillary: surface_altitude</span>
<span class="go">    standard_name = &#39;surface_altitude&#39;</span>
<span class="go">    units = &#39;m&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>

<span class="go">Coordinate reference: atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:computed_standard_name = altitude</span>
<span class="go">    Coordinate conversion:standard_name = atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:a = Domain Ancillary: ncvar%a</span>
<span class="go">    Coordinate conversion:b = Domain Ancillary: ncvar%b</span>
<span class="go">    Coordinate conversion:orog = Domain Ancillary: surface_altitude</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Dimension Coordinate: atmosphere_hybrid_height_coordinate</span>

<span class="go">Coordinate reference: rotated_latitude_longitude</span>
<span class="go">    Coordinate conversion:grid_mapping_name = rotated_latitude_longitude</span>
<span class="go">    Coordinate conversion:grid_north_pole_latitude = 38.0</span>
<span class="go">    Coordinate conversion:grid_north_pole_longitude = 190.0</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Dimension Coordinate: grid_longitude</span>
<span class="go">    Dimension Coordinate: grid_latitude</span>
<span class="go">    Auxiliary Coordinate: longitude</span>
<span class="go">    Auxiliary Coordinate: latitude</span>

<span class="go">Cell measure: measure:area</span>
<span class="go">    units = &#39;km2&#39;</span>
<span class="go">    Data(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
</pre></div>
</div>
</div>
</section>
<section id="cfdump">
<span id="id13"></span><h3><a class="toc-backref" href="#id218">cfdump</a><a class="headerlink" href="#cfdump" title="Permalink to this headline">¶</a></h3>
<p>The description for every field construct in a file can also be
generated from the command line, with minimal, medium or full detail,
by using the <code class="docutils literal notranslate"><span class="pre">cfdump</span></code> tool, for example:</p>
<div class="literal-block-wrapper docutils container" id="id74">
<div class="code-block-caption"><span class="caption-text"><em>Use cfdump on the command line to inspect the field
constructs contained in a dataset. The “-s” option
requests short, minimal detail as output.</em></span><a class="headerlink" href="#id74" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cfdump
<span class="go">USAGE: cfdump [-s] [-c] [-e file [-e file] ...] [-h] file</span>
<span class="go">  [-s]      Display short, one-line descriptions</span>
<span class="go">  [-c]      Display complete descriptions</span>
<span class="go">  [-e file] External files</span>
<span class="go">  [-h]      Display the full man page</span>
<span class="go">  file      Name of netCDF file (or URL if DAP access enabled)</span>
<span class="gp">$</span> cfdump -s file.nc
<span class="go">Field: specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cfdump</span></code> may also be used with <a class="reference internal" href="#external-variables-with-cfdump"><span class="std std-ref">external files</span></a>.</p>
<hr class="docutils" />
</section>
</section>
<section id="properties">
<span id="id14"></span><h2><a class="toc-backref" href="#id219"><strong>Properties</strong></a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<p>Descriptive properties that apply to field construct as a whole may be
retrieved with the <a class="reference internal" href="method/cfdm.Field.properties.html#cfdm.Field.properties" title="cfdm.Field.properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">properties</span></code></a> method:</p>
<div class="literal-block-wrapper docutils container" id="id75">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve all of the descriptive properties</em></span><a class="headerlink" href="#id75" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.9&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
</pre></div>
</div>
</div>
<p>Individual properties may be accessed and modified with the
<a class="reference internal" href="method/cfdm.Field.del_property.html#cfdm.Field.del_property" title="cfdm.Field.del_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_property</span></code></a>, <a class="reference internal" href="method/cfdm.Field.get_property.html#cfdm.Field.get_property" title="cfdm.Field.get_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_property</span></code></a>, <a class="reference internal" href="method/cfdm.Field.has_property.html#cfdm.Field.has_property" title="cfdm.Field.has_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_property</span></code></a>,
and <a class="reference internal" href="method/cfdm.Field.set_property.html#cfdm.Field.set_property" title="cfdm.Field.set_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_property</span></code></a> methods:</p>
<div class="literal-block-wrapper docutils container" id="id76">
<div class="code-block-caption"><span class="caption-text"><em>Check is a property exists, retrieve its value, delete
it and then set it to a new value.</em></span><a class="headerlink" href="#id76" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;not set&#39;</span><span class="p">)</span>
<span class="go">&#39;not set&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;air_temperature&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;not set&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
</pre></div>
</div>
</div>
<p>A collection of properties may be set at the same time with the
<a class="reference internal" href="method/cfdm.Field.set_properties.html#cfdm.Field.set_properties" title="cfdm.Field.set_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_properties</span></code></a> method of the field construct, and all
properties may be completely removed with the
<a class="reference internal" href="method/cfdm.Field.clear_properties.html#cfdm.Field.clear_properties" title="cfdm.Field.clear_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_properties</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id77">
<div class="code-block-caption"><span class="caption-text"><em>Update the properties with a collection, delete all of
the properties, and reinstate the original properties.</em></span><a class="headerlink" href="#id77" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.9&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.9&#39;,</span>
<span class="go"> &#39;foo&#39;: &#39;bar&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">clear_properties</span><span class="p">()</span>
<span class="go"> {&#39;Conventions&#39;: &#39;CF-1.9&#39;,</span>
<span class="go"> &#39;foo&#39;: &#39;bar&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.9&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
</pre></div>
</div>
</div>
<p>All of the methods related to the properties are listed <a class="reference internal" href="class/cfdm.Field.html#field-properties"><span class="std std-ref">here</span></a>.</p>
<hr class="docutils" />
</section>
<section id="metadata-constructs">
<span id="id15"></span><h2><a class="toc-backref" href="#id220"><strong>Metadata constructs</strong></a><a class="headerlink" href="#metadata-constructs" title="Permalink to this headline">¶</a></h2>
<p>The metadata constructs describe the field construct that contains
them. Each <a class="reference internal" href="cf_data_model.html#cf-data-model"><span class="std std-ref">CF data model metadata construct</span></a> has
a corresponding cfdm class:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 55%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>CF data model construct</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></p></td>
<td><p><a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">Domain axis</span></a></p></td>
<td><p>Independent axes of the domain</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a></p></td>
<td><p><a class="reference internal" href="cf_data_model.html#term-dimension-coordinate-constructs"><span class="xref std std-term">Dimension coordinate</span></a></p></td>
<td><p>Domain cell locations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a></p></td>
<td><p><a class="reference internal" href="cf_data_model.html#term-auxiliary-coordinate-constructs"><span class="xref std std-term">Auxiliary coordinate</span></a></p></td>
<td><p>Domain cell locations</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a></p></td>
<td><p><a class="reference internal" href="cf_data_model.html#term-coordinate-reference-constructs"><span class="xref std std-term">Coordinate reference</span></a></p></td>
<td><p>Domain coordinate systems</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a></p></td>
<td><p><a class="reference internal" href="cf_data_model.html#term-domain-ancillary-constructs"><span class="xref std std-term">Domain ancillary</span></a></p></td>
<td><p>Cell locations in alternative
coordinate systems</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></p></td>
<td><p><a class="reference internal" href="cf_data_model.html#term-cell-measure-constructs"><span class="xref std std-term">Cell measure</span></a></p></td>
<td><p>Domain cell size or shape</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a></p></td>
<td><p><a class="reference internal" href="cf_data_model.html#term-field-ancillary-constructs"><span class="xref std std-term">Field ancillary</span></a></p></td>
<td><p>Ancillary metadata which vary
within the domain</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="class/cfdm.CellMethod.html#cfdm.CellMethod" title="cfdm.CellMethod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMethod</span></code></a></p></td>
<td><p><a class="reference internal" href="cf_data_model.html#term-cell-method-constructs"><span class="xref std std-term">Cell method</span></a></p></td>
<td><p>Describes how data represent
variation within cells</p></td>
</tr>
</tbody>
</table>
<p>Metadata constructs of a particular type can be retrieved with the
following methods of the field construct:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 59%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Metadata constructs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.domain_axes.html#cfdm.Field.domain_axes" title="cfdm.Field.domain_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_axes</span></code></a></p></td>
<td><p>Domain axes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.dimension_coordinates.html#cfdm.Field.dimension_coordinates" title="cfdm.Field.dimension_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimension_coordinates</span></code></a></p></td>
<td><p>Dimension coordinates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.auxiliary_coordinates.html#cfdm.Field.auxiliary_coordinates" title="cfdm.Field.auxiliary_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auxiliary_coordinates</span></code></a></p></td>
<td><p>Auxiliary coordinates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.coordinate_references.html#cfdm.Field.coordinate_references" title="cfdm.Field.coordinate_references"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinate_references</span></code></a></p></td>
<td><p>Coordinate references</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.domain_ancillaries.html#cfdm.Field.domain_ancillaries" title="cfdm.Field.domain_ancillaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_ancillaries</span></code></a></p></td>
<td><p>Domain ancillaries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.cell_measures.html#cfdm.Field.cell_measures" title="cfdm.Field.cell_measures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_measures</span></code></a></p></td>
<td><p>Cell measures</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.field_ancillaries.html#cfdm.Field.field_ancillaries" title="cfdm.Field.field_ancillaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">field_ancillaries</span></code></a></p></td>
<td><p>Field ancillaries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.cell_methods.html#cfdm.Field.cell_methods" title="cfdm.Field.cell_methods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_methods</span></code></a></p></td>
<td><p>Cell methods</p></td>
</tr>
</tbody>
</table>
<p>Each of these attributes returns a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> class instance that
maps metadata constructs to unique identifiers called “construct
keys”. A <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance has methods for selecting constructs
that meet particular criteria (see the section on <span class="xref std std-ref">filtering
metadata constructs</span>). It also behaves
like a “read-only” Python dictionary, in that it has
<a class="reference internal" href="method/cfdm.Constructs.items.html#cfdm.Constructs.items" title="cfdm.Constructs.items"><code class="xref py py-obj docutils literal notranslate"><span class="pre">items</span></code></a>, <a class="reference internal" href="method/cfdm.Constructs.keys.html#cfdm.Constructs.keys" title="cfdm.Constructs.keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keys</span></code></a> and <a class="reference internal" href="method/cfdm.Constructs.values.html#cfdm.Constructs.values" title="cfdm.Constructs.values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code></a>
methods that work exactly like their corresponding <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> methods. It
also has a <a class="reference internal" href="method/cfdm.Constructs.get.html#cfdm.Constructs.get" title="cfdm.Constructs.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a> method and indexing like a Python
dictionary (see the section on <a class="reference internal" href="#metadata-construct-access"><span class="std std-ref">metadata construct access</span></a> for details).</p>
<div class="literal-block-wrapper docutils container" id="id78">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the field construct’s coordinate reference
constructs, and access them using dictionary methods.</em></span><a class="headerlink" href="#id78" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="p">()</span>
<span class="go">&lt;Constructs: coordinate_reference(2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;coordinatereference0&#39;: &lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;,</span>
<span class="go"> &#39;coordinatereference1&#39;: &lt;CoordinateReference: rotated_latitude_longitude&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;coordinatereference0&#39;, &#39;coordinatereference1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">coordinatereference1 &lt;CoordinateReference: rotated_latitude_longitude&gt;</span>
<span class="go">coordinatereference0 &lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id79">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the field construct’s dimension coordinate and
domain axis constructs.</em></span><a class="headerlink" href="#id79" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">dimension_coordinates</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;DomainAxis: size(1)&gt;}</span>
</pre></div>
</div>
</div>
<p>The construct keys (e.g. <code class="docutils literal notranslate"><span class="pre">'domainaxis1'</span></code>) are usually generated
internally and are unique within the field construct. However,
construct keys may be different for equivalent metadata constructs
from different field constructs, and for different Python sessions.</p>
<p>Metadata constructs of all types may be returned by the
<a class="reference internal" href="attribute/cfdm.Field.constructs.html#cfdm.Field.constructs" title="cfdm.Field.constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constructs</span></code></a> attribute of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id80">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve all of the field construct’s metadata
constructs.</em></span><a class="headerlink" href="#id80" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span>
<span class="go">&lt;Constructs: cell_method(1), dimension_coordinate(3), domain_axis(3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CellMethod: area: mean&gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: latitude(5) degrees_north&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: longitude(8) degrees_east&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;,</span>
<span class="go"> &#39;domainaxis0&#39;: &lt;DomainAxis: size(5)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(8)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span>
<span class="go">&lt;Constructs: auxiliary_coordinate(3), cell_measure(1), cell_method(2), coordinate_reference(2), dimension_coordinate(4), domain_ancillary(3), domain_axis(4), field_ancillary(1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;,</span>
<span class="go"> &#39;cellmethod0&#39;: &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;,</span>
<span class="go"> &#39;coordinatereference0&#39;: &lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;,</span>
<span class="go"> &#39;coordinatereference1&#39;: &lt;CoordinateReference: rotated_latitude_longitude&gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;,</span>
<span class="go"> &#39;domainancillary0&#39;: &lt;DomainAncillary: ncvar%a(1) m&gt;,</span>
<span class="go"> &#39;domainancillary1&#39;: &lt;DomainAncillary: ncvar%b(1) &gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;domainaxis0&#39;: &lt;DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="data">
<span id="id16"></span><h2><a class="toc-backref" href="#id221"><strong>Data</strong></a><a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<p>The field construct’s data is stored in a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> class instance that
is accessed with the <a class="reference internal" href="attribute/cfdm.Field.data.html#cfdm.Field.data" title="cfdm.Field.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a> attribute of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id81">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the data and inspect it, showing the shape and
some illustrative values.</em></span><a class="headerlink" href="#id81" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(1, 10, 9): [[[262.8, ..., 269.7]]] K&gt;</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance provides access to the full array of values, as
well as attributes to describe the array and methods for describing
any <a class="reference internal" href="#compression"><span class="std std-ref">data compression</span></a>.</p>
<p>The <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance provides access to the full array of values, as
well as attributes to describe the array and methods for describing
any data compression. However, the field construct (and any other
construct that contains data) also provides attributes for direct
access.</p>
<div class="literal-block-wrapper docutils container" id="id82">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve a numpy array of the data.</em></span><a class="headerlink" href="#id82" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[262.8 270.5 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7 268.4 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7 279.1 273.4 274.2 279.6 270.2 280.0 272.5 263.7]</span>
<span class="go">  [261.7 260.6 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.0 263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.0 270.6]</span>
<span class="go">  [267.9 273.5 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9 278.7 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4 264.2 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id83">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the data type, number of dimensions, dimension
sizes and number of elements of the data.</em></span><a class="headerlink" href="#id83" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float64&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">ndim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">size</span>
<span class="go">90</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span>
<span class="go">90</span>
</pre></div>
</div>
</div>
<p>Note it is preferable to access the data type, number of dimensions,
dimension sizes and number of elements of the data via the parent
construct, rather than from the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance, as there are
<a class="reference internal" href="#geometry-cells"><span class="std std-ref">particular circumstances</span></a> when there is no
<a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance, but the construct nonetheless has data descriptors.</p>
<p>The field construct also has a <a class="reference internal" href="method/cfdm.Field.get_data.html#cfdm.Field.get_data" title="cfdm.Field.get_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data</span></code></a> method as an
alternative means of retrieving the data instance, which allows for a
default to be returned if no data have been set; as well as a
<a class="reference internal" href="method/cfdm.Field.del_data.html#cfdm.Field.del_data" title="cfdm.Field.del_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_data</span></code></a> method for removing the data.</p>
<p>All of the methods and attributes related to the data are listed
<a class="reference internal" href="class/cfdm.Field.html#field-data"><span class="std std-ref">here</span></a>.</p>
<section id="data-axes">
<span id="id17"></span><h3><a class="toc-backref" href="#id222">Data axes</a><a class="headerlink" href="#data-axes" title="Permalink to this headline">¶</a></h3>
<p>The data array of the field construct spans all the <a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis
constructs</span></a> with the possible exception of size one domain axis
constructs. The domain axis constructs spanned by the field
construct’s data are found with the <a class="reference internal" href="method/cfdm.Field.get_data_axes.html#cfdm.Field.get_data_axes" title="cfdm.Field.get_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_axes</span></code></a> method of
the field construct. For example, the data of the field construct
<code class="docutils literal notranslate"><span class="pre">t</span></code> does not span the size one domain axis construct with key
<code class="docutils literal notranslate"><span class="pre">'domainaxis3'</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id84">
<div class="code-block-caption"><span class="caption-text"><em>Show which data axis constructs are spanned by the field
construct’s data.</em></span><a class="headerlink" href="#id84" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">()</span>
<span class="go">(&#39;domainaxis0&#39;, &#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
</pre></div>
</div>
</div>
<p>The data may be set with the <a class="reference internal" href="method/cfdm.Field.set_data.html#cfdm.Field.set_data" title="cfdm.Field.set_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data</span></code></a> method of the field
construct. The domain axis constructs spanned by the data may also be
set by explicitly providing them via their construct keys. In any
case, the data axes may be set at any time with the
<a class="reference internal" href="method/cfdm.Field.set_data_axes.html#cfdm.Field.set_data_axes" title="cfdm.Field.set_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data_axes</span></code></a> method of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id85">
<div class="code-block-caption"><span class="caption-text"><em>Delete the data and then reinstate it, using the
existing data axes.</em></span><a class="headerlink" href="#id85" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">del_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(1, 10, 9): [[[262.8, ..., 269.7]]] K&gt;</span>
</pre></div>
</div>
</div>
<p>See the section <a class="reference internal" href="#field-creation-in-memory"><span class="std std-ref">field construct creation</span></a> for more examples.</p>
</section>
<section id="date-time">
<span id="id18"></span><h3><a class="toc-backref" href="#id223">Date-time</a><a class="headerlink" href="#date-time" title="Permalink to this headline">¶</a></h3>
<p>Data representing date-times is defined as elapsed times since a
reference date-time in a particular calendar (Gregorian, by
default). The <a class="reference internal" href="attribute/cfdm.Data.array.html#cfdm.Data.array" title="cfdm.Data.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> attribute of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance
(and any construct that contains it) returns the elapsed times, and
the <a class="reference internal" href="attribute/cfdm.Data.datetime_array.html#cfdm.Data.datetime_array" title="cfdm.Data.datetime_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime_array</span></code></a> (and any construct that contains it)
returns the data as an array of date-time objects.</p>
<div class="literal-block-wrapper docutils container" id="id86">
<div class="code-block-caption"><span class="caption-text"><em>View date-times aas elapsed time or as date-time
objects.</em></span><a class="headerlink" href="#id86" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;days since 2004-2-28&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.DatetimeGregorian(2004-02-29 00:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(2004-03-01 00:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(2004-03-02 00:00:00)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;days since 2004-2-28&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;360_day&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.Datetime360Day(2004-02-29 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-02-30 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-03-01 00:00:00)]</span>
</pre></div>
</div>
</div>
</section>
<section id="manipulating-dimensions">
<span id="id19"></span><h3><a class="toc-backref" href="#id224">Manipulating dimensions</a><a class="headerlink" href="#manipulating-dimensions" title="Permalink to this headline">¶</a></h3>
<p>The dimensions of a field construct’s data may be reordered, have size
one dimensions removed and have new new size one dimensions included
by using the following field construct methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.insert_dimension.html#cfdm.Field.insert_dimension" title="cfdm.Field.insert_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insert_dimension</span></code></a></p></td>
<td><p>Insert a new size one data dimension. The
new dimension must correspond to an
existing size one domain axis construct.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.squeeze.html#cfdm.Field.squeeze" title="cfdm.Field.squeeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">squeeze</span></code></a></p></td>
<td><p>Remove size one data dimensions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.transpose.html#cfdm.Field.transpose" title="cfdm.Field.transpose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transpose</span></code></a></p></td>
<td><p>Reorder data dimensions</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id87">
<div class="code-block-caption"><span class="caption-text"><em>Remove all size one dimensions from the data, noting
that metadata constructs which span the corresponding
domain axis construct are not affected.</em></span><a class="headerlink" href="#id87" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span>
<span class="go">&lt;CF Field: air_temperature(grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">dimension_coordinates</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;CF DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;CF DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id88">
<div class="code-block-caption"><span class="caption-text"><em>Insert a new size one dimension, corresponding to a size
one domain axis construct, and then reorder the
dimensions.</em></span><a class="headerlink" href="#id88" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">insert_dimension</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;domainaxis3&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span>
<span class="go">&lt;CF Field: air_temperature(grid_latitude(10), time(1), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">&lt;CF Field: air_temperature(grid_longitude(9), grid_latitude(10), time(1)) K&gt;</span>
</pre></div>
</div>
</div>
<p>When transposing the data dimensions, the dimensions of metadata
construct data are, by default, unchanged. It is also possible to
permute the data dimensions of the metadata constructs so that they
have the same relative order as the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id89">
<div class="code-block-caption"><span class="caption-text"><em>Also permute the data dimension of metadata constructs
using the ‘constructs’ keyword.</em></span><a class="headerlink" href="#id89" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">constructs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="data-mask">
<span id="id20"></span><h3><a class="toc-backref" href="#id225">Data mask</a><a class="headerlink" href="#data-mask" title="Permalink to this headline">¶</a></h3>
<p>There is always a data mask, which may be thought of as a separate
data array of Booleans with the same shape as the original data. The
data mask is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> where the the data has values, and <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> where
the data is missing. The data mask may be inspected with the
<a class="reference internal" href="attribute/cfdm.Data.mask.html#cfdm.Data.mask" title="cfdm.Data.mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask</span></code></a> attribute of the data instance, which returns the
data mask in a field construct with the same metadata constructs as
the original field construct.</p>
<div class="literal-block-wrapper docutils container" id="id90">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the data mask of a field construct.</em></span><a class="headerlink" href="#id90" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
<span class="go">&lt;Data(5, 8): [[False, ..., False]]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id91">
<div class="code-block-caption"><span class="caption-text"><em>Mask the polar rows (see the “Assignment by index”
section) and inspect the new data mask.</em></span><a class="headerlink" href="#id91" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">data</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">masked</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[ True  True  True  True  True  True  True  True]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [ True  True  True  True  True  True  True  True]]</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">_FillValue</span></code> and <code class="docutils literal notranslate"><span class="pre">missing_value</span></code> attributes of the field
construct are <em>not</em> stored as values of the field construct’s
data. They are only used when <span class="xref std std-ref">writing the data to a netCDF
dataset</span>. Therefore testing for missing
data by testing for equality to one of these property values will
produce incorrect results; the <a class="reference internal" href="method/cfdm.Data.any.html#cfdm.Data.any" title="cfdm.Data.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">any</span></code></a> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a>
instance should be used instead.</p>
<div class="literal-block-wrapper docutils container" id="id92">
<div class="code-block-caption"><span class="caption-text"><em>See if any data points are masked.</em></span><a class="headerlink" href="#id92" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<p>The mask of a netCDF dataset array is implied by array values that
meet the criteria implied by the <code class="docutils literal notranslate"><span class="pre">missing_value</span></code>, <code class="docutils literal notranslate"><span class="pre">_FillValue</span></code>,
<code class="docutils literal notranslate"><span class="pre">valid_min</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_max</span></code>, and <code class="docutils literal notranslate"><span class="pre">valid_range</span></code> properties, and is
usually applied automatically by <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a>. NetCDF data elements
that equal the values of the <code class="docutils literal notranslate"><span class="pre">missing_value</span></code> and <code class="docutils literal notranslate"><span class="pre">_FillValue</span></code>
properties are masked, as are data elements that exceed the value of
the <code class="docutils literal notranslate"><span class="pre">valid_max</span></code> property, subceed the value of the <code class="docutils literal notranslate"><span class="pre">valid_min</span></code>
property, or lie outside of the range defined by the <code class="docutils literal notranslate"><span class="pre">valid_range</span></code>
property.</p>
<p>However, this automatic masking may be bypassed by setting the <em>mask</em>
keyword of the <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>. The mask, as defined
in the dataset, may subsequently be applied manually with the
<a class="reference internal" href="method/cfdm.Field.apply_masking.html#cfdm.Field.apply_masking" title="cfdm.Field.apply_masking"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_masking</span></code></a> method of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id93">
<div class="code-block-caption"><span class="caption-text"><em>Read a dataset from disk without automatic masking, and
then manually apply the mask</em></span><a class="headerlink" href="#id93" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;masked_q.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_mask_q</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;masked_q.nc&#39;</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">no_mask_q</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[9.96920997e+36, 9.96920997e+36, 9.96920997e+36, 9.96920997e+36,</span>
<span class="go"> 9.96920997e+36, 9.96920997e+36, 9.96920997e+36, 9.96920997e+36],</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go">[9.96920997e+36, 9.96920997e+36, 9.96920997e+36, 9.96920997e+36,</span>
<span class="go"> 9.96920997e+36, 9.96920997e+36, 9.96920997e+36, 9.96920997e+36]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masked_q</span> <span class="o">=</span> <span class="n">no_mask_q</span><span class="o">.</span><span class="n">apply_masking</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">masked_q</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[   --    --    --    --    --    --    --    --]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [   --    --    --    --    --    --    --    --]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cfdm.Field.apply_masking.html#cfdm.Field.apply_masking" title="cfdm.Field.apply_masking"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_masking</span></code></a> method of the field construct utilises as
many of the <code class="docutils literal notranslate"><span class="pre">missing_value</span></code>, <code class="docutils literal notranslate"><span class="pre">_FillValue</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_min</span></code>,
<code class="docutils literal notranslate"><span class="pre">valid_max</span></code>, and <code class="docutils literal notranslate"><span class="pre">valid_range</span></code> properties as are present and may
be used on any construct, not just those that have been read from
datasets.</p>
</section>
<section id="indexing">
<span id="id21"></span><h3><a class="toc-backref" href="#id226">Indexing</a><a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h3>
<p>When a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance is indexed a new instance is created for the
part of the data defined by the indices. Indexing follows rules that
are very similar to the <a class="reference external" href="https://numpy.org/doc/stable/user/basics.indexing.html">numpy indexing rules</a>,
the only differences being:</p>
<ul class="simple">
<li><p>An integer index <em>i</em> specified for a dimension reduces the size of
this dimension to unity, taking just the <em>i</em>-th element, but keeps
the dimension itself, so that the rank of the array is not reduced.</p></li>
</ul>
<ul class="simple">
<li><p>When two or more dimensions’ indices are sequences of integers then
these indices work independently along each dimension (similar to
the way vector subscripts work in Fortran). This is the same
indexing behaviour as on a <code class="docutils literal notranslate"><span class="pre">Variable</span></code> object of the <a class="reference external" href="http://unidata.github.io/netcdf4-python">netCDF4
package</a>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id94">
<div class="code-block-caption"><span class="caption-text"><em>Create new data by indexing and show the shape
corresponding to the indices.</em></span><a class="headerlink" href="#id94" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 1, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 3, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 1)</span>
</pre></div>
</div>
</div>
</section>
<section id="assignment">
<span id="id22"></span><h3><a class="toc-backref" href="#id227">Assignment</a><a class="headerlink" href="#assignment" title="Permalink to this headline">¶</a></h3>
<p>Values can be changed by assigning to elements selected by indices of
the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance using rules that are very similar to the <a class="reference external" href="https://numpy.org/doc/stable/user/basics.indexing.html">numpy
indexing rules</a>,
the only difference being:</p>
<ul class="simple">
<li><p>When two or more dimensions’ indices are sequences of integers then
these indices work independently along each dimension (similar to
the way vector subscripts work in Fortran). This is the same
indexing behaviour as on a <code class="docutils literal notranslate"><span class="pre">Variable</span></code> object of the <a class="reference external" href="http://unidata.github.io/netcdf4-python">netCDF4
package</a>.</p></li>
</ul>
<p>A single value may be assigned to any number of elements.</p>
<div class="literal-block-wrapper docutils container" id="id95">
<div class="code-block-caption"><span class="caption-text"><em>Set a single element to -1, a “column” of elements
to -2 and a “square” of elements to -3.</em></span><a class="headerlink" href="#id95" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2 279.6 270.2 280.0 272.5 263.7]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2  -2.0 262.5  -3.0  -3.0  -3.0 270.4 268.6 275.3]</span>
<span class="go">  [263.9  -2.0 272.1  -3.0  -3.0  -3.0 260.0 263.5 270.2]</span>
<span class="go">  [273.8  -2.0 268.5  -3.0  -3.0  -3.0 270.6 273.0 270.6]</span>
<span class="go">  [267.9  -2.0 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<p>An array of values can be assigned, as long as it is broadcastable to
the shape defined by the indices, using the <a class="reference external" href="https://numpy.org/doc/stable/user/basics.broadcasting.html">numpy broadcasting rules</a>.</p>
<div class="literal-block-wrapper docutils container" id="id96">
<div class="code-block-caption"><span class="caption-text"><em>Overwrite the square of values of -3 with the numbers 0
to 8, and set the corners of a different square to be
either -4 or -5.</em></span><a class="headerlink" href="#id96" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span> <span class="o">=</span>  <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2  -4.0 270.2 280.0 272.5  -5.0]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2  -2.0 262.5   6.0   7.0   8.0 270.4 268.6 275.3]</span>
<span class="go">  [263.9  -2.0 272.1   3.0   4.0   5.0 260.0 263.5 270.2]</span>
<span class="go">  [273.8  -2.0 268.5   0.0   1.0   2.0 270.6 273.0 270.6]</span>
<span class="go">  [267.9  -2.0 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1  -4.0 268.1 277.0 273.4  -5.0]]]</span>
</pre></div>
</div>
</div>
<p>Data array elements may be set to missing values by assigning them to
the <a class="reference internal" href="constant.html#cfdm.cfdm.masked" title="cfdm.cfdm.masked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.masked</span></code></a> constant. Missing values may be unmasked by
assigning them to any other value.</p>
<div class="literal-block-wrapper docutils container" id="id97">
<div class="code-block-caption"><span class="caption-text"><em>Set a column of elements to missing values, and then
change one of them back to a non-missing value.</em></span><a class="headerlink" href="#id97" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">masked</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5    -- 269.2]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2    -- 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2  -4.0 270.2 280.0    --  -5.0]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9    -- 260.6]</span>
<span class="go">  [264.2  -2.0 262.5   6.0   7.0   8.0 270.4    -- 275.3]</span>
<span class="go">  [263.9  -2.0 272.1   3.0   4.0   5.0 260.0  -6.0 270.2]</span>
<span class="go">  [273.8  -2.0 268.5   0.0   1.0   2.0 270.6    -- 270.6]</span>
<span class="go">  [267.9  -2.0 279.8 260.3 261.2 275.3 271.2    -- 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0    -- 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1  -4.0 268.1 277.0    --  -5.0]]]</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="subspacing">
<span id="id25"></span><h2><a class="toc-backref" href="#id228"><strong>Subspacing</strong></a><a class="headerlink" href="#subspacing" title="Permalink to this headline">¶</a></h2>
<p>Creation of a new field construct which spans a subspace of the domain
of an existing field construct is achieved by indexing the field
itself, rather than its <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance. This is because the operation
must also subspace any metadata constructs of the field construct
(e.g. coordinate metadata constructs) which span any of the
<a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis constructs</span></a> that are affected. The new field
construct is created with the same properties as the original
field. Subspacing uses the same <a class="reference internal" href="#indexing"><span class="std std-ref">cfdm indexing rules</span></a>
that apply to the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> class.</p>
<div class="literal-block-wrapper docutils container" id="id98">
<div class="code-block-caption"><span class="caption-text"><em>Create a new field whose domain spans the first longitude
of the original, and with a reversed latitude axis.</em></span><a class="headerlink" href="#id98" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(1)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(5) = [75.0, ..., -75.0] degrees_north</span>
<span class="go">                : longitude(1) = [22.5] degrees_east</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="selecting-metadata-constructs">
<span id="id26"></span><h2><a class="toc-backref" href="#id229"><strong>Selecting metadata constructs</strong></a><a class="headerlink" href="#selecting-metadata-constructs" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance has filtering methods for selecting constructs
that meet various criteria:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Filter criteria</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter.html#cfdm.Constructs.filter" title="cfdm.Constructs.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a></p></td>
<td><p>General purpose interface to all other filter methods</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_identity.html#cfdm.Constructs.filter_by_identity" title="cfdm.Constructs.filter_by_identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_identity</span></code></a></p></td>
<td><p>Metadata construct identity</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_type.html#cfdm.Constructs.filter_by_type" title="cfdm.Constructs.filter_by_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_type</span></code></a></p></td>
<td><p>Metadata construct type</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_property.html#cfdm.Constructs.filter_by_property" title="cfdm.Constructs.filter_by_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_property</span></code></a></p></td>
<td><p>Property values</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_axis.html#cfdm.Constructs.filter_by_axis" title="cfdm.Constructs.filter_by_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_axis</span></code></a></p></td>
<td><p>The <a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis constructs</span></a> spanned by the data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_naxes.html#cfdm.Constructs.filter_by_naxes" title="cfdm.Constructs.filter_by_naxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_naxes</span></code></a></p></td>
<td><p>The number of <a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis constructs</span></a> spanned by the data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_size.html#cfdm.Constructs.filter_by_size" title="cfdm.Constructs.filter_by_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_size</span></code></a></p></td>
<td><p>The size <a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis constructs</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_measure.html#cfdm.Constructs.filter_by_measure" title="cfdm.Constructs.filter_by_measure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_measure</span></code></a></p></td>
<td><p>Measure value (for cell measure constructs)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_method.html#cfdm.Constructs.filter_by_method" title="cfdm.Constructs.filter_by_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_method</span></code></a></p></td>
<td><p>Method value (for cell method constructs)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_data.html#cfdm.Constructs.filter_by_data" title="cfdm.Constructs.filter_by_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_data</span></code></a></p></td>
<td><p>Whether or not there could be be data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_key.html#cfdm.Constructs.filter_by_key" title="cfdm.Constructs.filter_by_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_key</span></code></a></p></td>
<td><p>Construct key</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_ncvar.html#cfdm.Constructs.filter_by_ncvar" title="cfdm.Constructs.filter_by_ncvar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_ncvar</span></code></a></p></td>
<td><p>NetCDF variable name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Constructs.filter_by_ncdim.html#cfdm.Constructs.filter_by_ncdim" title="cfdm.Constructs.filter_by_ncdim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_ncdim</span></code></a></p></td>
<td><p>NetCDF dimension name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>)</p></td>
</tr>
</tbody>
</table>
<p>The <a class="reference internal" href="method/cfdm.Constructs.filter.html#cfdm.Constructs.filter" title="cfdm.Constructs.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a> method of a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance allows
these filters to be chained together in a single call.</p>
<p>Each of these methods returns a new <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance by default
that contains the selected constructs.</p>
<div class="literal-block-wrapper docutils container" id="id99">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their type</em>.</span><a class="headerlink" href="#id99" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;cell_method&#39;</span><span class="p">,</span> <span class="s1">&#39;field_ancillary&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id100">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their properties</em>.</span><a class="headerlink" href="#id100" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">units</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="s1">&#39;or&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary0&#39;: &lt;DomainAncillary: ncvar%a(1) m&gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id101">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs whose data span at least one of the
‘grid_latitude’ and ‘grid_longitude’ domain axis constructs.</em></span><a class="headerlink" href="#id101" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_axis</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;grid_longitude&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">axis_mode</span><span class="o">=</span><span class="s1">&#39;or&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id102">
<div class="code-block-caption"><span class="caption-text"><em>Get cell measure constructs by their “measure”.</em></span><a class="headerlink" href="#id102" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_measure</span><span class="p">(</span><span class="s1">&#39;area&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id103">
<div class="code-block-caption"><span class="caption-text"><em>Get cell method constructs by their “method”.</em></span><a class="headerlink" href="#id103" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_method</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;}</span>
</pre></div>
</div>
</div>
<p>As each of these methods returns a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance by default,
it is easy to perform further filters on their results:</p>
<div class="literal-block-wrapper docutils container" id="id104">
<div class="code-block-caption"><span class="caption-text"><em>Make selections from previous selections.</em></span><a class="headerlink" href="#id104" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;auxiliary_coordinate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter_by_axis</span><span class="p">(</span><span class="s1">&#39;domainaxis2&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;}</span>
</pre></div>
</div>
</div>
<p>Filters can also be chained with the <a class="reference internal" href="method/cfdm.Constructs.filter.html#cfdm.Constructs.filter" title="cfdm.Constructs.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a> method of a
<a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance</p>
<div class="literal-block-wrapper docutils container" id="id105">
<div class="code-block-caption"><span class="caption-text"><em>Make a chain of selections.</em></span><a class="headerlink" href="#id105" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_by_type</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">,),</span>
<span class="gp">... </span>                        <span class="n">filter_by_property</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;}</span>
</pre></div>
</div>
</div>
<p>If the result are only required as a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>, rather than a
<a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance, the “todict” parameter can be used to give
faster performance:</p>
<div class="literal-block-wrapper docutils container" id="id106">
<div class="code-block-caption"><span class="caption-text"><em>Make a chain of selections and return as a dictionary.</em></span><a class="headerlink" href="#id106" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_by_type</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">,),</span>
<span class="gp">... </span>                        <span class="n">filter_by_property</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
<span class="gp">... </span>                        <span class="n">todict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">dict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;}</span>
</pre></div>
</div>
</div>
<p>Filters can also be chained with the <a class="reference internal" href="method/cfdm.Constructs.filter.html#cfdm.Constructs.filter" title="cfdm.Constructs.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a> method of a
<a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance</p>
<div class="literal-block-wrapper docutils container" id="id107">
<div class="code-block-caption"><span class="caption-text"><em>Make a chain of selections.</em></span><a class="headerlink" href="#id107" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_by_type</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">,),</span>
<span class="gp">... </span>                        <span class="n">filter_by_property</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;}</span>
</pre></div>
</div>
</div>
<p>Another method of selection is by metadata construct “identity”.
Construct identities are used to describe constructs when they are
inspected, and so it is often convenient to copy these identities
when selecting metadata constructs. For example, the <a class="reference internal" href="#medium-detail"><span class="std std-ref">three
auxiliary coordinate constructs</span></a> in the field
construct <code class="docutils literal notranslate"><span class="pre">t</span></code> have identities <code class="docutils literal notranslate"><span class="pre">'latitude'</span></code>, <code class="docutils literal notranslate"><span class="pre">'longitude'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'long_name=Grid</span> <span class="pre">latitude</span> <span class="pre">name'</span></code>.</p>
<p>A construct’s identity may be any one of the following</p>
<ul class="simple">
<li><p>The value of the <code class="docutils literal notranslate"><span class="pre">standard_name</span></code> property,
e.g. <code class="docutils literal notranslate"><span class="pre">'air_temperature'</span></code>,</p></li>
<li><p>The value of any property, preceded by the property name and an
equals, e.g. <code class="docutils literal notranslate"><span class="pre">'long_name=Air</span> <span class="pre">Temperature'</span></code>, <code class="docutils literal notranslate"><span class="pre">'axis=X'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'foo=bar'</span></code>, etc.,</p></li>
<li><p>The cell measure, preceded by “measure:”,
e.g. <code class="docutils literal notranslate"><span class="pre">'measure:volume'</span></code></p></li>
<li><p>The cell method, preceded by “method:”, e.g. <code class="docutils literal notranslate"><span class="pre">'method:maximum'</span></code></p></li>
<li><p>The netCDF variable name, preceded by “ncvar%”,
e.g. <code class="docutils literal notranslate"><span class="pre">'ncvar%tas'</span></code> (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>),</p></li>
<li><p>The netCDF dimension name, preceded by “ncdim%” e.g. <code class="docutils literal notranslate"><span class="pre">'ncdim%z'</span></code>
(see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>), and</p></li>
<li><p>The construct key, preceded by “key%”
e.g. <code class="docutils literal notranslate"><span class="pre">'key%auxiliarycoordinate2'</span></code>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id108">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their identity.</em></span><a class="headerlink" href="#id108" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.81, ..., 0.78]] K</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., kappa]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;long_name=Grid latitude name&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;ncvar%b&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary1&#39;: &lt;DomainAncillary: ncvar%b(1) &gt;}</span>
</pre></div>
</div>
</div>
<p>Each construct has an <code class="xref py py-obj docutils literal notranslate"><span class="pre">identity</span></code> method that, by default, returns the
least ambiguous identity (defined in the documentation of a
construct’s <code class="xref py py-obj docutils literal notranslate"><span class="pre">identity</span></code> method); and an <code class="xref py py-obj docutils literal notranslate"><span class="pre">identities</span></code> method that
returns a list of all of the identities that would select the
construct.</p>
<p>As a further convenience, selection by construct identity is also
possible by providing identities to a call of a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance
itself, and this technique for selecting constructs by identity will be
used in the rest of this tutorial:</p>
<div class="literal-block-wrapper docutils container" id="id109">
<div class="code-block-caption"><span class="caption-text"><em>Construct selection by identity is possible with via the
“filter_by_identity” method, or directly from the
“Constructs” instance.</em></span><a class="headerlink" href="#id109" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
</pre></div>
</div>
</div>
<p>Selection by construct key is useful for systematic metadata construct
access, or for when a metadata construct is not identifiable by other
means:</p>
<div class="literal-block-wrapper docutils container" id="id110">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by construct key.</em></span><a class="headerlink" href="#id110" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;domainancillary2&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary2&#39;: &lt;DomainAncillary: surface_altitude(10, 9) m&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;cellmethod1&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;auxiliarycoordinate2&#39;</span><span class="p">,</span> <span class="s1">&#39;cellmeasure0&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
<p>If no constructs match the given criteria, then an “empty”
<a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance is returned:</p>
<div class="literal-block-wrapper docutils container" id="id111">
<div class="code-block-caption"><span class="caption-text"><em>If no constructs meet the criteria then an empty
“Constructs” object is returned.</em></span><a class="headerlink" href="#id111" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;radiation_wavelength&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;Constructs: &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<p>The constructs that were <em>not</em> selected by a filter may be returned by
the <a class="reference internal" href="method/cfdm.Constructs.inverse_filter.html#cfdm.Constructs.inverse_filter" title="cfdm.Constructs.inverse_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_filter</span></code></a> method applied to the results of
filters:</p>
<div class="literal-block-wrapper docutils container" id="id112">
<div class="code-block-caption"><span class="caption-text"><em>Get the constructs that were not selected by a filter.</em></span><a class="headerlink" href="#id112" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;auxiliary_coordinate&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;Constructs: auxiliary_coordinate(3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">inverse_filter</span><span class="p">()</span>
<span class="go">&lt;Constructs: cell_measure(1), cell_method(2), coordinate_reference(2), dimension_coordinate(4), domain_ancillary(3), domain_axis(4), field_ancillary(1)&gt;</span>
</pre></div>
</div>
</div>
<p>Note that selection by construct type is equivalent to using the
particular method of the field construct for retrieving that type of
metadata construct:</p>
<div class="literal-block-wrapper docutils container" id="id113">
<div class="code-block-caption"><span class="caption-text"><em>The bespoke methods for retrieving constructs by type
are equivalent to a selection on all of the metadata
constructs.</em></span><a class="headerlink" href="#id113" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;cell_measure&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">cell_measures</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="metadata-construct-access">
<span id="id27"></span><h2><a class="toc-backref" href="#id230"><strong>Metadata construct access</strong></a><a class="headerlink" href="#metadata-construct-access" title="Permalink to this headline">¶</a></h2>
<p>An individual metadata construct may be returned, without its
construct key, by any of the following techniques:</p>
<ul class="simple">
<li><p>with the <a class="reference internal" href="method/cfdm.Field.construct.html#cfdm.Field.construct" title="cfdm.Field.construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct</span></code></a> method of a field construct,</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id114">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct with its construct
identity.</em></span><a class="headerlink" href="#id114" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>with the <a class="reference internal" href="method/cfdm.Field.construct_key.html#cfdm.Field.construct_key" title="cfdm.Field.construct_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct_key</span></code></a> method of a field construct:</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id115">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct key with its construct
identity and use the key to get the construct itself</em></span><a class="headerlink" href="#id115" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>with the <a class="reference internal" href="method/cfdm.Field.construct_item.html#cfdm.Field.construct_item" title="cfdm.Field.construct_item"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct_item</span></code></a> method of a field construct:</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id116">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct and its identifier
via its construct identity.</em></span><a class="headerlink" href="#id116" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_item</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="go">(&#39;auxiliarycoordinate0&#39;, &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>by indexing a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance with  a construct key.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id117">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct via its construct
key and indexing</em></span><a class="headerlink" href="#id117" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>with the <a class="reference internal" href="method/cfdm.Constructs.get.html#cfdm.Constructs.get" title="cfdm.Constructs.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a> method of a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance, or</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id118">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct via its construct
key and the ‘get’ method.</em></span><a class="headerlink" href="#id118" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">&lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cfdm.Field.construct.html#cfdm.Field.construct" title="cfdm.Field.construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct</span></code></a> method of the field construct and the
<a class="reference internal" href="method/cfdm.Constructs.value.html#cfdm.Constructs.value" title="cfdm.Constructs.value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value</span></code></a> method of the <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance will raise an
exception of there is not a unique metadata construct to return, but
this may be replaced with returning a default value or raising a
customised exception:</p>
<div class="literal-block-wrapper docutils container" id="id119">
<div class="code-block-caption"><span class="caption-text"><em>By default an exception is raised if there is not a
unique construct that meets the criteria. Alternatively,
the value of the “default” parameter is returned.</em></span><a class="headerlink" href="#id119" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:volume&#39;</span><span class="p">)</span>                <span class="c1"># Raises Exception</span>
<span class="gt">Traceback (most recent call last):</span>
   <span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Can&#39;t return zero constructs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:volume&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:volume&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;my error&quot;</span><span class="p">))</span>  <span class="c1"># Raises Exception</span>
<span class="gt">Traceback (most recent call last):</span>
   <span class="c">...</span>
<span class="gr">Exception</span>: <span class="n">my error</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_measure</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s2">&quot;units=degrees&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s2">&quot;units=degrees&quot;</span><span class="p">)</span>  <span class="c1"># Raises Exception</span>
<span class="gt">Traceback (most recent call last):</span>
   <span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Field.construct() can&#39;t return 2 constructs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s2">&quot;units=degrees&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
<span class="go">None</span>
</pre></div>
</div>
</div>
<section id="metadata-construct-properties">
<span id="id28"></span><h3><a class="toc-backref" href="#id231">Metadata construct properties</a><a class="headerlink" href="#metadata-construct-properties" title="Permalink to this headline">¶</a></h3>
<p>Metadata constructs share the <a class="reference internal" href="#properties"><span class="std std-ref">same API as the field construct</span></a> for accessing their properties:</p>
<div class="literal-block-wrapper docutils container" id="id120">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the “longitude” metadata construct, set a new
property, and then inspect all of the properties.</em></span><a class="headerlink" href="#id120" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span>
<span class="go">&lt;DimensionCoordinate: longitude(8) degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;units&#39;: &#39;degrees_east&#39;,</span>
<span class="go"> &#39;long_name&#39;: &#39;Longitude&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;longitude&#39;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id121">
<div class="code-block-caption"><span class="caption-text"><em>Get the metadata construct with units of “km2”, find its
canonical identity, and all of its valid identities, that
may be used for selection by the “filter_by_identity”
method</em></span><a class="headerlink" href="#id121" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;km2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CellMeasure: measure:area(9, 10) km2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">&#39;measure:area&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">identities</span><span class="p">()</span>
<span class="go">[&#39;measure:area&#39;, &#39;units=km2&#39;, &#39;ncvar%cell_measure&#39;]</span>
</pre></div>
</div>
</div>
</section>
<section id="metadata-construct-data">
<span id="id29"></span><h3><a class="toc-backref" href="#id232">Metadata construct data</a><a class="headerlink" href="#metadata-construct-data" title="Permalink to this headline">¶</a></h3>
<p>Metadata constructs share the <a class="reference internal" href="#data"><span class="std std-ref">a similar API as the field
construct</span></a> as the field construct for accessing their data:</p>
<div class="literal-block-wrapper docutils container" id="id122">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the “longitude” metadata construct, inspect its
data, change the third element of the array, and get the
data as a numpy array.</em></span><a class="headerlink" href="#id122" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span>
<span class="go">&lt;DimensionCoordinate: longitude(8) degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(8): [22.5, ..., 337.5] degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&lt;Data(1): [112.5] degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">133.33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[22.5 67.5 133.33 157.5 202.5 247.5 292.5 337.5]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis constructs</span></a> spanned by a particular metadata
construct’s data are found with the <a class="reference internal" href="method/cfdm.Constructs.get_data_axes.html#cfdm.Constructs.get_data_axes" title="cfdm.Constructs.get_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_axes</span></code></a> method
of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id123">
<div class="code-block-caption"><span class="caption-text"><em>Find the construct keys of the domain axis constructs
spanned by the data of each metadata construct.</em></span><a class="headerlink" href="#id123" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span>
<span class="go">&#39;auxiliarycoordinate0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
<span class="go">(&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
</pre></div>
</div>
</div>
<p>The domain axis constructs spanned by all the data of all metadata
construct may be found with the <a class="reference internal" href="method/cfdm.Constructs.data_axes.html#cfdm.Constructs.data_axes" title="cfdm.Constructs.data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data_axes</span></code></a> method of the
field construct’s <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance:</p>
<div class="literal-block-wrapper docutils container" id="id124">
<div class="code-block-caption"><span class="caption-text"><em>Find the construct keys of the domain axis constructs
spanned by the data of each metadata construct.</em></span><a class="headerlink" href="#id124" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">data_axes</span><span class="p">()</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;),</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: (&#39;domainaxis2&#39;, &#39;domainaxis1&#39;),</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;cellmeasure0&#39;: (&#39;domainaxis2&#39;, &#39;domainaxis1&#39;),</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: (&#39;domainaxis2&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: (&#39;domainaxis3&#39;,),</span>
<span class="go"> &#39;domainancillary0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;domainancillary1&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;domainancillary2&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;),</span>
<span class="go"> &#39;fieldancillary0&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)}</span>
</pre></div>
</div>
</div>
<p>A size one domain axis construct that is <em>not</em> spanned by the field
construct’s data may still be spanned by the data of metadata
constructs. For example, the data of the field construct <code class="docutils literal notranslate"><span class="pre">t</span></code>
<a class="reference internal" href="#data-axes"><span class="std std-ref">does not span the size one domain axis construct</span></a>
with key <code class="docutils literal notranslate"><span class="pre">'domainaxis3'</span></code>, but this domain axis construct is spanned
by a “time” dimension coordinate construct (with key
<code class="docutils literal notranslate"><span class="pre">'dimensioncoordinate3'</span></code>). Such a dimension coordinate (i.e. one
that applies to a domain axis construct that is not spanned by the
field construct’s data) corresponds to a CF-netCDF scalar coordinate
variable.</p>
<hr class="docutils" />
</section>
</section>
<section id="time">
<span id="id30"></span><h2><a class="toc-backref" href="#id233"><strong>Time</strong></a><a class="headerlink" href="#time" title="Permalink to this headline">¶</a></h2>
<p>Constructs representing elapsed time (identified by the presence of
“reference time” units) have data array values that represent elapsed
time since a reference date. These values may be converted into the
date-time objects of the <a class="reference external" href="https://unidata.github.io/cftime/">cftime package</a> with the <a class="reference internal" href="attribute/cfdm.Data.datetime_array.html#cfdm.Data.datetime_array" title="cfdm.Data.datetime_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime_array</span></code></a>
method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<div class="literal-block-wrapper docutils container" id="id125">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the the values of a “time” construct as elapsed
times and as date-times.</em></span><a class="headerlink" href="#id125" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span>
<span class="go">&lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">)</span>
<span class="go">&#39;days since 2018-12-01&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;calendar&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span>
<span class="go">&#39;standard&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[ 31.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.DatetimeGregorian(2019, 1, 1, 0, 0, 0, 0, 1, 1)]</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="domain">
<span id="id32"></span><h2><a class="toc-backref" href="#id234"><strong>Domain</strong></a><a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="cf_data_model.html#cf-data-model"><span class="std std-ref">domain of the CF data model</span></a> is defined
collectively by various other metadata constructs. It is represented
by the <a class="reference internal" href="class/cfdm.Domain.html#cfdm.Domain" title="cfdm.Domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Domain</span></code></a> class. A domain construct may exist independently, or
is accessed from a field construct with its <a class="reference internal" href="attribute/cfdm.Field.domain.html#cfdm.Field.domain" title="cfdm.Field.domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain</span></code></a> attribute,
or <a class="reference internal" href="method/cfdm.Field.get_domain.html#cfdm.Field.get_domain" title="cfdm.Field.get_domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_domain</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id126">
<div class="code-block-caption"><span class="caption-text"><em>Get the domain, and inspect it.</em></span><a class="headerlink" href="#id126" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span>
<span class="go">&lt;Domain: {1, 1, 9, 10}&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
<span class="go">Dimension coords: atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., kappa]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">description</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The domain construct returned by a field construct is not independent
of its parent field instance, i.e. changes to domain construct are
seen by the field construct, and vice versa. This is because, in this
case, the domain instance is a “view” of the relevant metadata
constructs contained in the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id127">
<div class="code-block-caption"><span class="caption-text"><em>Change a property of a metadata construct of the domain
and show that this change appears in the same metadata
data construct of the parent field, and vice versa.</em></span><a class="headerlink" href="#id127" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;set by domain&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">field_latitude</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
<span class="go">set by domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;set by field&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
<span class="go">set by field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">&#39;set by field&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="domain-axes">
<span id="id33"></span><h2><a class="toc-backref" href="#id235"><strong>Domain axes</strong></a><a class="headerlink" href="#domain-axes" title="Permalink to this headline">¶</a></h2>
<p>A domain axis metadata construct specifies the number of points along
an independent axis of the field construct’s domain and is stored in a
<a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a> instance. The size of the axis is retrieved with
the <a class="reference internal" href="method/cfdm.DomainAxis.get_size.html#cfdm.DomainAxis.get_size" title="cfdm.DomainAxis.get_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code></a> method of the domain axis construct.</p>
<div class="literal-block-wrapper docutils container" id="id128">
<div class="code-block-caption"><span class="caption-text"><em>Get the size of a domain axis construct.</em></span><a class="headerlink" href="#id128" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;DomainAxis: size(5)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;DomainAxis: size(8)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domainaxis1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">&lt;DomainAxis: size(8)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="coordinates">
<span id="id34"></span><h2><a class="toc-backref" href="#id236"><strong>Coordinates</strong></a><a class="headerlink" href="#coordinates" title="Permalink to this headline">¶</a></h2>
<p>There are two types of coordinate construct, <a class="reference internal" href="cf_data_model.html#term-dimension-coordinate-constructs"><span class="xref std std-term">dimension</span></a> and <a class="reference internal" href="cf_data_model.html#term-auxiliary-coordinate-constructs"><span class="xref std std-term">auxiliary coordinate
constructs</span></a>, which can be retrieved together with the
<a class="reference internal" href="method/cfdm.Field.coordinates.html#cfdm.Field.coordinates" title="cfdm.Field.coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinates</span></code></a> method of the field construct, as well as
individually with the <a class="reference internal" href="method/cfdm.Field.auxiliary_coordinates.html#cfdm.Field.auxiliary_coordinates" title="cfdm.Field.auxiliary_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auxiliary_coordinates</span></code></a> and
<a class="reference internal" href="method/cfdm.Field.dimension_coordinates.html#cfdm.Field.dimension_coordinates" title="cfdm.Field.dimension_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimension_coordinates</span></code></a> methods.</p>
<div class="literal-block-wrapper docutils container" id="id129">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve both types of coordinate constructs.</em></span><a class="headerlink" href="#id129" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinates</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
</pre></div>
</div>
</div>
<section id="bounds">
<span id="id35"></span><h3><a class="toc-backref" href="#id237">Bounds</a><a class="headerlink" href="#bounds" title="Permalink to this headline">¶</a></h3>
<p>A coordinate construct may contain an array of cell bounds that
provides the extent of each cell by defining the locations of the cell
vertices. This is in addition to the main coordinate data array that
contains a representative grid point location for each cell. The cell
bounds are stored in a <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> class instance that is accessed with
the <code class="xref py py-obj docutils literal notranslate"><span class="pre">bounds</span></code> attribute, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bounds</span></code>
method, of the coordinate construct.</p>
<p>A <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> instance shares the <a class="reference internal" href="#data"><span class="std std-ref">the same API as the field
construct</span></a> for accessing its data.</p>
<div class="literal-block-wrapper docutils container" id="id130">
<div class="code-block-caption"><span class="caption-text"><em>Get the Bounds instance of a coordinate construct and
inspect its data.</em></span><a class="headerlink" href="#id130" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">lon</span><span class="o">.</span><span class="n">bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span>
<span class="go">&lt;Bounds: grid_longitude(9, 2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(9, 2): [[-4.92, ..., -0.96]]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[-4.92 -4.48]</span>
<span class="go"> [-4.48 -4.04]</span>
<span class="go"> [-4.04 -3.6 ]</span>
<span class="go"> [-3.6  -3.16]</span>
<span class="go"> [-3.16 -2.72]</span>
<span class="go"> [-2.72 -2.28]</span>
<span class="go"> [-2.28 -1.84]</span>
<span class="go"> [-1.84 -1.4 ]</span>
<span class="go"> [-1.4  -0.96]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> instance inherits the descriptive properties from its
parent coordinate construct, but it may also have its own properties
(although setting these is not recommended).</p>
<div class="literal-block-wrapper docutils container" id="id131">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the inherited and bespoke properties of a Bounds
instance.</em></span><a class="headerlink" href="#id131" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">inherited_properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;grid_longitude&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;degrees&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
</div>
</section>
<section id="geometry-cells">
<span id="id36"></span><h3><a class="toc-backref" href="#id238">Geometry cells</a><a class="headerlink" href="#geometry-cells" title="Permalink to this headline">¶</a></h3>
<p>For many geospatial applications, cell bounds can not be represented
by a simple line or polygon, and different cells may have different
numbers of nodes describing their bounds. For example, if each cell
describes the areal extent of a watershed, then it is likely that some
watersheds will require more nodes than others. Such cells are called
<a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#geometries">geometries</a>.</p>
<p>If a coordinate construct represents geometries then it will have a
“geometry” attribute (not a <a class="reference internal" href="#metadata-construct-properties"><span class="std std-ref">CF property</span></a>) with one of the values <code class="docutils literal notranslate"><span class="pre">'point'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'line'</span></code> or <code class="docutils literal notranslate"><span class="pre">'polygon'</span></code>.</p>
<p>This is illustrated with the file <code class="docutils literal notranslate"><span class="pre">geometry.nc</span></code> (found in the
<a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id132">
<div class="code-block-caption"><span class="caption-text"><em>Read and inspect a dataset containing geometry cell
bounds.</em></span><a class="headerlink" href="#id132" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;geometry.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Field: precipitation_amount (ncvar%pr)</span>
<span class="go">--------------------------------------</span>
<span class="go">Data            : precipitation_amount(cf_role=timeseries_id(2), time(4))</span>
<span class="go">Dimension coords: time(4) = [2000-01-02 00:00:00, ..., 2000-01-05 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(cf_role=timeseries_id(2)) = [25.0, 7.0] degrees_north</span>
<span class="go">                : longitude(cf_role=timeseries_id(2)) = [10.0, 40.0] degrees_east</span>
<span class="go">                : altitude(cf_role=timeseries_id(2)) = [5000.0, 20.0] m</span>
<span class="go">                : cf_role=timeseries_id(cf_role=timeseries_id(2)) = [b&#39;x1&#39;, b&#39;y2&#39;]</span>
<span class="go">Coord references: grid_mapping_name:latitude_longitude</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Auxiliary coordinate: longitude</span>
<span class="go">   standard_name = &#39;longitude&#39;</span>
<span class="go">   units = &#39;degrees_east&#39;</span>
<span class="go">   Data(2) = [10.0, 40.0] degrees_east</span>
<span class="go">   Geometry: polygon</span>
<span class="go">   Bounds:axis = &#39;X&#39;</span>
<span class="go">   Bounds:standard_name = &#39;longitude&#39;</span>
<span class="go">   Bounds:units = &#39;degrees_east&#39;</span>
<span class="go">   Bounds:Data(2, 3, 4) = [[[20.0, ..., --]]] degrees_east</span>
<span class="go">   Interior Ring:Data(2, 3) = [[0, ..., --]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span>
<span class="go">&#39;polygon&#39;</span>
</pre></div>
</div>
</div>
<p>Bounds for geometry cells are also stored in a <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> instance, but
one that always has <em>two</em> extra trailing dimensions (rather than
one). The fist trailing dimension indexes the distinct parts of a
geometry, and the second indexes the nodes of each part. When a part
has fewer nodes than another, its nodes dimension is padded with
missing data.</p>
<div class="literal-block-wrapper docutils container" id="id133">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the geometry nodes.</em></span><a class="headerlink" href="#id133" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[20.0 10.0  0.0   --]</span>
<span class="go"> [ 5.0 10.0 15.0 10.0]</span>
<span class="go"> [20.0 10.0  0.0   --]]</span>

<span class="go">[[50.0 40.0 30.0   --]</span>
<span class="go"> [  --   --   --   --]</span>
<span class="go"> [  --   --   --   --]]]</span>
</pre></div>
</div>
</div>
<p>If a cell is composed of multiple polygon parts, an individual polygon
may define an “interior ring”, i.e. a region that is to be omitted
from, as opposed to included in, the cell extent. Such cells also have
an interior ring array that spans the same domain axes as the
coordinate cells, with the addition of one extra dimension that
indexes the parts for each cell. This array records whether each
polygon is to be included or excluded from the cell, with values of
<code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span></code> respectively.</p>
<div class="literal-block-wrapper docutils container" id="id134">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the interior ring information.</em></span><a class="headerlink" href="#id134" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">get_interior_ring</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0  1  0]</span>
<span class="go"> [0 -- --]]</span>
</pre></div>
</div>
</div>
<p>Note that it is preferable to access the data type, number of
dimensions, dimension sizes and number of elements of the coordinate
construct via the construct’s attributes, rather than the attributes
of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance that provides representative values for each
cell. This is because the representative cell values for geometries
are optional, and if they are missing then the construct attributes
are able to infer these attributes from the bounds.</p>
<p>When a field construct containing geometries is written to disk, a
CF-netCDF geometry container variable is automatically created, and
the cells encoded with the <a class="reference internal" href="#compression"><span class="std std-ref">compression</span></a> techniques
defined in the CF conventions.</p>
<hr class="docutils" />
</section>
</section>
<section id="domain-ancillaries">
<span id="id37"></span><h2><a class="toc-backref" href="#id239"><strong>Domain ancillaries</strong></a><a class="headerlink" href="#domain-ancillaries" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="cf_data_model.html#term-domain-ancillary-constructs"><span class="xref std std-term">domain ancillary</span></a> construct
provides information which is needed for computing the location of
cells in an alternative <a class="reference internal" href="#coordinate-systems"><span class="std std-ref">coordinate system</span></a>. If a domain ancillary construct provides extra
coordinates then it may contain cell bounds in addition to its main
data array.</p>
<div class="literal-block-wrapper docutils container" id="id135">
<div class="code-block-caption"><span class="caption-text"><em>Get the data and bounds data of a domain ancillary
construct.</em></span><a class="headerlink" href="#id135" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domainancillary0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[10.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span>
<span class="go">&lt;Bounds: ncvar%a_bounds(1, 2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[  5.  15.]]</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="coordinate-systems">
<span id="id38"></span><h2><a class="toc-backref" href="#id240"><strong>Coordinate systems</strong></a><a class="headerlink" href="#coordinate-systems" title="Permalink to this headline">¶</a></h2>
<p>A field construct may contain various coordinate systems. Each
coordinate system is either defined by a <a class="reference internal" href="cf_data_model.html#term-coordinate-reference-constructs"><span class="xref std std-term">coordinate reference
construct</span></a> that relates dimension
coordinate, auxiliary coordinate and domain ancillary constructs (as
is the case for the field construct <code class="docutils literal notranslate"><span class="pre">t</span></code>), or is inferred from
dimension and auxiliary coordinate constructs alone (as is the case
for the field construct <code class="docutils literal notranslate"><span class="pre">q</span></code>).</p>
<p>A coordinate reference construct contains</p>
<ul class="simple">
<li><p>references (by construct keys) to the dimension and auxiliary
coordinate constructs to which it applies, accessed with the
<a class="reference internal" href="method/cfdm.CoordinateReference.coordinates.html#cfdm.CoordinateReference.coordinates" title="cfdm.CoordinateReference.coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinates</span></code></a> method of the coordinate
reference construct;</p></li>
</ul>
<ul class="simple">
<li><p>the zeroes of the dimension and auxiliary coordinate constructs
which define the coordinate system, stored in a <a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a> instance,
which is accessed with the <a class="reference internal" href="attribute/cfdm.CoordinateReference.datum.html#cfdm.CoordinateReference.datum" title="cfdm.CoordinateReference.datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datum</span></code></a> attribute,
or <a class="reference internal" href="method/cfdm.CoordinateReference.get_datum.html#cfdm.CoordinateReference.get_datum" title="cfdm.CoordinateReference.get_datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_datum</span></code></a> method, of the coordinate
reference construct; and</p></li>
</ul>
<ul class="simple">
<li><p>a formula for converting coordinate values taken from the dimension
or auxiliary coordinate constructs to a different coordinate system,
stored in a <a class="reference internal" href="class/cfdm.CoordinateConversion.html#cfdm.CoordinateConversion" title="cfdm.CoordinateConversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateConversion</span></code></a> class instance, which is accessed
with the <a class="reference internal" href="attribute/cfdm.CoordinateReference.coordinate_conversion.html#cfdm.CoordinateReference.coordinate_conversion" title="cfdm.CoordinateReference.coordinate_conversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinate_conversion</span></code></a> attribute, or
<a class="reference internal" href="method/cfdm.CoordinateReference.get_coordinate_conversion.html#cfdm.CoordinateReference.get_coordinate_conversion" title="cfdm.CoordinateReference.get_coordinate_conversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_coordinate_conversion</span></code></a> method, of the
coordinate reference construct.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id136">
<div class="code-block-caption"><span class="caption-text"><em>Select the vertical coordinate system construct and
inspect its coordinate constructs.</em></span><a class="headerlink" href="#id136" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;standard_name:atmosphere_hybrid_height_coordinate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span>
<span class="go">&lt;CoordinateReference: atmosphere_hybrid_height_coordinate&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Coordinate Reference: atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:computed_standard_name = altitude</span>
<span class="go">    Coordinate conversion:standard_name = atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:a = domainancillary0</span>
<span class="go">    Coordinate conversion:b = domainancillary1</span>
<span class="go">    Coordinate conversion:orog = domainancillary2</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Coordinate: dimensioncoordinate0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
<span class="go">{&#39;dimensioncoordinate0&#39;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id137">
<div class="code-block-caption"><span class="caption-text"><em>Get the datum and inspect its parameters.</em></span><a class="headerlink" href="#id137" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">datum</span>
<span class="go">&lt;Datum: Parameters: earth_radius&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
<span class="go">{&#39;earth_radius&#39;: 6371007}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id138">
<div class="code-block-caption"><span class="caption-text"><em>Get the coordinate conversion and inspect its parameters
and referenced domain ancillary constructs.</em></span><a class="headerlink" href="#id138" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span>
<span class="go">&lt;CoordinateConversion: Parameters: computed_standard_name, standard_name; Ancillaries: a, b, orog&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
<span class="go">{&#39;computed_standard_name&#39;: &#39;altitude&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;atmosphere_hybrid_height_coordinate&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span><span class="o">.</span><span class="n">domain_ancillaries</span><span class="p">()</span>
<span class="go">{&#39;a&#39;: &#39;domainancillary0&#39;,</span>
<span class="go"> &#39;b&#39;: &#39;domainancillary1&#39;,</span>
<span class="go"> &#39;orog&#39;: &#39;domainancillary2&#39;}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="cell-methods">
<span id="id39"></span><h2><a class="toc-backref" href="#id241"><strong>Cell methods</strong></a><a class="headerlink" href="#cell-methods" title="Permalink to this headline">¶</a></h2>
<p>A cell method construct describes how the data represent the variation
of the physical quantity within the cells of the domain and is stored
in a <a class="reference internal" href="class/cfdm.CellMethod.html#cfdm.CellMethod" title="cfdm.CellMethod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMethod</span></code></a> instance. A field constructs allows multiple
cell method constructs to be recorded.</p>
<div class="literal-block-wrapper docutils container" id="id139">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the cell methods. The description follows the CF
conventions for cell_method attribute strings, apart from
the use of construct keys instead of netCDF variable
names for cell method axes identification.</em></span><a class="headerlink" href="#id139" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">cell_methods</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CellMethod: domainaxis3: maximum&gt;}</span>
</pre></div>
</div>
</div>
<p>The application of cell methods is not commutative (e.g. a mean of
variances is generally not the same as a variance of means), and the
cell methods are assumed to have been applied in the order in which
they were added to the field construct during <a class="reference internal" href="#field-creation-in-memory"><span class="std std-ref">field construct
creation</span></a>.</p>
<p>The axes to which the method applies, the method itself, and any
qualifying properties are accessed with the
<a class="reference internal" href="method/cfdm.CellMethod.get_axes.html#cfdm.CellMethod.get_axes" title="cfdm.CellMethod.get_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_axes</span></code></a>, <a class="reference internal" href="method/cfdm.CellMethod.get_method.html#cfdm.CellMethod.get_method" title="cfdm.CellMethod.get_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_method</span></code></a>, ,
<a class="reference internal" href="method/cfdm.CellMethod.get_qualifier.html#cfdm.CellMethod.get_qualifier" title="cfdm.CellMethod.get_qualifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_qualifier</span></code></a> and <a class="reference internal" href="method/cfdm.CellMethod.qualifiers.html#cfdm.CellMethod.qualifiers" title="cfdm.CellMethod.qualifiers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qualifiers</span></code></a>
methods of the cell method construct.</p>
<div class="literal-block-wrapper docutils container" id="id140">
<div class="code-block-caption"><span class="caption-text"><em>Get the domain axes constructs to which the cell method
construct applies, and the method and other properties.</em></span><a class="headerlink" href="#id140" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;method:mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span>
<span class="go">&lt;CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
<span class="go">(&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_method</span><span class="p">()</span>
<span class="go">&#39;mean&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">()</span>
<span class="go">{&#39;interval&#39;: [&lt;Data(): 0.1 degrees&gt;], &#39;where&#39;: &#39;land&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_qualifier</span><span class="p">(</span><span class="s1">&#39;where&#39;</span><span class="p">)</span>
<span class="go">&#39;land&#39;</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="field-ancillaries">
<span id="id40"></span><h2><a class="toc-backref" href="#id242"><strong>Field ancillaries</strong></a><a class="headerlink" href="#field-ancillaries" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="cf_data_model.html#term-field-ancillary-constructs"><span class="xref std std-term">field ancillary construct</span></a>
provides metadata which are distributed over the same domain as the
field construct itself. For example, if a field construct holds a data
retrieved from a satellite instrument, a field ancillary construct
might provide the uncertainty estimates for those retrievals (varying
over the same spatiotemporal domain).</p>
<div class="literal-block-wrapper docutils container" id="id141">
<div class="code-block-caption"><span class="caption-text"><em>Get the properties and data of a field ancillary
construct.</em></span><a class="headerlink" href="#id141" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;fieldancillary0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">&lt;FieldAncillary: air_temperature standard_error(10, 9) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;air_temperature standard_error&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(10, 9): [[0.76, ..., 0.32]] K&gt;</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="field-creation-in-memory">
<span id="id41"></span><h2><a class="toc-backref" href="#id243"><strong>Field creation in memory</strong></a><a class="headerlink" href="#field-creation-in-memory" title="Permalink to this headline">¶</a></h2>
<p>There are various methods for creating a field construct in memory:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ab-initio-creation"><span class="std std-ref">Ab initio creation</span></a>: Instantiate
instances of field and metadata construct classes and manually
provide the connections between them.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="#command-modification"><span class="std std-ref">Command modification</span></a>: Produce the
commands that would create an already existing field construct, and
then modify them.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="#creation-by-conversion"><span class="std std-ref">Creation by conversion</span></a>: Convert a
single metadata construct already in memory to an independent field
construct</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="#creation-by-reading"><span class="std std-ref">Creation by reading</span></a>: Create field
constructs from the netCDF variables in a dataset.</p></li>
</ul>
<section id="ab-initio-creation">
<span id="id42"></span><h3><a class="toc-backref" href="#id244">Ab initio creation</a><a class="headerlink" href="#ab-initio-creation" title="Permalink to this headline">¶</a></h3>
<p>Ab initio creation of a field construct has three stages:</p>
<p><strong>Stage 1:</strong> The field construct is created without metadata
constructs.</p>
<p><strong>Stage 2:</strong> Metadata constructs are created independently.</p>
<p><strong>Stage 3:</strong> The metadata constructs are inserted into the field
construct with cross-references to other, related metadata constructs
if required. For example, an auxiliary coordinate construct is related
to an ordered list of the <a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis constructs</span></a> which correspond to
its data array dimensions.</p>
<p>There are two equivalent approaches to <strong>stages 1</strong> and <strong>2</strong>.</p>
<p>Either as much of the content as possible is specified during object
instantiation:</p>
<div class="literal-block-wrapper docutils container" id="id142">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with a “standard_name”
property. Create dimension coordinate and field ancillary
constructs, both with properties and data.</em></span><a class="headerlink" href="#id142" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: precipitation_flux&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">},</span>
<span class="gp">... </span>                              <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;DimensionCoordinate: long_name=Longitude(3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux status_flag&#39;</span><span class="p">},</span>
<span class="gp">... </span>       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: precipitation_flux status_flag(3) &gt;</span>
</pre></div>
</div>
</div>
<p>or else some or all content is added after instantiation via object
methods:</p>
<div class="literal-block-wrapper docutils container" id="id143">
<div class="code-block-caption"><span class="caption-text"><em>Create empty constructs and provide them with properties
and data after instantiation.</em></span><a class="headerlink" href="#id143" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;Field: precipitation_flux&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;DimensionCoordinate:  &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;DimensionCoordinate: long_name=Longitude(3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: (3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux status_flag&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;FieldAncillary: precipitation_flux status_flag(3) &gt;</span>
</pre></div>
</div>
</div>
<p>For <strong>stage 3</strong>, the <a class="reference internal" href="method/cfdm.Field.set_construct.html#cfdm.Field.set_construct" title="cfdm.Field.set_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_construct</span></code></a> method of the field
construct is used for setting metadata constructs and mapping data
array dimensions to domain axis constructs. This method returns the
construct key for the metadata construct which can be used when other
metadata constructs are added to the field (e.g. to specify which
domain axis constructs correspond to a data array), or when other
metadata constructs are created (e.g. to identify the domain ancillary
constructs forming part of a coordinate reference construct):</p>
<div class="literal-block-wrapper docutils container" id="id144">
<div class="code-block-caption"><span class="caption-text"><em>Set a domain axis construct and use its construct key
when setting the dimension coordinate construct. Also
create a cell method construct that applies to the domain
axis construct.</em></span><a class="headerlink" href="#id144" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_axis</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_axis</span>
<span class="go">&#39;domainaxis0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">longitude_axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span>
<span class="go">&#39;dimensioncoordinate0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">longitude_axis</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;minimum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="go">&#39;cellmethod0&#39;</span>
</pre></div>
</div>
</div>
<p>In general, the order in which metadata constructs are added to the
field does not matter, except when one metadata construct is required
by another, in which case the former must be added to the field first
so that its construct key is available to the latter. Cell method
constructs must, however, be set in the relative order in which their
methods were applied to the data.</p>
<p>The domain axis constructs spanned by a metadata construct’s data may
be changed after insertion with the <a class="reference internal" href="method/cfdm.Field.set_data_axes.html#cfdm.Field.set_data_axes" title="cfdm.Field.set_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data_axes</span></code></a> method of
the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id145">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with properties; data; and
domain axis, cell method and dimension coordinate
metadata constructs (data arrays have been generated with
dummy values using numpy.arange).</em></span><a class="headerlink" href="#id145" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Initialise the field construct with properties</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
          <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;specific_humidity&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs</span>
<span class="n">domain_axisT</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">domain_axisY</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">domain_axisX</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Insert the domain axis constructs into the field. The</span>
<span class="c1"># set_construct method returns the domain axis construct key that</span>
<span class="c1"># will be used later to specify which domain axis corresponds to</span>
<span class="c1"># which dimension coordinate construct.</span>
<span class="n">axisT</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisT</span><span class="p">)</span>
<span class="n">axisY</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisY</span><span class="p">)</span>
<span class="n">axisX</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisX</span><span class="p">)</span>

<span class="c1"># Create and insert the field construct data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">40.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axisY</span><span class="p">,</span> <span class="n">axisX</span><span class="p">])</span>

<span class="c1"># Create the cell method constructs</span>
<span class="n">cell_method1</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="n">cell_method2</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">()</span>
<span class="n">cell_method2</span><span class="o">.</span><span class="n">set_axes</span><span class="p">(</span><span class="n">axisT</span><span class="p">)</span>
<span class="n">cell_method2</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">)</span>

<span class="c1"># Insert the cell method constructs into the field in the same</span>
<span class="c1"># order that their methods were applied to the data</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method1</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method2</span><span class="p">)</span>

<span class="c1"># Create a &quot;time&quot; dimension coordinate construct, with coordinate</span>
<span class="c1"># bounds</span>
<span class="n">dimT</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
                            <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days since 2018-12-01&#39;</span><span class="p">},</span>
                            <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">15.5</span><span class="p">]),</span>
                            <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mf">31.</span><span class="p">]])))</span>

<span class="c1"># Create a &quot;longitude&quot; dimension coordinate construct, without</span>
<span class="c1"># coordinate bounds</span>
<span class="n">dimX</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">8.</span><span class="p">)))</span>
<span class="n">dimX</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">})</span>

<span class="c1"># Create a &quot;longitude&quot; dimension coordinate construct</span>
<span class="n">dimY</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">})</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

<span class="c1"># Create and insert the latitude coordinate bounds</span>
<span class="n">bounds_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">bounds_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="n">bounds_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">bounds_array</span><span class="p">))</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

<span class="c1"># Insert the dimension coordinate constructs into the field,</span>
<span class="c1"># specifying to # which domain axis each one corresponds</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimT</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axisT</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimY</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axisY</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimX</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axisX</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id146">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct.</em></span><a class="headerlink" href="#id146" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">------------------------</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;specific_humidity&#39;</span>
<span class="go">units = &#39;1&#39;</span>

<span class="go">Data(latitude(5), longitude(8)) = [[0.0, ..., 39.0]] 1</span>

<span class="go">Cell Method: area: mean</span>
<span class="go">Cell Method: time(1): maximum</span>

<span class="go">Domain Axis: latitude(5)</span>
<span class="go">Domain Axis: longitude(8)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2018-12-16 12:00:00]</span>
<span class="go">    Bounds:Data(time(1), 2) = [[2018-12-01 00:00:00, 2019-01-01 00:00:00]]</span>

<span class="go">Dimension coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_north&#39;</span>
<span class="go">    Data(latitude(5)) = [0.0, ..., 4.0] degrees_north</span>
<span class="go">    Bounds:Data(latitude(5), 2) = [[-0.5, ..., 4.5]] degrees_north</span>

<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(longitude(8)) = [0.0, ..., 7.0] degrees_east</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Conventions</span></code> property does not need to be set because it is
automatically included in output files as a netCDF global
<code class="docutils literal notranslate"><span class="pre">Conventions</span></code> attribute, either as the CF version of the cfdm
package (as returned by the <a class="reference internal" href="function/cfdm.CF.html#cfdm.CF" title="cfdm.CF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.CF</span></code></a> function), or else specified via
the <em>Conventions</em> keyword of the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function. See the
section on <a class="reference internal" href="#writing-to-disk"><span class="std std-ref">Writing to disk</span></a> for details on how to specify
additional conventions.</p>
<p>If this field were to be written to a netCDF dataset then, in the
absence of predefined names, default netCDF variable and dimension
names would be automatically generated (based on standard names where
they exist). The setting of bespoke netCDF names is, however, easily
done with the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id147">
<div class="code-block-caption"><span class="caption-text"><em>Set netCDF variable and dimension names for the field
and metadata constructs.</em></span><a class="headerlink" href="#id147" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>

<span class="n">domain_axisT</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">domain_axisY</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">domain_axisX</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>

<span class="n">dimT</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">dimX</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Here is a more complete example which creates a field construct that
contains every type of metadata construct (again, data arrays have
been generated with dummy values using <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.arange</span></code></a>):</p>
<div class="literal-block-wrapper docutils container" id="id148">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct that contains at least one
instance of each type of metadata construct.</em></span><a class="headerlink" href="#id148" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Initialize the field construct</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span>
                <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>

<span class="c1"># Create and set domain axis constructs</span>
<span class="n">axis_T</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axis_Z</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axis_Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">axis_X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>

<span class="c1"># Set the field construct data</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span>
             <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create and set the cell method constructs</span>
<span class="n">cell_method1</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span>
          <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">],</span>
          <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
          <span class="n">qualifiers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;where&#39;</span><span class="p">:</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">)]})</span>

<span class="n">cell_method2</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axis_T</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">)</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method1</span><span class="p">)</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method2</span><span class="p">)</span>

<span class="c1"># Create and set the field ancillary constructs</span>
<span class="n">field_ancillary</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
             <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">},</span>
             <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">field_ancillary</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create and set the dimension coordinate constructs</span>
<span class="n">dimension_coordinate_T</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
                           <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days since 2018-12-01&#39;</span><span class="p">},</span>
                           <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">15.5</span><span class="p">]),</span>
                           <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">31</span><span class="p">]])))</span>

<span class="n">dimension_coordinate_Z</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;computed_standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">},</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">1.5</span><span class="p">]),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])))</span>

<span class="n">dimension_coordinate_Y</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;grid_latitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.</span><span class="p">)),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>

<span class="n">dimension_coordinate_X</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;grid_longitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
    <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)),</span>
    <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>

<span class="n">dim_T</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_T</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_T</span><span class="p">)</span>
<span class="n">dim_Z</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_Z</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">dim_Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_Y</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Y</span><span class="p">)</span>
<span class="n">dim_X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_X</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_X</span><span class="p">)</span>

<span class="c1"># Create and set the auxiliary coordinate constructs</span>
<span class="n">auxiliary_coordinate_lat</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                      <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">},</span>
                      <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">auxiliary_coordinate_lon</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                  <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">},</span>
                  <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdefghij&#39;</span><span class="p">))</span>
<span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="n">auxiliary_coordinate_name</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Grid latitude name&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

<span class="n">aux_LAT</span>  <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_lat</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>
<span class="n">aux_LON</span>  <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_lon</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_X</span><span class="p">,</span> <span class="n">axis_Y</span><span class="p">])</span>
<span class="n">aux_NAME</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_name</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">])</span>

<span class="c1"># Create and set domain ancillary constructs</span>
<span class="n">domain_ancillary_a</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                   <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                   <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">10.</span><span class="p">]),</span>
                   <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">]])))</span>

<span class="n">domain_ancillary_b</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">20.</span><span class="p">]),</span>
                       <span class="n">bounds</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">14</span><span class="p">,</span> <span class="mf">26.</span><span class="p">]])))</span>

<span class="n">domain_ancillary_orog</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                          <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;surface_altitude&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                          <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">domain_anc_A</span>    <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_a</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">domain_anc_B</span>    <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_b</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">domain_anc_OROG</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_orog</span><span class="p">,</span>
                                    <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">])</span>

<span class="c1"># Create the datum for the coordinate reference constructs</span>
<span class="n">datum</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Datum</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;earth_radius&#39;</span><span class="p">:</span> <span class="mf">6371007.</span><span class="p">})</span>

<span class="c1"># Create the coordinate conversion for the horizontal coordinate</span>
<span class="c1"># reference construct</span>
<span class="n">coordinate_conversion_h</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateConversion</span><span class="p">(</span>
              <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;grid_mapping_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rotated_latitude_longitude&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;grid_north_pole_latitude&#39;</span><span class="p">:</span> <span class="mf">38.0</span><span class="p">,</span>
                          <span class="s1">&#39;grid_north_pole_longitude&#39;</span><span class="p">:</span> <span class="mf">190.0</span><span class="p">})</span>

<span class="c1"># Create the coordinate conversion for the vertical coordinate</span>
<span class="c1"># reference construct</span>
<span class="n">coordinate_conversion_v</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateConversion</span><span class="p">(</span>
         <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;computed_standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">},</span>
         <span class="n">domain_ancillaries</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">domain_anc_A</span><span class="p">,</span>
                             <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">domain_anc_B</span><span class="p">,</span>
                             <span class="s1">&#39;orog&#39;</span><span class="p">:</span> <span class="n">domain_anc_OROG</span><span class="p">})</span>

<span class="c1"># Create the vertical coordinate reference construct</span>
<span class="n">horizontal_crs</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateReference</span><span class="p">(</span>
                   <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
                   <span class="n">coordinate_conversion</span><span class="o">=</span><span class="n">coordinate_conversion_h</span><span class="p">,</span>
                   <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">dim_X</span><span class="p">,</span>
                                <span class="n">dim_Y</span><span class="p">,</span>
                                <span class="n">aux_LAT</span><span class="p">,</span>
                                <span class="n">aux_LON</span><span class="p">])</span>

<span class="c1"># Create the vertical coordinate reference construct</span>
<span class="n">vertical_crs</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CoordinateReference</span><span class="p">(</span>
                 <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
                 <span class="n">coordinate_conversion</span><span class="o">=</span><span class="n">coordinate_conversion_v</span><span class="p">,</span>
                 <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">dim_Z</span><span class="p">])</span>

<span class="c1"># Set the coordinate reference constructs</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">horizontal_crs</span><span class="p">)</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">vertical_crs</span><span class="p">)</span>

<span class="c1"># Create and set the cell measure constructs</span>
<span class="n">cell_measure</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">CellMeasure</span><span class="p">(</span><span class="n">measure</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">,</span>
                 <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;km2&#39;</span><span class="p">},</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_measure</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_X</span><span class="p">,</span> <span class="n">axis_Y</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The new field construct may now be inspected:</p>
<div class="literal-block-wrapper docutils container" id="id149">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct.</em></span><a class="headerlink" href="#id149" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tas</span><span class="p">)</span>
<span class="go">Field: air_temperature</span>
<span class="go">----------------------</span>
<span class="go">Data            : air_temperature(grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] K</span>
<span class="go">Dimension coords: time(1) = [2018-12-16 12:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] degrees_north</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] degrees_east</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., j]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : key%domainancillary0(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : key%domainancillary1(atmosphere_hybrid_height_coordinate(1)) = [20.0] 1</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] m</span>
</pre></div>
</div>
</div>
</section>
<section id="command-modification">
<span id="id43"></span><h3><a class="toc-backref" href="#id245">Command modification</a><a class="headerlink" href="#command-modification" title="Permalink to this headline">¶</a></h3>
<p>It is sometimes convenient to produce the commands that would create
an already existing field construct, and then modify them to create
the desired field construct. The commands are produced by the
<a class="reference internal" href="method/cfdm.Field.creation_commands.html#cfdm.Field.creation_commands" title="cfdm.Field.creation_commands"><code class="xref py py-obj docutils literal notranslate"><span class="pre">creation_commands</span></code></a> method of the existing field construct.</p>
<div class="literal-block-wrapper docutils container" id="id150">
<div class="code-block-caption"><span class="caption-text"><em>Produce the commands that would create an existing field
construct.</em></span><a class="headerlink" href="#id150" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">creation_commands</span><span class="p">())</span>
<span class="go">#</span>
<span class="go"># field: specific_humidity</span>
<span class="go">field = cfdm.Field()</span>
<span class="go">field.set_properties({&#39;Conventions&#39;: &#39;CF-1.9&#39;, &#39;project&#39;: &#39;research&#39;, &#39;standard_name&#39;: &#39;specific_humidity&#39;, &#39;units&#39;: &#39;1&#39;})</span>
<span class="go">field.nc_set_variable(&#39;q&#39;)</span>
<span class="go">data = cfdm.Data([[0.007, 0.034, 0.003, 0.014, 0.018, 0.037, 0.024, 0.029], [0.023, 0.036, 0.045, 0.062, 0.046, 0.073, 0.006, 0.066], [0.11, 0.131, 0.124, 0.146, 0.087, 0.103, 0.057, 0.011], [0.029, 0.059, 0.039, 0.07, 0.058, 0.072, 0.009, 0.017], [0.006, 0.036, 0.019, 0.035, 0.018, 0.037, 0.034, 0.013]], units=&#39;1&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">field.set_data(data)</span>
<span class="go">#</span>
<span class="go"># domain_axis: ncdim%lat</span>
<span class="go">c = cfdm.DomainAxis()</span>
<span class="go">c.set_size(5)</span>
<span class="go">c.nc_set_dimension(&#39;lat&#39;)</span>
<span class="go">field.set_construct(c, key=&#39;domainaxis0&#39;, copy=False)</span>
<span class="go">#</span>
<span class="go"># domain_axis: ncdim%lon</span>
<span class="go">c = cfdm.DomainAxis()</span>
<span class="go">c.set_size(8)</span>
<span class="go">c.nc_set_dimension(&#39;lon&#39;)</span>
<span class="go">field.set_construct(c, key=&#39;domainaxis1&#39;, copy=False)</span>
<span class="go">#</span>
<span class="go"># domain_axis:</span>
<span class="go">c = cfdm.DomainAxis()</span>
<span class="go">c.set_size(1)</span>
<span class="go">field.set_construct(c, key=&#39;domainaxis2&#39;, copy=False)</span>
<span class="go">#</span>
<span class="go"># dimension_coordinate: latitude</span>
<span class="go">c = cfdm.DimensionCoordinate()</span>
<span class="go">c.set_properties({&#39;units&#39;: &#39;degrees_north&#39;, &#39;standard_name&#39;: &#39;latitude&#39;})</span>
<span class="go">c.nc_set_variable(&#39;lat&#39;)</span>
<span class="go">data = cfdm.Data([-75.0, -45.0, 0.0, 45.0, 75.0], units=&#39;degrees_north&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">c.set_data(data)</span>
<span class="go">b = cfdm.Bounds()</span>
<span class="go">b.nc_set_variable(&#39;lat_bnds&#39;)</span>
<span class="go">data = cfdm.Data([[-90.0, -60.0], [-60.0, -30.0], [-30.0, 30.0], [30.0, 60.0], [60.0, 90.0]], units=&#39;degrees_north&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">b.set_data(data)</span>
<span class="go">c.set_bounds(b)</span>
<span class="go">field.set_construct(c, axes=(&#39;domainaxis0&#39;,), key=&#39;dimensioncoordinate0&#39;, copy=False)</span>
<span class="go">#</span>
<span class="go"># dimension_coordinate: longitude</span>
<span class="go">c = cfdm.DimensionCoordinate()</span>
<span class="go">c.set_properties({&#39;units&#39;: &#39;degrees_east&#39;, &#39;standard_name&#39;: &#39;longitude&#39;})</span>
<span class="go">c.nc_set_variable(&#39;lon&#39;)</span>
<span class="go">data = cfdm.Data([22.5, 67.5, 112.5, 157.5, 202.5, 247.5, 292.5, 337.5], units=&#39;degrees_east&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">c.set_data(data)</span>
<span class="go">b = cfdm.Bounds()</span>
<span class="go">b.nc_set_variable(&#39;lon_bnds&#39;)</span>
<span class="go">data = cfdm.Data([[0.0, 45.0], [45.0, 90.0], [90.0, 135.0], [135.0, 180.0], [180.0, 225.0], [225.0, 270.0], [270.0, 315.0], [315.0, 360.0]], units=&#39;degrees_east&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">b.set_data(data)</span>
<span class="go">c.set_bounds(b)</span>
<span class="go">field.set_construct(c, axes=(&#39;domainaxis1&#39;,), key=&#39;dimensioncoordinate1&#39;, copy=False)</span>
<span class="go">#</span>
<span class="go"># dimension_coordinate: time</span>
<span class="go">c = cfdm.DimensionCoordinate()</span>
<span class="go">c.set_properties({&#39;units&#39;: &#39;days since 2018-12-01&#39;, &#39;standard_name&#39;: &#39;time&#39;})</span>
<span class="go">c.nc_set_variable(&#39;time&#39;)</span>
<span class="go">data = cfdm.Data([31.0], units=&#39;days since 2018-12-01&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">c.set_data(data)</span>
<span class="go">field.set_construct(c, axes=(&#39;domainaxis2&#39;,), key=&#39;dimensioncoordinate2&#39;, copy=False)</span>
<span class="go">#</span>
<span class="go"># cell_method: mean</span>
<span class="go">c = cfdm.CellMethod()</span>
<span class="go">c.set_method(&#39;mean&#39;)</span>
<span class="go">c.set_axes((&#39;area&#39;,))</span>
<span class="go">field.set_construct(c)</span>
<span class="go">#</span>
<span class="go"># field data axes</span>
<span class="go">field.set_data_axes((&#39;domainaxis0&#39;, &#39;domainaxis1&#39;))</span>
</pre></div>
</div>
</div>
<p>Some example fields are always available from the <a class="reference internal" href="function/cfdm.example_field.html#cfdm.example_field" title="cfdm.example_field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.example_field</span></code></a>
function.</p>
</section>
<section id="creating-data-from-an-array-on-disk">
<span id="id44"></span><h3><a class="toc-backref" href="#id246">Creating data from an array on disk</a><a class="headerlink" href="#creating-data-from-an-array-on-disk" title="Permalink to this headline">¶</a></h3>
<p>All the of above examples use arrays in memory to construct the data
instances for the field and metadata constructs. It is, however,
possible to create data from arrays that reside on disk. The
<a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function creates data in this manner. A pointer to an
array in a netCDF file can be stored in a <a class="reference internal" href="class/cfdm.NetCDFArray.html#cfdm.NetCDFArray" title="cfdm.NetCDFArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NetCDFArray</span></code></a>
instance, which is is used to initialize a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<div class="literal-block-wrapper docutils container" id="id151">
<div class="code-block-caption"><span class="caption-text"><em>Define a variable from a dataset with the netCDF package
and use it to create a NetCDFArray instance with which to
initialize a Data instance.</em></span><a class="headerlink" href="#id151" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">netCDF4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nc</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ta&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdf_array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">NetCDFArray</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;file.nc&#39;</span><span class="p">,</span> <span class="n">ncvar</span><span class="o">=</span><span class="s1">&#39;ta&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">dtype</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">shape</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_disk</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">netcdf_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id152">
<div class="code-block-caption"><span class="caption-text"><em>Read the netCDF variable’s data into memory and
initialise another Data instance with it. Compare the
values of the two data instances.</em></span><a class="headerlink" href="#id152" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_array</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_memory</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_disk</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">data_memory</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<p>Note that data type, number of dimensions, dimension sizes and number
of elements of the array on disk that are used to initialize the
<a class="reference internal" href="class/cfdm.NetCDFArray.html#cfdm.NetCDFArray" title="cfdm.NetCDFArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NetCDFArray</span></code></a> instance are those expected by the CF data model,
which may be different to those of the netCDF variable in the file
(although they are the same in the above example). For example, a
netCDF character array of shape <code class="docutils literal notranslate"><span class="pre">(12,</span> <span class="pre">9)</span></code> is viewed in cfdm as a
one-dimensional string array of shape <code class="docutils literal notranslate"><span class="pre">(12,)</span></code>.</p>
</section>
<section id="creation-by-conversion">
<span id="id45"></span><h3><a class="toc-backref" href="#id247">Creation by conversion</a><a class="headerlink" href="#creation-by-conversion" title="Permalink to this headline">¶</a></h3>
<p>An independent field construct may be created from an existing
metadata construct using <a class="reference internal" href="method/cfdm.Field.convert.html#cfdm.Field.convert" title="cfdm.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method of the field
construct, which identifies a unique metadata construct and returns a
new field construct based on its properties and data. The new field
construct always has <a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis constructs</span></a> corresponding to
the data, and (by default) any other metadata constructs that further
define its domain.</p>
<div class="literal-block-wrapper docutils container" id="id153">
<div class="code-block-caption"><span class="caption-text"><em>Create an independent field construct from the “surface
altitude” metadata construct.</em></span><a class="headerlink" href="#id153" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog</span><span class="p">)</span>
<span class="go">Field: surface_altitude</span>
<span class="go">-----------------------</span>
<span class="go">Data            : surface_altitude(grid_latitude(10), grid_longitude(9)) m</span>
<span class="go">Dimension coords: grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] degrees_north</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] degrees_east</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., j]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] km2</span>
<span class="go">Coord references: rotated_latitude_longitude</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cfdm.Field.convert.html#cfdm.Field.convert" title="cfdm.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method has an option to only include domain axis
constructs in the new field construct, with no other metadata
constructs.</p>
<div class="literal-block-wrapper docutils container" id="id154">
<div class="code-block-caption"><span class="caption-text"><em>Create an independent field construct from the “surface
altitude” metadata construct, but without a complete
domain.</em></span><a class="headerlink" href="#id154" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog1</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">full_domain</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog1</span><span class="p">)</span>
<span class="go">Field: surface_altitude</span>
<span class="go">-----------------------</span>
<span class="go">Data            : surface_altitude(key%domainaxis2(10), key%domainaxis3(9)) m</span>
</pre></div>
</div>
</div>
</section>
<section id="creation-by-reading">
<span id="id46"></span><h3><a class="toc-backref" href="#id248">Creation by reading</a><a class="headerlink" href="#creation-by-reading" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function <a class="reference internal" href="#reading-datasets"><span class="std std-ref">reads a netCDF dataset</span></a> and returns the contents as a list of zero or more
field constructs, each one corresponding to a unique CF-netCDF data
variable in the dataset. For example, the field construct <code class="docutils literal notranslate"><span class="pre">tas</span></code> that
was created manually can be <a class="reference internal" href="#writing-to-disk"><span class="std std-ref">written to a netCDF dataset</span></a> and then read back into memory:</p>
<div class="literal-block-wrapper docutils container" id="id155">
<div class="code-block-caption"><span class="caption-text"><em>Write the field construct that was created manually to
disk, and then read it back into a new field construct.</em></span><a class="headerlink" href="#id155" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tas</span><span class="p">,</span> <span class="s1">&#39;tas.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;tas.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">[&lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function also allows field constructs to be derived
directly from the netCDF variables that correspond to particular types
metadata constructs. In this case, the new field constructs will have
a domain limited to that which can be inferred from the corresponding
netCDF variable, but without the connections that are defined by the
parent netCDF data variable. This will often result in a new field
construct that has fewer metadata constructs than one created with the
<a class="reference internal" href="method/cfdm.Field.convert.html#cfdm.Field.convert" title="cfdm.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id156">
<div class="code-block-caption"><span class="caption-text"><em>Read the file, treating formula terms netCDF variables
(which map to domain ancillary constructs) as additional
CF-netCDF data variables.</em></span><a class="headerlink" href="#id156" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fields</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;tas.nc&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="s1">&#39;domain_ancillary&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fields</span>
<span class="go">[&lt;Field: ncvar%a(atmosphere_hybrid_height_coordinate(1)) m&gt;,</span>
<span class="go"> &lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;Field: ncvar%b(atmosphere_hybrid_height_coordinate(1)) 1&gt;,</span>
<span class="go"> &lt;Field: surface_altitude(grid_latitude(10), grid_longitude(9)) m&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog_from_file</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog_from_file</span><span class="p">)</span>
<span class="go">Field: surface_altitude (ncvar%surface_altitude)</span>
<span class="go">------------------------------------------------</span>
<span class="go">Data            : surface_altitude(grid_latitude(10), grid_longitude(9)) m</span>
<span class="go">Dimension coords: grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
</pre></div>
</div>
</div>
<p>Comparing the field constructs <code class="docutils literal notranslate"><span class="pre">orog_from_file</span></code> (created with
<a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a>) and <code class="docutils literal notranslate"><span class="pre">orog</span></code> (created with the <a class="reference internal" href="method/cfdm.Field.convert.html#cfdm.Field.convert" title="cfdm.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method of
the <code class="docutils literal notranslate"><span class="pre">tas</span></code> field construct), the former lacks the auxiliary
coordinate, cell measure and coordinate reference constructs of the
latter. This is because the surface altitude netCDF variable in
<code class="docutils literal notranslate"><span class="pre">tas.nc</span></code> does not have the <code class="docutils literal notranslate"><span class="pre">coordinates</span></code>, <code class="docutils literal notranslate"><span class="pre">cell_measures</span></code> nor
<code class="docutils literal notranslate"><span class="pre">grid_mapping</span></code> netCDF attributes that would link it to auxiliary
coordinate, cell measure and grid mapping netCDF variables.</p>
</section>
<section id="creating-compressed-constructs">
<h3><a class="toc-backref" href="#id249">Creating compressed constructs</a><a class="headerlink" href="#creating-compressed-constructs" title="Permalink to this headline">¶</a></h3>
<hr class="docutils" />
</section>
</section>
<section id="copying">
<span id="id47"></span><h2><a class="toc-backref" href="#id250"><strong>Copying</strong></a><a class="headerlink" href="#copying" title="Permalink to this headline">¶</a></h2>
<p>A field construct may be copied with its <a class="reference internal" href="method/cfdm.Field.copy.html#cfdm.Field.copy" title="cfdm.Field.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a> method. This
produces a “deep copy”, i.e. the new field construct is completely
independent of the original field.</p>
<div class="literal-block-wrapper docutils container" id="id157">
<div class="code-block-caption"><span class="caption-text"><em>Copy a field construct and change elements of the copy,
showing that the original field construct has not been
altered.</em></span><a class="headerlink" href="#id157" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Data(1, 1, 1): [[[-1e+30]]] K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Data(1, 1, 1): [[[-1.0]]] K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">del_construct</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;DimensionCoordinate: grid_latitude(10) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;DimensionCoordinate: grid_latitude(10) degrees&gt;}</span>
</pre></div>
</div>
</div>
<p>Equivalently, the <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy.deepcopy</span></code></a> function may be used:</p>
<div class="literal-block-wrapper docutils container" id="id158">
<div class="code-block-caption"><span class="caption-text"><em>Copy a field construct with the built-in copy module.</em></span><a class="headerlink" href="#id158" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">copy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Metadata constructs may be copied individually in the same manner:</p>
<div class="literal-block-wrapper docutils container" id="id159">
<div class="code-block-caption"><span class="caption-text"><em>Copy a metadata construct.</em></span><a class="headerlink" href="#id159" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Arrays within <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instances are copied with a <a class="reference external" href="https://en.wikipedia.org/wiki/Copy-on-write">copy-on-write</a> technique. This means
that a copy takes up very little memory, even when the original
constructs contain very large data arrays, and the copy operation is
fast.</p>
<hr class="docutils" />
</section>
<section id="equality">
<span id="id48"></span><h2><a class="toc-backref" href="#id251"><strong>Equality</strong></a><a class="headerlink" href="#equality" title="Permalink to this headline">¶</a></h2>
<p>Whether or not two field constructs are the same is tested with either
field construct’s <a class="reference internal" href="method/cfdm.Field.equals.html#cfdm.Field.equals" title="cfdm.Field.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id160">
<div class="code-block-caption"><span class="caption-text"><em>A field construct is always equal to itself, a copy of
itself and a complete subspace of itself. The “verbose”
keyword will give some (but not necessarily all) of the
reasons why two field constructs are not the same.</em></span><a class="headerlink" href="#id160" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Field: Different units: &#39;K&#39;, &#39;1&#39;</span>
<span class="go">Field: Different properties</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<p>Equality is strict by default. This means that for two field
constructs to be considered equal they must have corresponding
metadata constructs and for each pair of constructs:</p>
<ul class="simple">
<li><p>the descriptive properties must be the same (with the exception of
the field construct’s <code class="docutils literal notranslate"><span class="pre">Conventions</span></code> property, which is never
checked), and vector-valued properties must have same the size and
be element-wise equal, and</p></li>
<li><p>if there are data arrays then they must have same shape, data type
and be element-wise equal.</p></li>
</ul>
<p>Two real numbers <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are considered equal if
<span class="math notranslate nohighlight">\(|x - y| \le a_{tol} + r_{tol}|y|\)</span>, where <span class="math notranslate nohighlight">\(a_{tol}\)</span> (the
tolerance on absolute differences) and <span class="math notranslate nohighlight">\(r_{tol}\)</span> (the tolerance
on relative differences) are positive, typically very small
numbers. By default both are set to the system epsilon (the difference
between 1 and the least value greater than 1 that is representable as
a float). Their values may be inspected and changed with the
<a class="reference internal" href="function/cfdm.atol.html#cfdm.atol" title="cfdm.atol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.atol</span></code></a> and <a class="reference internal" href="function/cfdm.rtol.html#cfdm.rtol" title="cfdm.rtol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.rtol</span></code></a> functions.</p>
<p>Note that the above equation is not symmetric in <span class="math notranslate nohighlight">\(x\)</span> and
<span class="math notranslate nohighlight">\(y\)</span>, so that for two fields <code class="docutils literal notranslate"><span class="pre">f1</span></code> and <code class="docutils literal notranslate"><span class="pre">f2</span></code>, <code class="docutils literal notranslate"><span class="pre">f1.equals(f2)</span></code>
may be different from <code class="docutils literal notranslate"><span class="pre">f2.equals(f1)</span></code> in some rare cases.</p>
<div class="literal-block-wrapper docutils container" id="id161">
<div class="code-block-caption"><span class="caption-text"><em>The atol and rtol functions allow the numerical equality
tolerances to be inspected and changed.</em></span><a class="headerlink" href="#id161" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">atol</span><span class="p">())</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">rtol</span><span class="p">())</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">rtol</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">rtol</span><span class="p">())</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">rtol</span><span class="p">(</span><span class="n">original</span><span class="p">))</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">rtol</span><span class="p">())</span>
<span class="go">2.220446049250313e-16</span>
</pre></div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(a_{tol}\)</span> and <span class="math notranslate nohighlight">\(r_{tol}\)</span> constants may be set for a
runtime context established using a <code class="xref py py-obj docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<div class="literal-block-wrapper docutils container" id="id162">
<div class="code-block-caption"><span class="caption-text"><em>Create a runtime contenxt with a different value of
‘atol’.</em></span><a class="headerlink" href="#id162" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">atol</span><span class="p">())</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">atol</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">atol</span><span class="p">())</span>
<span class="gp">...</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">atol</span><span class="p">())</span>
<span class="go">2.220446049250313e-16</span>
</pre></div>
</div>
</div>
<p>NetCDF elements, such as netCDF variable and dimension names, do not
constitute part of the CF data model and so are not checked on any
construct.</p>
<p>The <a class="reference internal" href="method/cfdm.Field.equals.html#cfdm.Field.equals" title="cfdm.Field.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a> method has optional parameters for modifying the
criteria for considering two fields to be equal:</p>
<ul class="simple">
<li><p>named properties may be omitted from the comparison,</p></li>
<li><p>fill value and missing data value properties may be ignored,</p></li>
<li><p>the data type of data arrays may be ignored, and</p></li>
<li><p>the tolerances on absolute and relative differences for numerical
comparisons may be temporarily changed, without changing the default
settings.</p></li>
</ul>
<p>Metadata constructs may also be tested for equality:</p>
<div class="literal-block-wrapper docutils container" id="id163">
<div class="code-block-caption"><span class="caption-text"><em>Metadata constructs also have an equals method, that
behaves in a similar manner.</em></span><a class="headerlink" href="#id163" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">orog</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="netcdf-interface">
<span id="id49"></span><h2><a class="toc-backref" href="#id252"><strong>NetCDF interface</strong></a><a class="headerlink" href="#netcdf-interface" title="Permalink to this headline">¶</a></h2>
<p>The logical CF data model is independent of netCDF, but the CF
conventions are designed to enable the processing and sharing of
datasets stored in netCDF files. Therefore, the cfdm package includes
methods for recording and editing netCDF elements that are not part of
the CF model, but are nonetheless often required to interpret and
create CF-netCDF datasets. See the section on <a class="reference internal" href="philosophy.html#philosophy"><span class="std std-ref">philosophy</span></a> for a further discussion.</p>
<p>When a netCDF dataset is read, netCDF elements (such as dimension and
variable names, and some attribute values) that do not have a place in
the CF data model are, nevertheless, stored within the appropriate
cfdm constructs. This allows them to be used when writing field
constructs to a new netCDF dataset, and also makes them accessible as
filters to a <a class="reference internal" href="class/cfdm.Constructs.html#cfdm.Constructs" title="cfdm.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance:</p>
<div class="literal-block-wrapper docutils container" id="id164">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve metadata constructs based on their netCDF
names.</em></span><a class="headerlink" href="#id164" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_ncvar</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary1&#39;: &lt;DomainAncillary: ncvar%b(1) &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;ncvar</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">&lt;DimensionCoordinate: grid_longitude(9) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;ncdim</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&lt;Constructs: domain_axis(1)&gt;</span>
</pre></div>
</div>
</div>
<p>Each construct has methods to access the netCDF elements which it
requires. For example, the field construct has the following methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 55%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_get_variable.html#cfdm.Field.nc_get_variable" title="cfdm.Field.nc_get_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_variable</span></code></a></p></td>
<td><p>Return the netCDF variable name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_variable.html#cfdm.Field.nc_set_variable" title="cfdm.Field.nc_set_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></a></p></td>
<td><p>Set the netCDF variable name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_del_variable.html#cfdm.Field.nc_del_variable" title="cfdm.Field.nc_del_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_variable</span></code></a></p></td>
<td><p>Remove the netCDF variable name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_has_variable.html#cfdm.Field.nc_has_variable" title="cfdm.Field.nc_has_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_variable</span></code></a></p></td>
<td><p>Whether the netCDF variable name has
been set</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_global_attributes.html#cfdm.Field.nc_global_attributes" title="cfdm.Field.nc_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_global_attributes</span></code></a></p></td>
<td><p>Return the selection of properties to
be written as netCDF global attributes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_global_attribute.html#cfdm.Field.nc_set_global_attribute" title="cfdm.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a></p></td>
<td><p>Set a property to be written as a
netCDF global attribute</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_global_attributes.html#cfdm.Field.nc_set_global_attributes" title="cfdm.Field.nc_set_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attributes</span></code></a></p></td>
<td><p>Set properties to be written as
netCDF global attributes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_clear_global_attributes.html#cfdm.Field.nc_clear_global_attributes" title="cfdm.Field.nc_clear_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_global_attributes</span></code></a></p></td>
<td><p>Clear the selection of properties
to be written as netCDF global
attributes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_group_attributes.html#cfdm.Field.nc_group_attributes" title="cfdm.Field.nc_group_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_group_attributes</span></code></a></p></td>
<td><p>Return the selection of properties to
be written as netCDF group attributes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_group_attribute.html#cfdm.Field.nc_set_group_attribute" title="cfdm.Field.nc_set_group_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_group_attribute</span></code></a></p></td>
<td><p>Set a property to be written as a
netCDF group attribute</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_group_attributes.html#cfdm.Field.nc_set_group_attributes" title="cfdm.Field.nc_set_group_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_group_attributes</span></code></a></p></td>
<td><p>Set properties to be written as
netCDF group attributes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_clear_group_attributes.html#cfdm.Field.nc_clear_group_attributes" title="cfdm.Field.nc_clear_group_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_group_attributes</span></code></a></p></td>
<td><p>Clear the selection of properties
to be written as netCDF group
attributes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_variable_groups.html#cfdm.Field.nc_variable_groups" title="cfdm.Field.nc_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_variable_groups</span></code></a></p></td>
<td><p>Return the netCDF group structure</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_variable_groups.html#cfdm.Field.nc_set_variable_groups" title="cfdm.Field.nc_set_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable_groups</span></code></a></p></td>
<td><p>Set the netCDF group structure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_clear_variable_groups.html#cfdm.Field.nc_clear_variable_groups" title="cfdm.Field.nc_clear_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_variable_groups</span></code></a></p></td>
<td><p>Remove the netCDF group structure</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_geometry_variable_groups.html#cfdm.Field.nc_geometry_variable_groups" title="cfdm.Field.nc_geometry_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_geometry_variable_groups</span></code></a></p></td>
<td><p>Return the netCDF geometry
variable group structure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_geometry_variable_groups.html#cfdm.Field.nc_set_geometry_variable_groups" title="cfdm.Field.nc_set_geometry_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_geometry_variable_groups</span></code></a></p></td>
<td><p>Set the netCDF geometry
variable group structure</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_clear_geometry_variable_groups.html#cfdm.Field.nc_clear_geometry_variable_groups" title="cfdm.Field.nc_clear_geometry_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_geometry_variable_groups</span></code></a></p></td>
<td><p>Remove the netCDF geometry
variable group structure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_del_component_variable.html#cfdm.Field.nc_del_component_variable" title="cfdm.Field.nc_del_component_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_variable</span></code></a></p></td>
<td><p>Remove the netCDF variable name for
all components of the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_component_variable.html#cfdm.Field.nc_set_component_variable" title="cfdm.Field.nc_set_component_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_variable</span></code></a></p></td>
<td><p>Set the netCDF variable name for all
components of the given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_component_variable_groups.html#cfdm.Field.nc_set_component_variable_groups" title="cfdm.Field.nc_set_component_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_variable_groups</span></code></a></p></td>
<td><p>Set the netCDF variable groups
hierarchy for all components of
the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_clear_component_variable_groups.html#cfdm.Field.nc_clear_component_variable_groups" title="cfdm.Field.nc_clear_component_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_variable_groups</span></code></a></p></td>
<td><p>Remove the netCDF variable groups
hierarchy for all components of the
given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_del_component_dimension.html#cfdm.Field.nc_del_component_dimension" title="cfdm.Field.nc_del_component_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_dimension</span></code></a></p></td>
<td><p>Remove the netCDF dimension name for
all components of the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_component_dimension.html#cfdm.Field.nc_set_component_dimension" title="cfdm.Field.nc_set_component_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_dimension</span></code></a></p></td>
<td><p>Set the netCDF dimension name for all
components of the given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_component_dimension_groups.html#cfdm.Field.nc_set_component_dimension_groups" title="cfdm.Field.nc_set_component_dimension_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_dimension_groups</span></code></a></p></td>
<td><p>Set the netCDF dimension groups
hierarchy for all components of the
given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_clear_component_dimension_groups.html#cfdm.Field.nc_clear_component_dimension_groups" title="cfdm.Field.nc_clear_component_dimension_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_dimension_groups</span></code></a></p></td>
<td><p>Remove the netCDF dimension groups
hierarchy for all components of the
given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_del_component_sample_dimension.html#cfdm.Field.nc_del_component_sample_dimension" title="cfdm.Field.nc_del_component_sample_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_sample_dimension</span></code></a></p></td>
<td><p>Remove the netCDF sample dimension
name for all components of the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_component_sample_dimension.html#cfdm.Field.nc_set_component_sample_dimension" title="cfdm.Field.nc_set_component_sample_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_sample_dimension</span></code></a></p></td>
<td><p>Set the netCDF sample dimension name
for all components of the given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cfdm.Field.nc_set_component_sample_dimension_groups.html#cfdm.Field.nc_set_component_sample_dimension_groups" title="cfdm.Field.nc_set_component_sample_dimension_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_sample_dimension_groups</span></code></a></p></td>
<td><p>Set the netCDF sample dimension
groups hierarchy for all components
of the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cfdm.Field.nc_clear_component_sample_dimension_groups.html#cfdm.Field.nc_clear_component_sample_dimension_groups" title="cfdm.Field.nc_clear_component_sample_dimension_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_sample_dimension_groups</span></code></a></p></td>
<td><p>Remove the netCDF sample dimension
groups hierarchy for all components
of the given type.</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id165">
<div class="code-block-caption"><span class="caption-text"><em>Access netCDF elements associated with the field and
metadata constructs.</em></span><a class="headerlink" href="#id165" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;q&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;project&#39;: None, &#39;Conventions&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;humidity&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;humidity&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;lat&#39;</span>
</pre></div>
</div>
</div>
<p>The complete collection of netCDF interface methods is:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 32%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Classes</p></th>
<th class="head"><p>NetCDF element</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>,  <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Variable name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Variable name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Variable name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Variable name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cfdm.DimensionCoordinate.html#cfdm.DimensionCoordinate" title="cfdm.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cfdm.AuxiliaryCoordinate.html#cfdm.AuxiliaryCoordinate" title="cfdm.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cfdm.DomainAncillary.html#cfdm.DomainAncillary" title="cfdm.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cfdm.FieldAncillary.html#cfdm.FieldAncillary" title="cfdm.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cfdm.CoordinateReference.html#cfdm.CoordinateReference" title="cfdm.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cfdm.Datum.html#cfdm.Datum" title="cfdm.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Dimension name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Dimension name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Dimension name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Dimension name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cfdm.Bounds.html#cfdm.Bounds" title="cfdm.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_is_unlimited</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></p></td>
<td><p>Unlimited dimension</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_unlimited</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.DomainAxis.html#cfdm.DomainAxis" title="cfdm.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></p></td>
<td><p>Unlimited dimension</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_global_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Global attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Global attributes</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Global attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_global_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Global attributes</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_geometry_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_geometry_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_geometry_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_group_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_group_attribute</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group attributes</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_group_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_group_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group attributes</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Field.html#cfdm.Field" title="cfdm.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_external</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></p></td>
<td><p>External variable status</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_external</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.CellMeasure.html#cfdm.CellMeasure" title="cfdm.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></p></td>
<td><p>External variable status</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Sample dimension name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Sample dimension name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Sample dimension name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Sample dimension name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
</tbody>
</table>
<hr class="docutils" />
</section>
<section id="writing-to-disk">
<span id="id50"></span><h2><a class="toc-backref" href="#id253"><strong>Writing to disk</strong></a><a class="headerlink" href="#writing-to-disk" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function writes a field construct, or a sequence of
field constructs, to a netCDF file on disk:</p>
<div class="literal-block-wrapper docutils container" id="id166">
<div class="code-block-caption"><span class="caption-text"><em>Write a field construct to a netCDF dataset on disk.</em></span><a class="headerlink" href="#id166" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;q_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The file name may describe relative paths, and standard tilde and
shell parameter expansions are applied to it.</p>
<p>The new dataset is structured as follows:</p>
<div class="literal-block-wrapper docutils container" id="id167">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id167" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump -h q_file.nc
<span class="go">netcdf q_file {</span>
<span class="go">dimensions:</span>
<span class="go">     lat = 5 ;</span>
<span class="go">     bounds2 = 2 ;</span>
<span class="go">     lon = 8 ;</span>
<span class="go">variables:</span>
<span class="go">     double lat_bnds(lat, bounds2) ;</span>
<span class="go">     double lat(lat) ;</span>
<span class="go">             lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">             lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">             lat:bounds = &quot;lat_bnds&quot; ;</span>
<span class="go">     double lon_bnds(lon, bounds2) ;</span>
<span class="go">     double lon(lon) ;</span>
<span class="go">             lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">             lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">             lon:bounds = &quot;lon_bnds&quot; ;</span>
<span class="go">     double time ;</span>
<span class="go">             time:units = &quot;days since 2018-12-01&quot; ;</span>
<span class="go">             time:standard_name = &quot;time&quot; ;</span>
<span class="go">     double humidity(lat, lon) ;</span>
<span class="go">             humidity:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">             humidity:cell_methods = &quot;area: mean&quot; ;</span>
<span class="go">             humidity:units = &quot;1&quot; ;</span>
<span class="go">             humidity:coordinates = &quot;time&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.9&quot; ;</span>
<span class="go">             :project = &quot;research&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>A sequence of field constructs is written in exactly the same way:</p>
<div class="literal-block-wrapper docutils container" id="id168">
<div class="code-block-caption"><span class="caption-text"><em>Write multiple field constructs to a netCDF dataset on
disk.</em></span><a class="headerlink" href="#id168" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;new_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>By default the output file will be for CF-1.9.</p>
<p>The <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li><p>set the output netCDF format (all netCDF3 and netCDF4 formats are
possible);</p></li>
<li><p>append to the netCDF file rather than over-writing it by default;</p></li>
<li><p>specify which field construct properties should become netCDF data
variable attributes and which should become netCDF global
attributes;</p></li>
<li><p>set extra netCDF global attributes;</p></li>
<li><p>create <a class="reference internal" href="#external-variables"><span class="std std-ref">external variables</span></a> in an external
file;</p></li>
<li><p>specify the version of the CF conventions (from CF-1.6 up to
CF-1.9), and of any other conventions that the file adheres
to;</p></li>
<li><p>change the data type of output data arrays;</p></li>
<li><p>apply netCDF compression and packing;</p></li>
<li><p>set the endian-ness of the output data; and</p></li>
<li><p>specify whether or not <a class="reference internal" href="#strings"><span class="std std-ref">netCDF string arrays</span></a> are to
be used.</p></li>
</ul>
<p>For example, to use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">mode</span></code> parameter to append a new field, or fields,
to a netCDF file whilst preserving the field or fields already contained
in that file:</p>
<div class="literal-block-wrapper docutils container" id="id169">
<div class="code-block-caption"><span class="caption-text"><em>Append field constructs to a netCDF dataset on
disk.</em></span><a class="headerlink" href="#id169" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">example_field</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;append-example-file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;append-example-file.nc&#39;</span><span class="p">)</span>
<span class="go">[&lt;Field: air_potential_temperature(time(36), latitude(5), longitude(8)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">example_field</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s1">&#39;append-example-file.nc&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;append-example-file.nc&#39;</span><span class="p">)</span>
<span class="go">[&lt;Field: air_potential_temperature(time(36), latitude(5), longitude(8)) K&gt;,</span>
<span class="go"> &lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;]</span>
</pre></div>
</div>
</div>
<p>Output netCDF variable and dimension names read from a netCDF dataset
are stored in the resulting field constructs, and may also be set
manually with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension</span></code> methods. If a name has not been set then one
will be generated internally (usually based on the standard name if it
exists).</p>
<p>It is possible to create netCDF unlimited dimensions using the
<a class="reference internal" href="method/cfdm.DomainAxis.nc_set_unlimited.html#cfdm.DomainAxis.nc_set_unlimited" title="cfdm.DomainAxis.nc_set_unlimited"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_unlimited</span></code></a> method of the domain axis construct.</p>
<p>A field construct is not transformed through being written to a file
on disk and subsequently read back from that file.</p>
<div class="literal-block-wrapper docutils container" id="id170">
<div class="code-block-caption"><span class="caption-text"><em>Read a file that has been created by writing a field
construct, and compare the result with the original field
construct in memory.</em></span><a class="headerlink" href="#id170" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;q_file.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<section id="global-attributes">
<span id="id51"></span><h3><a class="toc-backref" href="#id254">Global attributes</a><a class="headerlink" href="#global-attributes" title="Permalink to this headline">¶</a></h3>
<p>The field construct properties that correspond to the standardised
description-of-file-contents attributes are automatically written as
netCDF global attributes. Other attributes may also be written as
netCDF global attributes if they have been identified as such with the
<em>global_attributes</em> keyword, or via the
<a class="reference internal" href="method/cfdm.Field.nc_set_global_attribute.html#cfdm.Field.nc_set_global_attribute" title="cfdm.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a> or <a class="reference internal" href="method/cfdm.Field.nc_set_global_attributes.html#cfdm.Field.nc_set_global_attributes" title="cfdm.Field.nc_set_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attributes</span></code></a>
method of the field constructs. In either case, the creation of a
netCDF global attribute depends on the corresponding property values
being identical across all of the field constructs being written to
the file. If they are all equal then the property will be written as a
netCDF global attribute and not as an attribute of any netCDF data
variable; if any differ then the property is written only to each
netCDF data variable.</p>
<div class="literal-block-wrapper docutils container" id="id171">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “model” property is written as a netCDF
global attribute, using the “global_attributes” keyword.</em></span><a class="headerlink" href="#id171" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;model_A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">,</span> <span class="n">global_attributes</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id172">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “model” property is written as a netCDF
global attribute, using the “nc_set_global_attribute”
method.</em></span><a class="headerlink" href="#id172" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None, &#39;project&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_set_global_attribute</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None, &#39;project&#39;: None, &#39;model&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.9&#39;, &#39;project&#39;: &#39;research&#39;, &#39;model&#39;: &#39;model_A&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>It is possible to create both a netCDF global attribute and a netCDF
data variable attribute with the same name, but with different
values. This may be done by assigning the global value to the property
name with the <a class="reference internal" href="method/cfdm.Field.nc_set_global_attribute.html#cfdm.Field.nc_set_global_attribute" title="cfdm.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a> or
<a class="reference internal" href="method/cfdm.Field.nc_set_global_attributes.html#cfdm.Field.nc_set_global_attributes" title="cfdm.Field.nc_set_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attributes</span></code></a> method, or by via the
<em>file_descriptors</em> keyword. For the former technique, any
inconsistencies arising from multiple field constructs being written
to the same file will be resolved by omitting the netCDF global
attribute from the file.</p>
<div class="literal-block-wrapper docutils container" id="id173">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “information” property is written as
netCDF global and data variable attributes, with
different values, using the “nc_set_global_attribute”
method.</em></span><a class="headerlink" href="#id173" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;information&#39;</span><span class="p">,</span> <span class="s1">&#39;variable information&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.9&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;specific_humidity&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;1&#39;,</span>
<span class="go"> &#39;model&#39;: &#39;model_A&#39;,</span>
<span class="go"> &#39;information&#39;: &#39;variable information&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_set_global_attribute</span><span class="p">(</span><span class="s1">&#39;information&#39;</span><span class="p">,</span> <span class="s1">&#39;global information&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None,</span>
<span class="go"> &#39;project&#39;: None,</span>
<span class="go"> &#39;model&#39;: None,</span>
<span class="go"> &#39;information&#39;: &#39;global information&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>NetCDF global attributes defined with the <em>file_descriptors</em> keyword
of the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function will always be written as requested,
independently of the netCDF data variable attributes, and superseding
any global attributes that may have been defined with the
<em>global_attributes</em> keyword, or set on the individual field
constructs.</p>
<div class="literal-block-wrapper docutils container" id="id174">
<div class="code-block-caption"><span class="caption-text"><em>Insist that the “history” property is written as netCDF
a global attribute, with the “file_descriptors” keyword.</em></span><a class="headerlink" href="#id174" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">,</span> <span class="n">file_descriptors</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;history&#39;</span><span class="p">:</span> <span class="s1">&#39;created in 2021&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;f_file.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.9&#39;,</span>
<span class="go"> &#39;history&#39;: &#39;created in 2021&#39;,</span>
<span class="go"> &#39;model&#39;: &#39;model_A&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;information&#39;: &#39;variable information&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;specific_humidity&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None,</span>
<span class="go"> &#39;history&#39;: None,</span>
<span class="go"> &#39;model&#39;: None,</span>
<span class="go"> &#39;project&#39;: None,</span>
<span class="go"> &#39;information&#39;: &#39;global information&#39;}</span>
</pre></div>
</div>
</div>
</section>
<section id="conventions">
<span id="id52"></span><h3><a class="toc-backref" href="#id255">Conventions</a><a class="headerlink" href="#conventions" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Conventions</span></code> netCDF global attribute containing the version of
the CF conventions is always automatically created. If the version of
the CF conventions has been set as a field property, or with the
<em>Conventions</em> keyword of the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function, then it is
ignored. However, other conventions that may apply can be set with
either technique.</p>
</section>
<section id="scalar-coordinate-variables">
<span id="id53"></span><h3><a class="toc-backref" href="#id256">Scalar coordinate variables</a><a class="headerlink" href="#scalar-coordinate-variables" title="Permalink to this headline">¶</a></h3>
<p>A CF-netCDF scalar (i.e. zero-dimensional) coordinate variable is
created from a size one dimension coordinate construct that spans a
domain axis construct which is not spanned by the field construct’s
data, nor the data of any other metadata construct. This occurs for
the field construct <code class="docutils literal notranslate"><span class="pre">q</span></code>, for which the “time” dimension coordinate
construct was to the file <code class="docutils literal notranslate"><span class="pre">q_file.nc</span></code> as a scalar coordinate
variable.</p>
<p>To change this so that the “time” dimension coordinate construct is
written as a CF-netCDF size one coordinate variable, the field
construct’s data must be expanded to span the corresponding size one
domain axis construct, by using the <a class="reference internal" href="method/cfdm.Field.insert_dimension.html#cfdm.Field.insert_dimension" title="cfdm.Field.insert_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insert_dimension</span></code></a> method
of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id175">
<div class="code-block-caption"><span class="caption-text"><em>Write the “time” dimension coordinate construct to a
(non-scalar) CF-netCDF coordinate variable by inserting
the corresponding dimension into the field construct’s
data.</em></span><a class="headerlink" href="#id175" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">&lt;Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span>
<span class="go">(&#39;domainaxis2&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">insert_dimension</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span>
<span class="go">&lt;Field: specific_humidity(time(1), latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="s1">&#39;q2_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new dataset is structured as follows (note, relative to file
<code class="docutils literal notranslate"><span class="pre">q_file.nc</span></code>, the existence of the “time” dimension and the lack of a
<code class="docutils literal notranslate"><span class="pre">coordinates</span></code> attribute on the, now three-dimensional, data
variable):</p>
<div class="literal-block-wrapper docutils container" id="id176">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id176" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump -h q2_file.nc
<span class="go">netcdf q2_file {</span>
<span class="go">dimensions:</span>
<span class="go">     lat = 5 ;</span>
<span class="go">     bounds2 = 2 ;</span>
<span class="go">     lon = 8 ;</span>
<span class="go">     time = 1 ;</span>
<span class="go">variables:</span>
<span class="go">     double lat_bnds(lat, bounds2) ;</span>
<span class="go">     double lat(lat) ;</span>
<span class="go">             lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">             lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">             lat:bounds = &quot;lat_bnds&quot; ;</span>
<span class="go">     double lon_bnds(lon, bounds2) ;</span>
<span class="go">     double lon(lon) ;</span>
<span class="go">             lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">             lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">             lon:bounds = &quot;lon_bnds&quot; ;</span>
<span class="go">     double time(time) ;</span>
<span class="go">             time:units = &quot;days since 2018-12-01&quot; ;</span>
<span class="go">             time:standard_name = &quot;time&quot; ;</span>
<span class="go">     double humidity(time, lat, lon) ;</span>
<span class="go">             humidity:units = &quot;1&quot; ;</span>
<span class="go">             humidity:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">             humidity:cell_methods = &quot;area: mean&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.9&quot; ;</span>
<span class="go">             :project = &quot;research&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
</section>
<section id="compressed-constructs">
<span id="id54"></span><h3><a class="toc-backref" href="#id257">Compressed constructs</a><a class="headerlink" href="#compressed-constructs" title="Permalink to this headline">¶</a></h3>
<p>Constructs that contain compressed data will be automatically written
to a dataset with the correct compression encoding. See the section on
<a class="reference internal" href="#compression"><span class="std std-ref">compression</span></a> for details.</p>
</section>
<section id="strings">
<span id="id55"></span><h3><a class="toc-backref" href="#id258">Strings</a><a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h3>
<p>String-valued data may be written to netCDF files either as netCDF
character arrays with a trailing dimension large enough to contain the
longest value, or as netCDF4 string arrays. The former is allowed for
all formats of netCDF3 and netCDF4 format files; but string arrays may
only be written to netCDF4 format files (note that string arrays can
not be written to netCDF4 classic format files).</p>
<p>By default, netCDF string arrays will be created whenever possible,
and in all other cases netCDF character arrays will be
used. Alternatively, netCDF character arrays can be used in all cases
by setting the <em>string</em> keyword of the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function.</p>
</section>
<section id="groups">
<h3><a class="toc-backref" href="#id259">Groups</a><a class="headerlink" href="#groups" title="Permalink to this headline">¶</a></h3>
<p>NetCDF4 files with hierarchical groups may be created if a group
structure is defined by the netCDF variable and dimension names,
accessed via the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>.  See the
section on <a class="reference internal" href="#hierarchical-groups"><span class="std std-ref">hierarchical groups</span></a> for
details.</p>
<hr class="docutils" />
</section>
</section>
<section id="hierarchical-groups">
<span id="id56"></span><h2><a class="toc-backref" href="#id260"><strong>Hierarchical groups</strong></a><a class="headerlink" href="#hierarchical-groups" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#groups">Hierarchical groups</a> provide a mechanism to structure variables
within netCDF4 datasets, with well defined rules for resolving
references to out-of-group netCDF variables and dimensions.</p>
<p>A group structure that may be applied when writing to disk can be
created ab initio with the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>. For example, the data variable and a coordinate
construct may be moved to a sub-group that has its own group
attribute, and a coordinate construct may be moved to a different
sub-group:</p>
<div class="literal-block-wrapper docutils container" id="id177">
<div class="code-block-caption"><span class="caption-text"><em>Create a group structure and write it to disk.</em></span><a class="headerlink" href="#id177" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%/forecast/model/q)</span>
<span class="go">--------------------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_set_group_attribute</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="s1">&#39;group comment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_set_variable_groups</span><span class="p">([</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">])</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nc_set_variable_groups</span><span class="p">([</span><span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;grouped.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id178">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new grouped dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id178" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump -h grouped.nc
<span class="go">netcdf grouped {</span>
<span class="go">dimensions:</span>
<span class="go">        lat = 5 ;</span>
<span class="go">        bounds2 = 2 ;</span>
<span class="go">        lon = 8 ;</span>
<span class="go">variables:</span>
<span class="go">        double lat_bnds(lat, bounds2) ;</span>
<span class="go">        double lat(lat) ;</span>
<span class="go">                lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">                lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">                lat:bounds = &quot;lat_bnds&quot; ;</span>
<span class="go">        double lon_bnds(lon, bounds2) ;</span>
<span class="go">        double lon(lon) ;</span>
<span class="go">                lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">                lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">                lon:bounds = &quot;lon_bnds&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">                :Conventions = &quot;CF-1.8&quot; ;</span>
<span class="go">                :comment = &quot;comment&quot; ;</span>

<span class="go">group: forecast {</span>
<span class="go">  variables:</span>
<span class="go">        double time ;</span>
<span class="go">                time:units = &quot;days since 2018-12-01&quot; ;</span>
<span class="go">                time:standard_name = &quot;time&quot; ;</span>

<span class="go">  group: model {</span>
<span class="go">    variables:</span>
<span class="go">        double q(lat, lon) ;</span>
<span class="go">                q:project = &quot;research&quot; ;</span>
<span class="go">                q:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">                q:units = &quot;1&quot; ;</span>
<span class="go">                q:coordinates = &quot;time&quot; ;</span>
<span class="go">                q:cell_methods = &quot;area: mean&quot; ;</span>

<span class="go">    // group attributes:</span>
<span class="go">                :comment = &quot;group comment&quot; ;</span>
<span class="go">    } // group model</span>
<span class="go">  } // group forecast</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>When reading a netCDF dataset, the group structure and groups
attributes are recorded and are made accessible via the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF
interface</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id179">
<div class="code-block-caption"><span class="caption-text"><em>Read the grouped file and inspect its group structure.</em></span><a class="headerlink" href="#id179" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;grouped.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%/forecast/q)</span>
<span class="go">--------------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;/forecast/model/q&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nc_variable_groups</span><span class="p">()</span>
<span class="go">(&#39;forecast&#39;, &#39;model&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nc_group_attributes</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">{&#39;comment&#39;: &#39;group comment&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;lat&#39;</span>
</pre></div>
</div>
</div>
<p>By default field constructs are written out to a dataset with their
groups struct (if any) intact. It is always possible, however, to
create a “flat” dataset, i.e. one without any sub-groups. This does
not require the removal of the group structure from the field
construct and all of its components (although that is possible), as it
can be done by simply by overriding the existing group structure by
setting the <em>group</em> keyword to <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id180">
<div class="code-block-caption"><span class="caption-text"><em>Write the field construct to a file with the same group
structure, and also to a flat file.</em></span><a class="headerlink" href="#id180" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;flat.nc&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>NetCDF variables in the flattened output file will inherit any netCDF
group attributes, providing that they are not superceded by variable
attributes. The output netCDF variable and dimension names will be
taken as the basenames of any that have been pre-defined. This is the
case in file <code class="docutils literal notranslate"><span class="pre">flat.nc</span></code>, for which the netCDF variable <code class="docutils literal notranslate"><span class="pre">q</span></code> has
inherited the <code class="docutils literal notranslate"><span class="pre">comment</span></code> attribute that was originally set on the
<code class="docutils literal notranslate"><span class="pre">/forecast/model</span></code> group. NetCDF group attributes may be set and
accessed via the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>, for both
netCDF variable and netCDF dimensions.</p>
<div class="literal-block-wrapper docutils container" id="id181">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the flat version of the dataset with the ncdump
command line tool.</em></span><a class="headerlink" href="#id181" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump -h flat_out.nc
<span class="go">netcdf flat {</span>
<span class="go">dimensions:</span>
<span class="go">        lat = 5 ;</span>
<span class="go">        bounds2 = 2 ;</span>
<span class="go">        lon = 8 ;</span>
<span class="go">variables:</span>
<span class="go">        double lat_bnds(lat, bounds2) ;</span>
<span class="go">        double lat(lat) ;</span>
<span class="go">                lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">                lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">                lat:bounds = &quot;lat_bnds&quot; ;</span>
<span class="go">        double lon_bnds(lon, bounds2) ;</span>
<span class="go">        double lon(lon) ;</span>
<span class="go">                lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">                lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">                lon:bounds = &quot;lon_bnds&quot; ;</span>
<span class="go">        double time ;</span>
<span class="go">                time:units = &quot;days since 2018-12-01&quot; ;</span>
<span class="go">                time:standard_name = &quot;time&quot; ;</span>
<span class="go">        double q(lat, lon) ;</span>
<span class="go">                q:comment = &quot;group comment&quot; ;</span>
<span class="go">                q:project = &quot;research&quot; ;</span>
<span class="go">                q:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">                q:units = &quot;1&quot; ;</span>
<span class="go">                q:coordinates = &quot;time&quot; ;</span>
<span class="go">                q:cell_methods = &quot;area: mean&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">                :Conventions = &quot;CF-1.8&quot; ;</span>
<span class="go">                :comment = &quot;comment&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>The fields constructs read from a grouped file are identical to those
read from the flat version of the file:</p>
<div class="literal-block-wrapper docutils container" id="id182">
<div class="code-block-caption"><span class="caption-text"><em>Demonstrate that the field constructs are independent of
the dataset structure.</em></span><a class="headerlink" href="#id182" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;flat.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="external-variables">
<span id="id57"></span><h2><a class="toc-backref" href="#id261"><strong>External variables</strong></a><a class="headerlink" href="#external-variables" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#external-variables">External variables</a> are those in a netCDF file that are referred to,
but which are not present in it. Instead, such variables are stored in
other netCDF files known as “external files”. External variables may,
however, be incorporated into the field constructs of the dataset, as
if they had actually been stored in the same file, simply by providing
the external file names to the <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> function.</p>
<p>An external variables file name may describe relative paths, and
standard tilde and shell parameter expansions are applied to it.</p>
<p>This is illustrated with the files <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code> (found in the
<a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id183">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the parent dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id183" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump -h parent.nc
<span class="go">netcdf parent {</span>
<span class="go">dimensions:</span>
<span class="go">     latitude = 10 ;</span>
<span class="go">     longitude = 9 ;</span>
<span class="go">variables:</span>
<span class="go">     double latitude(latitude) ;</span>
<span class="go">             latitude:units = &quot;degrees_north&quot; ;</span>
<span class="go">             latitude:standard_name = &quot;latitude&quot; ;</span>
<span class="go">     double longitude(longitude) ;</span>
<span class="go">             longitude:units = &quot;degrees_east&quot; ;</span>
<span class="go">             longitude:standard_name = &quot;longitude&quot; ;</span>
<span class="go">     double eastward_wind(latitude, longitude) ;</span>
<span class="go">             eastward_wind:units = &quot;m s-1&quot; ;</span>
<span class="go">             eastward_wind:standard_name = &quot;eastward_wind&quot; ;</span>
<span class="go">             eastward_wind:cell_measures = &quot;area: areacella&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">             :external_variables = &quot;areacella&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>and <code class="docutils literal notranslate"><span class="pre">external.nc</span></code> (found in the <a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id184">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the external dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id184" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump -h external.nc
<span class="go">netcdf external {</span>
<span class="go">dimensions:</span>
<span class="go">     latitude = 10 ;</span>
<span class="go">     longitude = 9 ;</span>
<span class="go">variables:</span>
<span class="go">     double areacella(longitude, latitude) ;</span>
<span class="go">             areacella:units = &quot;m2&quot; ;</span>
<span class="go">             areacella:standard_name = &quot;cell_area&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>The dataset in <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code> may be read <em>without</em> specifying the
external file <code class="docutils literal notranslate"><span class="pre">external.nc</span></code>. In this case a cell measure construct
is still created, but one without any metadata or data:</p>
<div class="literal-block-wrapper docutils container" id="id185">
<div class="code-block-caption"><span class="caption-text"><em>Read the parent dataset without specifying the location
of any external datasets.</em></span><a class="headerlink" href="#id185" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;parent.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Cell measures   : measure:area (external variable: ncvar%areacella)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CellMeasure: measure:area &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_external</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;areacella&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<p>If this field construct were to be written to disk using <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a>,
then the output file would be identical to the original <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code>
file, i.e. the netCDF variable name of the cell measure construct
(<code class="docutils literal notranslate"><span class="pre">areacella</span></code>) would be listed by the <code class="docutils literal notranslate"><span class="pre">external_variables</span></code> global
attribute.</p>
<p>However, the dataset may also be read <em>with</em> the external file. In
this case a cell measure construct is created with all of the metadata
and data from the external file, as if the netCDF cell measure
variable had been present in the parent dataset:</p>
<div class="literal-block-wrapper docutils container" id="id186">
<div class="code-block-caption"><span class="caption-text"><em>Read the parent dataset whilst providing the external
dataset containing the external variables.</em></span><a class="headerlink" href="#id186" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;parent.nc&#39;</span><span class="p">,</span> <span class="n">external</span><span class="o">=</span><span class="s1">&#39;external.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Cell measures   : cell_area(longitude(9), latitude(10)) = [[100000.5, ..., 100089.5]] m2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CellMeasure: cell_area(9, 10) m2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_external</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;areacella&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;cell_area&#39;, &#39;units&#39;: &#39;m2&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;Data(9, 10): [[100000.5, ..., 100089.5]] m2&gt;</span>
</pre></div>
</div>
</div>
<p>If this field construct were to be written to disk using <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a>
then by default the cell measure construct, with all of its metadata
and data, would be written to the named output file, along with all of
the other constructs. There would be no <code class="docutils literal notranslate"><span class="pre">external_variables</span></code> global
attribute.</p>
<p>To create a reference to an external variable in an output netCDF
file, set the status of the cell measure construct to “external” with
its <a class="reference internal" href="method/cfdm.CellMeasure.nc_set_external.html#cfdm.CellMeasure.nc_set_external" title="cfdm.CellMeasure.nc_set_external"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_external</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id187">
<div class="code-block-caption"><span class="caption-text"><em>Flag the cell measure as external and write the field
construct to a new file.</em></span><a class="headerlink" href="#id187" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_set_external</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;new_parent.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To create a reference to an external variable in the an output netCDF
file and simultaneously create an external file containing the
variable, set the status of the cell measure construct to “external”
and provide an external file name to the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function:</p>
<div class="literal-block-wrapper docutils container" id="id188">
<div class="code-block-caption"><span class="caption-text"><em>Write the field construct to a new file and the cell
measure construct to an external file.</em></span><a class="headerlink" href="#id188" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;new_parent.nc&#39;</span><span class="p">,</span> <span class="n">external</span><span class="o">=</span><span class="s1">&#39;new_external.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="external-files-with-cfdump">
<span id="external-variables-with-cfdump"></span><h3><a class="toc-backref" href="#id262">External files with cfdump</a><a class="headerlink" href="#external-files-with-cfdump" title="Permalink to this headline">¶</a></h3>
<p>One or more external files may also be included with <a class="reference internal" href="#cfdump"><span class="std std-ref">cfdump</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id189">
<div class="code-block-caption"><span class="caption-text"><em>Use cfdump to describe the parent file without resolving
the external variable reference.</em></span><a class="headerlink" href="#id189" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cfdump parent.nc
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees_north</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees_east</span>
<span class="go">Cell measures   : measure:area (external variable: ncvar%areacella)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id190">
<div class="code-block-caption"><span class="caption-text"><em>Providing an external file with the “-e” option allows
the reference to be resolved.</em></span><a class="headerlink" href="#id190" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cfdump -e external.nc parent.nc
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees_north</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees_east</span>
<span class="go">Cell measures   : measure:area(longitude(9), latitude(10)) = [[100000.5, ..., 100089.5]] m2</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="compression">
<span id="id58"></span><h2><a class="toc-backref" href="#id263"><strong>Compression</strong></a><a class="headerlink" href="#compression" title="Permalink to this headline">¶</a></h2>
<p>The CF conventions have support for saving space by identifying
unwanted missing data.  Such compression techniques store the data
more efficiently and result in no precision loss. The CF data model,
however, views compressed arrays in their uncompressed form.</p>
<p>Therefore, the field construct contains <a class="reference internal" href="cf_data_model.html#term-domain-axis-constructs"><span class="xref std std-term">domain axis constructs</span></a>
for the compressed dimensions and presents a view of compressed data
in its uncompressed form, even though the “underlying array” (i.e. the
actual array on disk or in memory that is contained in a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a>
instance) is compressed. This means that the cfdm package includes
algorithms for uncompressing each type of compressed array.</p>
<p>There are two basic types of compression supported by the CF
conventions: ragged arrays (as used by <a class="reference internal" href="#discrete-sampling-geometries"><span class="std std-ref">discrete sampling
geometries</span></a>) and <a class="reference internal" href="#gathering"><span class="std std-ref">compression by
gathering</span></a>, each of which has particular implementation
details, but the following access patterns and behaviours apply to
both:</p>
<ul class="simple">
<li><p>Whether or not the data are compressed is tested with the
<a class="reference internal" href="method/cfdm.Data.get_compression_type.html#cfdm.Data.get_compression_type" title="cfdm.Data.get_compression_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_compression_type</span></code></a> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p></li>
</ul>
<ul class="simple">
<li><p>Accessing the data via the <a class="reference internal" href="attribute/cfdm.Data.array.html#cfdm.Data.array" title="cfdm.Data.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> attribute of a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a>
instance returns a numpy array that is uncompressed. The underlying
array will, however, remain in its compressed form. The compressed
underlying array may be retrieved as a numpy array with the
<a class="reference internal" href="attribute/cfdm.Data.compressed_array.html#cfdm.Data.compressed_array" title="cfdm.Data.compressed_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compressed_array</span></code></a> attribute of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p></li>
</ul>
<ul class="simple">
<li><p>A <a class="reference internal" href="#subspacing"><span class="std std-ref">subspace</span></a> of a field construct is created with
indices of the uncompressed form of the data. The new subspace will
no longer be compressed, i.e. its underlying arrays will be
uncompressed, but the original data will remain compressed. It
follows that to uncompress all of the data in a field construct,
index the field construct with (indices equivalent to) <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Ellipsis</span></code></a>.</p></li>
</ul>
<ul class="simple">
<li><p>If data elements are modified by <a class="reference internal" href="#assignment"><span class="std std-ref">assigning</span></a> to
indices of the uncompressed form of the data, then the compressed
underlying array is replaced by its uncompressed form.</p></li>
</ul>
<ul class="simple">
<li><p>An uncompressed field construct can be compressed, prior to being
written to a dataset, with its <a class="reference internal" href="method/cfdm.Field.compress.html#cfdm.Field.compress" title="cfdm.Field.compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compress</span></code></a> method, which also
compresses the metadata constructs as required.</p></li>
</ul>
<ul class="simple">
<li><p>An compressed field construct can be uncompressed with its
<a class="reference internal" href="method/cfdm.Field.uncompress.html#cfdm.Field.uncompress" title="cfdm.Field.uncompress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uncompress</span></code></a> method, which also uncompresses the metadata
constructs as required.</p></li>
</ul>
<ul class="simple">
<li><p>If an underlying array is compressed at the time of writing to disk
with the <a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> function, then it is written to the file as a
compressed array, along with the supplementary netCDF variables and
attributes that are required for the encoding. This means that if a
dataset using compression is read from disk then it will be written
back to disk with the same compression, unless data elements have
been modified by assignment.</p></li>
</ul>
<p>Examples of all of the above may be found in the sections on
<a class="reference internal" href="#discrete-sampling-geometries"><span class="std std-ref">discrete sampling geometries</span></a> and
<a class="reference internal" href="#gathering"><span class="std std-ref">gathering</span></a>.</p>
<section id="discrete-sampling-geometries">
<span id="id59"></span><h3><a class="toc-backref" href="#id264">Discrete sampling geometries</a><a class="headerlink" href="#discrete-sampling-geometries" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#discrete-sampling-geometries">Discrete sampling geometry (DSG)</a> features may be compressed by
combining them using one of three ragged array representations:
<a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_contiguous_ragged_array_representation">contiguous</a>, <a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_indexed_ragged_array_representation">indexed</a> or <a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_ragged_array_representation_of_time_series_profiles">indexed contiguous</a>.</p>
<p>The count variable that is required to uncompress a contiguous, or
indexed contiguous, ragged array is stored in a <a class="reference internal" href="class/cfdm.Count.html#cfdm.Count" title="cfdm.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a> instance and
is accessed with the <a class="reference internal" href="method/cfdm.Data.get_count.html#cfdm.Data.get_count" title="cfdm.Data.get_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_count</span></code></a> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<p>The index variable that is required to uncompress an indexed, or
indexed contiguous, ragged array is stored in an <a class="reference internal" href="class/cfdm.Index.html#cfdm.Index" title="cfdm.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a> instance and
is accessed with the <a class="reference internal" href="method/cfdm.Data.get_index.html#cfdm.Data.get_index" title="cfdm.Data.get_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_index</span></code></a> method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<p>The contiguous case is is illustrated with the file <code class="docutils literal notranslate"><span class="pre">contiguous.nc</span></code>
(found in the <a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id191">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the compressed dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id191" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump -h contiguous.nc
<span class="go">dimensions:</span>
<span class="go">     station = 4 ;</span>
<span class="go">     obs = 24 ;</span>
<span class="go">     strlen8 = 8 ;</span>
<span class="go">variables:</span>
<span class="go">     int row_size(station) ;</span>
<span class="go">             row_size:long_name = &quot;number of observations for this station&quot; ;</span>
<span class="go">             row_size:sample_dimension = &quot;obs&quot; ;</span>
<span class="go">     double time(obs) ;</span>
<span class="go">             time:units = &quot;days since 1970-01-01 00:00:00&quot; ;</span>
<span class="go">             time:standard_name = &quot;time&quot; ;</span>
<span class="go">     double lat(station) ;</span>
<span class="go">             lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">             lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">     double lon(station) ;</span>
<span class="go">             lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">             lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">     double alt(station) ;</span>
<span class="go">             alt:units = &quot;m&quot; ;</span>
<span class="go">             alt:positive = &quot;up&quot; ;</span>
<span class="go">             alt:standard_name = &quot;height&quot; ;</span>
<span class="go">             alt:axis = &quot;Z&quot; ;</span>
<span class="go">     char station_name(station, strlen8) ;</span>
<span class="go">             station_name:long_name = &quot;station name&quot; ;</span>
<span class="go">             station_name:cf_role = &quot;timeseries_id&quot; ;</span>
<span class="go">     double humidity(obs) ;</span>
<span class="go">             humidity:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">             humidity:coordinates = &quot;time lat lon alt station_name&quot; ;</span>
<span class="go">             humidity:_FillValue = -999.9 ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">             :featureType = &quot;timeSeries&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>Reading and inspecting this file shows the data presented in
two-dimensional uncompressed form, whilst the underlying array is
still in the one-dimension ragged representation described in the
file:</p>
<div class="literal-block-wrapper docutils container" id="id192">
<div class="code-block-caption"><span class="caption-text"><em>Read a field construct from a dataset that has been
compressed with contiguous ragged arrays, and inspect its
data in uncompressed form.</em></span><a class="headerlink" href="#id192" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;contiguous.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(ncdim%station(4), ncdim%timeseries(9))</span>
<span class="go">Dimension coords:</span>
<span class="go">Auxiliary coords: time(ncdim%station(4), ncdim%timeseries(9)) = [[1969-12-29 00:00:00, ..., 1970-01-07 00:00:00]]</span>
<span class="go">                : latitude(ncdim%station(4)) = [-9.0, ..., 78.0] degrees_north</span>
<span class="go">                : longitude(ncdim%station(4)) = [-23.0, ..., 178.0] degrees_east</span>
<span class="go">                : height(ncdim%station(4)) = [0.5, ..., 345.0] m</span>
<span class="go">                : cf_role:timeseries_id(ncdim%station(4)) = [station1, ..., station4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.12 0.05 0.18   --   --   --   --   --   --]</span>
<span class="go"> [0.05 0.11 0.2  0.15 0.08 0.04 0.06   --   --]</span>
<span class="go"> [0.15 0.19 0.15 0.17 0.07   --   --   --   --]</span>
<span class="go"> [0.11 0.03 0.14 0.16 0.02 0.09 0.1  0.04 0.11]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id193">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the underlying compressed array and the count
variable that defines how to uncompress the data.</em></span><a class="headerlink" href="#id193" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[0.12 0.05 0.18 0.05 0.11 0.2 0.15 0.08 0.04 0.06 0.15 0.19 0.15 0.17 0.07</span>
<span class="go"> 0.11 0.03 0.14 0.16 0.02 0.09 0.1 0.04 0.11]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span>
<span class="go">&lt;Count: long_name=number of observations for this station(4) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_variable</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[3 7 5 9]</span>
</pre></div>
</div>
</div>
<p>The timeseries for the second station is easily selected by indexing
the “station” axis of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id194">
<div class="code-block-caption"><span class="caption-text"><em>Get the data for the second station.</em></span><a class="headerlink" href="#id194" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">station2</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">station2</span>
<span class="go">&lt;Field: specific_humidity(ncdim%station(1), ncdim%timeseries(9))&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">station2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.05 0.11 0.2 0.15 0.08 0.04 0.06 -- --]]</span>
</pre></div>
</div>
</div>
<p>The underlying array of original data remains in compressed form until
data array elements are modified:</p>
<div class="literal-block-wrapper docutils container" id="id195">
<div class="code-block-caption"><span class="caption-text"><em>Change an element of the data and show that the
underlying array is no longer compressed.</em></span><a class="headerlink" href="#id195" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.12 0.05 0.18   --   --   --   --   --   --]</span>
<span class="go"> [0.05 0.11 -9.0 0.15 0.08 0.04 0.06   --   --]</span>
<span class="go"> [0.15 0.19 0.15 0.17 0.07   --   --   --   --]</span>
<span class="go"> [0.11 0.03 0.14 0.16 0.02 0.09 0.1  0.04 0.11]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</div>
<p>The easiest way to create a compressed field construct is to create
the equivalent uncompressed field construct and then compress it with
its <a class="reference internal" href="method/cfdm.Field.compress.html#cfdm.Field.compress" title="cfdm.Field.compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compress</span></code></a> method, which also compresses the metadata
constructs as required.</p>
<div class="literal-block-wrapper docutils container" id="id196">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct and then compress it.</em></span><a class="headerlink" href="#id196" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Define the array values</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">280.0</span><span class="p">,</span>   <span class="o">-</span><span class="mi">99</span><span class="p">,</span>   <span class="o">-</span><span class="mi">99</span><span class="p">,</span>   <span class="o">-</span><span class="mi">99</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">281.0</span><span class="p">,</span> <span class="mf">279.0</span><span class="p">,</span> <span class="mf">278.0</span><span class="p">,</span> <span class="mf">279.5</span><span class="p">]],</span>
                 <span class="n">mask</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

<span class="c1"># Create the field construct</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;featureType&#39;</span><span class="p">:</span> <span class="s1">&#39;timeSeries&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">])</span>

<span class="c1"># Compress the data</span>
<span class="n">T</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="s1">&#39;contiguous&#39;</span><span class="p">,</span>
           <span class="n">count_properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;number of obs for this timeseries&#39;</span><span class="p">},</span>
           <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new field construct can now be inspected and written to a netCDF file:</p>
<div class="literal-block-wrapper docutils container" id="id197">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct and write it to disk.</em></span><a class="headerlink" href="#id197" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span>
<span class="go">&lt;Field: air_temperature(key%domainaxis1(2), key%domainaxis0(4)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[280.0    --    --    --]</span>
<span class="go"> [281.0 279.0 278.0 279.5]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[280.  281.  279.  278.  279.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span>
<span class="go">&lt;Count: long_name=number of obs for this timeseries(2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_variable</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;T_contiguous.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The content of the new file is:</p>
<div class="literal-block-wrapper docutils container" id="id198">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new compressed dataset with the ncdump
command line tool.</em></span><a class="headerlink" href="#id198" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump T_contiguous.nc
<span class="go">netcdf T_contiguous {</span>
<span class="go">dimensions:</span>
<span class="go">     dim = 2 ;</span>
<span class="go">     element = 5 ;</span>
<span class="go">variables:</span>
<span class="go">     int64 count(dim) ;</span>
<span class="go">             count:long_name = &quot;number of obs for this timeseries&quot; ;</span>
<span class="go">             count:sample_dimension = &quot;element&quot; ;</span>
<span class="go">     float air_temperature(element) ;</span>
<span class="go">             air_temperature:units = &quot;K&quot; ;</span>
<span class="go">             air_temperature:standard_name = &quot;air_temperature&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">             :featureType = &quot;timeSeries&quot; ;</span>
<span class="go">data:</span>

<span class="go"> count = 1, 4 ;</span>

<span class="go"> air_temperature = 280, 281, 279, 278, 279.5 ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>Exactly the same field construct may be also created explicitly with
underlying compressed data. A construct with an underlying ragged
array is created by initialising a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance with a ragged
array that is stored in one of three special array objects:
<a class="reference internal" href="class/cfdm.RaggedContiguousArray.html#cfdm.RaggedContiguousArray" title="cfdm.RaggedContiguousArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedContiguousArray</span></code></a>, <a class="reference internal" href="class/cfdm.RaggedIndexedArray.html#cfdm.RaggedIndexedArray" title="cfdm.RaggedIndexedArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedIndexedArray</span></code></a> or
<a class="reference internal" href="class/cfdm.RaggedIndexedContiguousArray.html#cfdm.RaggedIndexedContiguousArray" title="cfdm.RaggedIndexedContiguousArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedIndexedContiguousArray</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id199">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with compressed data.</em></span><a class="headerlink" href="#id199" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Define the ragged array values</span>
<span class="n">ragged_array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">279</span><span class="p">,</span> <span class="mi">278</span><span class="p">,</span> <span class="mf">279.5</span><span class="p">])</span>

<span class="c1"># Define the count array values</span>
<span class="n">count_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="c1"># Create the count variable</span>
<span class="n">count_variable</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">count_array</span><span class="p">))</span>
<span class="n">count_variable</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;number of obs for this timeseries&#39;</span><span class="p">)</span>

<span class="c1"># Create the contiguous ragged array object, specifying the</span>
<span class="c1"># uncompressed shape</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">RaggedContiguousArray</span><span class="p">(</span>
                 <span class="n">compressed_array</span><span class="o">=</span><span class="n">ragged_array</span><span class="p">,</span>
                 <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">count_variable</span><span class="o">=</span><span class="n">count_variable</span><span class="p">)</span>

<span class="c1"># Create the field construct with the domain axes and the ragged</span>
<span class="c1"># array</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;featureType&#39;</span><span class="p">:</span> <span class="s1">&#39;timeSeries&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs for the uncompressed array</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="gathering">
<span id="id60"></span><h3><a class="toc-backref" href="#id265">Gathering</a><a class="headerlink" href="#gathering" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#compression-by-gathering">Compression by gathering</a> combines axes of a multidimensional array
into a new, discrete axis whilst omitting the missing values and thus
reducing the number of values that need to be stored.</p>
<p>The list variable that is required to uncompress a gathered array is
stored in a <a class="reference internal" href="class/cfdm.List.html#cfdm.List" title="cfdm.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a> object and is retrieved with the <a class="reference internal" href="method/cfdm.Data.get_list.html#cfdm.Data.get_list" title="cfdm.Data.get_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_list</span></code></a>
method of the <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance.</p>
<p>This is illustrated with the file <code class="docutils literal notranslate"><span class="pre">gathered.nc</span></code> (found in the
<a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id200">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the compressed dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id200" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump -h gathered.nc
<span class="go">netcdf gathered {</span>
<span class="go">dimensions:</span>
<span class="go">     time = 2 ;</span>
<span class="go">     lat = 4 ;</span>
<span class="go">     lon = 5 ;</span>
<span class="go">     landpoint = 7 ;</span>
<span class="go">variables:</span>
<span class="go">     double time(time) ;</span>
<span class="go">             time:standard_name = &quot;time&quot; ;</span>
<span class="go">             time:units = &quot;days since 2000-1-1&quot; ;</span>
<span class="go">     double lat(lat) ;</span>
<span class="go">             lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">             lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">     double lon(lon) ;</span>
<span class="go">             lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">             lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">     int landpoint(landpoint) ;</span>
<span class="go">             landpoint:compress = &quot;lat lon&quot; ;</span>
<span class="go">     double pr(time, landpoint) ;</span>
<span class="go">             pr:standard_name = &quot;precipitation_flux&quot; ;</span>
<span class="go">             pr:units = &quot;kg m2 s-1&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>Reading and inspecting this file shows the data presented in
three-dimensional uncompressed form, whilst the underlying array is
still in the two-dimensional gathered representation described in the
file:</p>
<div class="literal-block-wrapper docutils container" id="id201">
<div class="code-block-caption"><span class="caption-text"><em>Read a field construct from a dataset that has been
compressed by gathering, and inspect its data in
uncompressed form.</em></span><a class="headerlink" href="#id201" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;gathered.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">Field: precipitation_flux (ncvar%pr)</span>
<span class="go">------------------------------------</span>
<span class="go">Data            : precipitation_flux(time(2), latitude(4), longitude(5)) kg m2 s-1</span>
<span class="go">Dimension coords: time(2) = [2000-02-01 00:00:00, 2000-03-01 00:00:00]</span>
<span class="go">                : latitude(4) = [-90.0, ..., -75.0] degrees_north</span>
<span class="go">                : longitude(5) = [0.0, ..., 40.0] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[--       0.000122 0.0008   --       --      ]</span>
<span class="go">  [0.000177 --       0.000175 0.00058  --      ]</span>
<span class="go">  [--       --       --       --       --      ]</span>
<span class="go">  [--       0.000206 --       0.0007   --      ]]</span>

<span class="go"> [[--       0.000202 0.000174 --       --      ]</span>
<span class="go">  [0.00084  --       0.000201 0.0057   --      ]</span>
<span class="go">  [--       --       --       --       --      ]</span>
<span class="go">  [--       0.000223 --       0.000102 --      ]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id202">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the underlying compressed array and the list
variable that defines how to uncompress the data.</em></span><a class="headerlink" href="#id202" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[[0.000122 0.0008   0.000177 0.000175 0.00058 0.000206 0.0007  ]</span>
<span class="go"> [0.000202 0.000174 0.00084  0.000201 0.0057  0.000223 0.000102]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span>
<span class="go">&lt;List: ncvar%landpoint(7) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">list_variable</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 2 5 7 8 16 18]</span>
</pre></div>
</div>
</div>
<p>Subspaces based on the uncompressed axes of the field construct are
easily created:</p>
<div class="literal-block-wrapper docutils container" id="id203">
<div class="code-block-caption"><span class="caption-text"><em>Get subspaces based on indices of the uncompressed
data.</em></span><a class="headerlink" href="#id203" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Field: precipitation_flux(time(1), latitude(4), longitude(5)) kg m2 s-1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">&lt;Field: precipitation_flux(time(1), latitude(4), longitude(2)) kg m2 s-1&gt;</span>
</pre></div>
</div>
</div>
<p>The underlying array of original data remains in compressed form until
data array elements are modified:</p>
<div class="literal-block-wrapper docutils container" id="id204">
<div class="code-block-caption"><span class="caption-text"><em>Change an element of the data and show that the
underlying array is no longer compressed.</em></span><a class="headerlink" href="#id204" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</div>
<p>A construct with an underlying gathered array is created by
initializing a <a class="reference internal" href="class/cfdm.Data.html#cfdm.Data" title="cfdm.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance with a gathered array that is stored in
the special <a class="reference internal" href="class/cfdm.GatheredArray.html#cfdm.GatheredArray" title="cfdm.GatheredArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GatheredArray</span></code></a> array object. The following code creates a
simple field construct with an underlying gathered array:</p>
<div class="literal-block-wrapper docutils container" id="id205">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with compressed data.</em></span><a class="headerlink" href="#id205" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cfdm</span>

<span class="c1"># Define the gathered values</span>
<span class="n">gathered_array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>

<span class="c1"># Define the list array values</span>
<span class="n">list_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Create the list variable</span>
<span class="n">list_variable</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">list_array</span><span class="p">))</span>

<span class="c1"># Create the gathered array object, specifying the uncompressed</span>
<span class="c1"># shape</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">GatheredArray</span><span class="p">(</span>
                 <span class="n">compressed_array</span><span class="o">=</span><span class="n">gathered_array</span><span class="p">,</span>
                 <span class="n">compressed_dimension</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                 <span class="n">list_variable</span><span class="o">=</span><span class="n">list_variable</span><span class="p">)</span>

<span class="c1"># Create the field construct with the domain axes and the gathered</span>
<span class="c1"># array</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">cfdm</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;kg m-2 s-1&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs for the uncompressed array</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">P</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cfdm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Note that, because compression by gathering acts on a subset of the
array dimensions, it is necessary to state the position of the
compressed dimension in the compressed array (with the
<code class="docutils literal notranslate"><span class="pre">compressed_dimension</span></code> parameter of the <a class="reference internal" href="class/cfdm.GatheredArray.html#cfdm.GatheredArray" title="cfdm.GatheredArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GatheredArray</span></code></a>
initialisation).</p>
<p>The new field construct can now be inspected and written a netCDF file:</p>
<div class="literal-block-wrapper docutils container" id="id206">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct and write it to disk.</em></span><a class="headerlink" href="#id206" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span>
<span class="go">&lt;Field: precipitation_flux(key%domainaxis0(2), key%domainaxis1(3), key%domainaxis2(2)) kg m-2 s-1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -- 2.0]</span>
<span class="go">  [ --  --]</span>
<span class="go">  [1.0 3.0]]</span>

<span class="go"> [[ -- 4.0]</span>
<span class="go">  [ --  --]</span>
<span class="go">  [0.0 5.0]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[[2. 1. 3.]</span>
<span class="go"> [4. 0. 5.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span>
<span class="go">&lt;List: (3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">list_variable</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 4 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="s1">&#39;P_gathered.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The content of the new file is:</p>
<div class="literal-block-wrapper docutils container" id="id207">
<div class="code-block-caption"><span class="caption-text"><em>Inspect new the compressed dataset with the ncdump
command line tool.</em></span><a class="headerlink" href="#id207" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ncdump P_gathered.nc
<span class="go">netcdf P_gathered {</span>
<span class="go">dimensions:</span>
<span class="go">     dim = 2 ;</span>
<span class="go">     dim_1 = 3 ;</span>
<span class="go">     dim_2 = 2 ;</span>
<span class="go">     list = 3 ;</span>
<span class="go">variables:</span>
<span class="go">     int64 list(list) ;</span>
<span class="go">             list:compress = &quot;dim_1 dim_2&quot; ;</span>
<span class="go">     float precipitation_flux(dim, list) ;</span>
<span class="go">             precipitation_flux:units = &quot;kg m-2 s-1&quot; ;</span>
<span class="go">             precipitation_flux:standard_name = &quot;precipitation_flux&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">data:</span>

<span class="go"> list = 1, 4, 5 ;</span>

<span class="go"> precipitation_flux =</span>
<span class="go">  2, 1, 3,</span>
<span class="go">  4, 0, 5 ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
</section>
<section id="coordinate-subsampling">
<span id="coordinate-subampling"></span><h3><a class="toc-backref" href="#id266">Coordinate subsampling</a><a class="headerlink" href="#coordinate-subsampling" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#compression-by-coordinate-subsampling">Lossy compression by coordinate subsampling</a> was introduced into the
CF conventions at CF-1.9, but is not yet available in cfdm. It will be
ready in a future 1.9.x.0 release.</p>
<hr class="docutils" />
</section>
</section>
<section id="controlling-output-messages">
<span id="id61"></span><h2><a class="toc-backref" href="#id267"><strong>Controlling output messages</strong></a><a class="headerlink" href="#controlling-output-messages" title="Permalink to this headline">¶</a></h2>
<p>cfdm will produce messages upon the execution of operations, to
provide feedback about:</p>
<ul class="simple">
<li><p>the progress of, and under-the-hood steps involved in, the
operations it is performing;</p></li>
<li><p>the events that emerge during these operations;</p></li>
<li><p>the nature of the dataset being operated on, including CF compliance
issues that may be encountered during the operation.</p></li>
</ul>
<p>This feedback may be purely informational, or may convey warning(s)
about dataset issues or the potential for future error(s).</p>
<p>It is possible to configure the extent to which messages are output at
runtime, i.e. the verbosity of cfdm, so that less serious and/or more
detailed messages can be filtered out.</p>
<p>There are two means to do this, which are covered in more detail in
the sub-sections below. Namely, you may configure the extent of
messaging:</p>
<ul class="simple">
<li><p><strong>globally</strong> i.e. for all cfdm operations, by setting the
<a class="reference internal" href="function/cfdm.log_level.html#cfdm.log_level" title="cfdm.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.log_level</span></code></a> which controls the project-wide logging;</p></li>
<li><p><strong>for a specific function only</strong> (for many functions) by setting
that function’s <em>verbose</em> keyword (which overrides the global
setting for the duration of the function call).</p></li>
</ul>
<p>Both possibilities use a consistent level-based cut-off system, as
detailed below.</p>
<section id="logging">
<span id="id62"></span><h3><a class="toc-backref" href="#id268">Logging</a><a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>All messages from cfdm, excluding exceptions which are always raised
in error cases, are incorporated into a logging system which assigns
to each a level based on the relative seriousness and/or
verbosity. From highest to lowest on this scale, these levels are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code>: conveys a warning;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'INFO'</span></code>: provides information concisely, in a few lines or so;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DETAIL'</span></code>: provides information in a more detailed manner than
<code class="docutils literal notranslate"><span class="pre">'INFO'</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code>: produces highly-verbose information intended mainly for
the purposes of debugging and cfdm library development.</p></li>
</ul>
<p>The function <a class="reference internal" href="function/cfdm.log_level.html#cfdm.log_level" title="cfdm.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.log_level</span></code></a> sets the minimum of these levels for
which messages are displayed. Any message marked as being of any lower
level will be filtered out. Note it sets the verbosity <em>globally</em>, for
<em>all</em> cfdm library operations (unless these are overridden for
individual functions, as covered below).</p>
<p>As well as the named log levels above, <a class="reference internal" href="function/cfdm.log_level.html#cfdm.log_level" title="cfdm.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.log_level</span></code></a> accepts a
further identifier, <code class="docutils literal notranslate"><span class="pre">'DISABLE'</span></code>. Each of these potential settings
has a numerical value that is treated interchangeably and may instead
be set (as this may be easier to recall and write, if less
explicit). The resulting behaviour in each case is as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 16%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Log level</p></th>
<th class="head"><p>Integer code</p></th>
<th class="head"><p>Result when set as the log severity level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'DISABLE'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p><em>Disable all</em> logging messages. Note this
does not include exception messages
raised by errors.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code> (default)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p><em>Only show</em> logging messages that are
<em>warnings</em> (those labelled as
<code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'INFO'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p><em>Only show</em> logging messages that are
<em>warnings or concise informational
messages</em> (marked as <code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code> or
<code class="docutils literal notranslate"><span class="pre">'INFO'</span></code> respectively).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'DETAIL'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td><p><em>Enable all</em> logging messages <em>except
for debugging messages</em>. In other words,
show logging messages labelled
<code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code>, <code class="docutils literal notranslate"><span class="pre">'INFO'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'DETAIL'</span></code>, but not <code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-1</span></code></p></td>
<td><p><em>Enable all</em> logging messages,
<em>including debugging messages</em>
(labelled as <code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code>).</p></td>
</tr>
</tbody>
</table>
<p>Note <code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code> is intended as a special case for debugging, which
should not be required in general usage of cfdm, hence its equivalence
to <code class="docutils literal notranslate"><span class="pre">-1</span></code> rather than <code class="docutils literal notranslate"><span class="pre">4</span></code> which would follow the increasing integer
code pattern.  <code class="docutils literal notranslate"><span class="pre">-1</span></code> reflects that it is the final value in the
sequence, as with Python indexing.</p>
<p>The default value for <a class="reference internal" href="function/cfdm.log_level.html#cfdm.log_level" title="cfdm.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.log_level</span></code></a> is <code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code> (<code class="docutils literal notranslate"><span class="pre">1</span></code>).
However, whilst completing this tutorial, it may be instructive to set
the log level` to a higher verbosity level such as <code class="docutils literal notranslate"><span class="pre">'INFO'</span></code> to gain
insight into the internal workings of cfdm calls.</p>
</section>
<section id="function-verbosity">
<span id="id63"></span><h3><a class="toc-backref" href="#id269">Function verbosity</a><a class="headerlink" href="#function-verbosity" title="Permalink to this headline">¶</a></h3>
<p>Functions and methods that involve a particularly high number of steps
or especially complex processing, for example the <a class="reference internal" href="function/cfdm.read.html#cfdm.read" title="cfdm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.read</span></code></a> and
<a class="reference internal" href="function/cfdm.write.html#cfdm.write" title="cfdm.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.write</span></code></a> functions, accept a keyword argument <em>verbose</em>. This be
set to change the minimum log level at which messages are displayed
for the function/method call only, without being influenced by, or
influencing, the global <a class="reference internal" href="function/cfdm.log_level.html#cfdm.log_level" title="cfdm.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.log_level</span></code></a> value.</p>
<p>A <em>verbose</em> value effectively overrides the value of <a class="reference internal" href="function/cfdm.log_level.html#cfdm.log_level" title="cfdm.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.log_level</span></code></a>
for the function/method along with any functions/methods it calls in
turn, until the origin function/method completes.</p>
<p>The <em>verbose</em> argument accepts the same levels as <a class="reference internal" href="function/cfdm.log_level.html#cfdm.log_level" title="cfdm.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.log_level</span></code></a>
(including <code class="docutils literal notranslate"><span class="pre">0</span></code> for <code class="docutils literal notranslate"><span class="pre">'DISABLE'</span></code>), as described in <a class="reference internal" href="#logging"><span class="std std-ref">the logging
section</span></a>, namely either an integer or a corresponding string
for example <code class="docutils literal notranslate"><span class="pre">verbose=2</span></code> or equivalently <code class="docutils literal notranslate"><span class="pre">verbose='INFO'</span></code>
(or <code class="docutils literal notranslate"><span class="pre">verbose='info'</span></code> since case is ignored).</p>
<p>By default, <em>verbose</em> is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, in which case the value of the
<a class="reference internal" href="function/cfdm.log_level.html#cfdm.log_level" title="cfdm.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfdm.log_level</span></code></a> setting is used to determine which messages,
if any, are filtered out.</p>
<p class="rubric">Footnotes</p>
<hr class="docutils" />
<dl class="footnote brackets">
<dt class="label" id="dap"><span class="brackets"><a class="fn-backref" href="#id6">1</a></span></dt>
<dd><p>Requires the netCDF4 python package to have been built with
OPeNDAP support enabled. See
<a class="reference external" href="http://unidata.github.io/netcdf4-python">http://unidata.github.io/netcdf4-python</a> for details.</p>
</dd>
<dt class="label" id="caveat"><span class="brackets"><a class="fn-backref" href="#id7">2</a></span></dt>
<dd><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#compression-by-coordinate-subsampling">Lossy compression by coordinate subsampling</a> was
introduced into the CF conventions at CF-1.9, but is not
yet available in cfdm. It will be ready in a future
1.9.x.0 release.</p>
</dd>
</dl>
</section>
</section>
</section>



          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, NCAS | Page built on 2022-07-18.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>